<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>4YFN 2026 — Startup Explorer</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Rubik:wght@300;400;500;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<style>
  :root {
    --orange: #ff6131;
    --purple: #6300ff;
    --lime: #4caf50;
    --cyan: #0091ea;
    --bg: #f5f5fa;
    --bg2: #ffffff;
    --bg3: #f0f0f6;
    --border: #e0e0ea;
    --border2: #d0d0dd;
    --text: #1a1a2e;
    --text2: #44445a;
    --text3: #77778a;
    --white: #ffffff;
    --header-bg: #0a0a14;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Rubik', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* ── Header (stays dark for logo contrast) ── */
  .header {
    background: var(--header-bg);
    padding: 0.8rem 2rem;
    position: sticky;
    top: 0;
    z-index: 100;
  }
  .header-inner {
    max-width: 1440px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1.5rem;
  }
  .header-logos {
    display: flex;
    align-items: center;
    gap: 1.2rem;
    flex-shrink: 0;
  }
  .header-logos img { height: 28px; }
  .header-logos .logo-divider {
    width: 1px; height: 22px;
    background: rgba(255,255,255,0.15);
  }
  .header-nav {
    display: flex;
    align-items: center;
    gap: 1.5rem;
  }
  .header-nav a {
    color: rgba(255,255,255,0.6);
    text-decoration: none;
    font-size: 0.8rem;
    font-weight: 500;
    letter-spacing: 0.04em;
    transition: color 0.2s;
  }
  .header-nav a:hover, .header-nav a.active { color: #fff; }
  .nav-saved { position: relative; display: inline-flex; align-items: center; color: rgba(255,255,255,0.5) !important; }
  .nav-saved:hover { color: #f43f5e !important; }
  .saved-badge { position: absolute; top: -6px; right: -8px; background: #f43f5e; color: #fff; font-size: 0.55rem; font-weight: 700; min-width: 14px; height: 14px; border-radius: 99px; display: none; align-items: center; justify-content: center; padding: 0 3px; line-height: 1; }
  .saved-badge.has-saved { display: flex; }
  .header-nav .add-startup-btn {
    background: var(--orange);
    color: #fff;
    border: none;
    padding: 0.45rem 1rem;
    border-radius: 100px;
    font-family: 'Rubik', sans-serif;
    font-size: 0.78rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 0.35rem;
  }
  .header-nav .add-startup-btn:hover { background: #e5551a; transform: scale(1.03); }

  /* ── Hero ── */
  .hero {
    position: relative;
    padding: 3.5rem 2rem 2.5rem;
    text-align: center;
    background: linear-gradient(180deg, #fff 0%, var(--bg) 100%);
  }
  .hero-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 100px;
    padding: 0.4rem 1rem;
    font-size: 0.8rem;
    color: var(--text3);
    margin-bottom: 1.2rem;
  }
  .hero-badge .dot {
    width: 6px; height: 6px;
    background: var(--lime);
    border-radius: 50%;
    animation: pulse 2s ease infinite;
  }
  @keyframes pulse { 0%,100%{opacity:1;} 50%{opacity:0.4;} }

  .hero-number {
    font-family: 'Space Grotesk', sans-serif;
    font-size: clamp(3.5rem, 10vw, 7rem);
    font-weight: 700;
    line-height: 1;
    background: linear-gradient(135deg, var(--orange) 0%, var(--purple) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 0.3rem;
  }
  .hero-subtitle {
    font-family: 'Space Grotesk', sans-serif;
    font-size: clamp(1.3rem, 3vw, 2rem);
    font-weight: 600;
    color: var(--text);
    margin-bottom: 0.75rem;
  }
  .hero p {
    font-size: 1rem;
    color: var(--text3);
    max-width: 560px;
    margin: 0 auto 1.5rem;
    line-height: 1.6;
  }
  .hero-links {
    display: flex;
    justify-content: center;
    gap: 0.75rem;
    flex-wrap: wrap;
  }
  .hero-link {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    padding: 0.5rem 1.2rem;
    border-radius: 100px;
    font-size: 0.82rem;
    font-weight: 500;
    text-decoration: none;
    transition: all 0.2s;
  }
  .hero-link.primary { background: var(--purple); color: #fff; }
  .hero-link.primary:hover { background: #5200d4; }
  .hero-link.secondary { background: var(--bg2); border: 1px solid var(--border); color: var(--text2); }
  .hero-link.secondary:hover { border-color: var(--purple); color: var(--purple); }
  .hero-link svg { width: 15px; height: 15px; flex-shrink: 0; }

  /* ── Stats Bar ── */
  .stats-bar {
    display: flex;
    justify-content: center;
    gap: 1rem;
    flex-wrap: wrap;
    padding: 0 2rem 2rem;
    max-width: 900px;
    margin: 0 auto;
  }
  .stat-card {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 1rem 1.5rem;
    text-align: center;
    min-width: 120px;
    flex: 1;
    transition: border-color 0.3s, box-shadow 0.3s;
  }
  .stat-card:hover { border-color: var(--purple); box-shadow: 0 4px 16px rgba(99,0,255,0.08); }
  .stat-value {
    font-family: 'Space Grotesk', sans-serif;
    font-size: 1.6rem;
    font-weight: 700;
    color: var(--orange);
  }
  .stat-label {
    font-size: 0.7rem;
    color: var(--text3);
    text-transform: uppercase;
    letter-spacing: 0.08em;
    margin-top: 0.15rem;
  }

  /* ── Leaderboard ── */
  .leaderboard-list {
    position: relative;
    flex: 1;
    min-height: 0;
  }
  .leaderboard-list-inner {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    gap: 0.35rem;
    overflow: hidden;
  }
  .leaderboard-row {
    display: flex;
    align-items: center;
    gap: 0.7rem;
    padding: 0.45rem 0.6rem;
    border-radius: 10px;
    transition: background 0.15s;
  }
  .leaderboard-row:hover { background: var(--bg3); }
  .leaderboard-rank {
    font-family: 'Space Grotesk', sans-serif;
    font-weight: 700;
    font-size: 0.85rem;
    color: var(--text3);
    min-width: 1.8rem;
    text-align: center;
  }
  .leaderboard-rank.top-3 { color: var(--orange); }
  .leaderboard-favicon {
    width: 20px;
    height: 20px;
    border-radius: 4px;
    object-fit: contain;
    flex-shrink: 0;
  }
  .leaderboard-name {
    flex: 1;
    font-size: 0.85rem;
    font-weight: 500;
    color: var(--text);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  .leaderboard-bar-wrap {
    flex: 1;
    max-width: 100px;
    height: 6px;
    background: var(--bg3);
    border-radius: 3px;
    overflow: hidden;
  }
  .leaderboard-bar {
    height: 100%;
    border-radius: 3px;
    background: linear-gradient(90deg, var(--orange), var(--purple));
    transition: width 0.6s ease;
  }
  .leaderboard-empty {
    text-align: center;
    color: var(--text3);
    font-size: 0.8rem;
    padding: 2rem 0;
  }

  /* ── Charts Section ── */
  .charts-section {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 2rem 2.5rem;
  }
  .charts-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr) minmax(200px, 280px);
    gap: 1rem;
  }
  .chart-card-leaderboard {
    grid-column: 4;
    grid-row: 1 / 3;
    display: flex;
    flex-direction: column;
  }
  .chart-card {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 1.3rem;
    position: relative;
    display: flex;
    flex-direction: column;
  }
  .chart-card .bar-chart,
  .chart-card .col-chart,
  .chart-card .treemap,
  .chart-card .donut-chart {
    margin-top: auto;
    margin-bottom: auto;
  }
  .chart-card-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1rem;
  }
  .chart-title {
    font-family: 'Space Grotesk', sans-serif;
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--text);
  }
  .share-btn {
    width: 30px; height: 30px;
    border-radius: 8px;
    border: 1px solid var(--border);
    background: var(--bg);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text3);
    transition: all 0.2s;
    flex-shrink: 0;
  }
  .share-btn:hover { border-color: var(--purple); color: var(--purple); background: #f0eaff; }
  .share-btn svg { width: 14px; height: 14px; }

  /* Horizontal bar chart */
  .bar-chart { display: flex; flex-direction: column; gap: 0.5rem; }
  .bar-row { display: flex; align-items: center; gap: 0.5rem; }
  .bar-label { font-size: 0.72rem; color: var(--text2); min-width: 100px; text-align: right; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .bar-track { flex: 1; height: 22px; background: var(--bg); border-radius: 6px; overflow: hidden; position: relative; }
  .bar-fill { height: 100%; border-radius: 6px; transition: width 0.8s ease; display: flex; align-items: center; padding-left: 6px; }
  .bar-fill span { font-size: 0.65rem; font-weight: 600; color: #fff; white-space: nowrap; }
  .bar-row { cursor: default; transition: transform 0.15s; }
  .bar-row:hover { transform: translateX(3px); }
  .bar-row:hover .bar-fill { filter: brightness(1.15); }

  /* Column chart */
  .col-chart { display: flex; align-items: flex-end; gap: 3px; height: 160px; padding-top: 10px; }
  .col-item { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 3px; height: 100%; justify-content: flex-end; }
  .col-bar { width: 100%; border-radius: 4px 4px 0 0; transition: height 0.8s ease; min-height: 2px; position: relative; }
  .col-bar span { position: absolute; top: -16px; left: 50%; transform: translateX(-50%); font-size: 0.6rem; font-weight: 600; color: var(--text2); white-space: nowrap; }
  .col-label { font-size: 0.6rem; color: var(--text3); text-align: center; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100%; }
  .col-item { cursor: default; transition: transform 0.15s; }
  .col-item:hover { transform: translateY(-3px); }
  .col-item:hover .col-bar { filter: brightness(1.15); }

  /* Treemap */
  .treemap { display: flex; flex-wrap: wrap; gap: 3px; min-height: 180px; }
  .treemap-cell {
    border-radius: 6px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 4px;
    color: #fff;
    text-align: center;
    overflow: hidden;
    transition: opacity 0.2s;
    cursor: default;
  }
  .treemap-cell:hover { opacity: 0.85; transform: scale(1.04); z-index: 2; }
  .treemap-cell .tm-label { font-size: 0.68rem; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100%; }
  .treemap-cell .tm-count { font-size: 0.58rem; opacity: 0.85; }
  .treemap-cell .tm-flag { font-size: 1.2rem; line-height: 1; }
  .treemap-cell .tm-tooltip { display: none; position: absolute; bottom: calc(100% + 4px); left: 50%; transform: translateX(-50%); background: var(--text); color: #fff; font-size: 0.68rem; padding: 0.25rem 0.5rem; border-radius: 6px; white-space: nowrap; pointer-events: none; z-index: 10; }
  .treemap-cell:hover .tm-tooltip { display: block; }

  /* Donut chart */
  .donut-chart { display: flex; align-items: center; gap: 1rem; }
  .donut-svg { flex-shrink: 0; }
  .donut-legend { display: flex; flex-direction: column; gap: 0.3rem; flex: 1; }
  .donut-legend-item { display: flex; align-items: center; gap: 0.4rem; font-size: 0.72rem; color: var(--text2); }
  .donut-legend-dot { width: 8px; height: 8px; border-radius: 2px; flex-shrink: 0; }
  .donut-legend-val { margin-left: auto; font-weight: 600; color: var(--text); font-size: 0.7rem; }
  .donut-center { font-family: 'Space Grotesk', sans-serif; font-weight: 700; fill: var(--text); }
  .donut-center-label { fill: var(--text3); }

  /* Chart watermark for sharing */
  .chart-watermark {
    display: none;
    align-items: center;
    justify-content: flex-end;
    gap: 0.6rem;
    padding-top: 0.75rem;
    margin-top: 0.75rem;
    border-top: 1px solid var(--border);
  }
  .chart-watermark img { height: 16px; filter: invert(1); }
  .chart-watermark .wm-divider { width: 1px; height: 14px; background: var(--border); }
  .chart-watermark span { font-size: 0.65rem; color: var(--text3); }
  .chart-watermark .wm-dr-logo { height: 14px; opacity: 0.5; }
  .chart-card.sharing .chart-watermark { display: flex; }
  .chart-card.sharing .share-btn { display: none; }
  .chart-card.sharing { border-radius: 0; border: none; }

  /* Share toast */
  .share-toast {
    position: fixed;
    bottom: 2rem;
    left: 50%;
    transform: translateX(-50%) translateY(100px);
    background: var(--text);
    color: #fff;
    padding: 0.65rem 1.3rem;
    border-radius: 10px;
    font-size: 0.82rem;
    z-index: 200;
    transition: transform 0.3s ease;
    pointer-events: none;
  }
  .share-toast.visible { transform: translateX(-50%) translateY(0); }

  /* ── Company Detail Modal ── */
  .detail-overlay {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.5);
    backdrop-filter: blur(6px);
    z-index: 250;
    display: none;
    align-items: center;
    justify-content: center;
    padding: 1rem;
  }
  .detail-overlay.open { display: flex; }
  .detail-modal {
    background: var(--bg2);
    border-radius: 18px;
    max-width: 420px;
    width: 100%;
    max-height: 85vh;
    overflow-y: auto;
    box-shadow: 0 20px 60px rgba(0,0,0,0.2);
    position: relative;
    animation: detailIn 0.25s ease;
  }
  @keyframes detailIn { from { opacity:0; transform:scale(0.95) translateY(10px); } to { opacity:1; transform:none; } }
  .detail-modal-close {
    position: absolute;
    top: 0.8rem; right: 0.8rem;
    width: 32px; height: 32px;
    border-radius: 50%;
    border: none;
    background: var(--bg);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text3);
    font-size: 1.1rem;
    z-index: 2;
    transition: all 0.2s;
  }
  .detail-modal-close:hover { background: var(--border); color: var(--text); }
  .detail-modal-body { padding: 1.5rem; }
  .detail-modal-body .swipe-card-name { font-family: 'Space Grotesk', sans-serif; font-size: 1.2rem; font-weight: 700; margin-bottom: 0.3rem; }
  .detail-modal-body .swipe-card-tagline { font-size: 0.85rem; color: var(--text3); margin-bottom: 0.6rem; line-height: 1.5; }
  .detail-modal-body .swipe-card-meta { font-size: 0.8rem; color: var(--text2); margin-bottom: 0.6rem; line-height: 1.7; }
  .detail-modal-body .swipe-card-tags { display: flex; flex-wrap: wrap; gap: 0.3rem; margin-bottom: 0.7rem; }
  .detail-modal-body .swipe-card-tags span { background: var(--bg3); padding: 0.2rem 0.6rem; border-radius: 100px; font-size: 0.7rem; color: var(--text2); }
  .detail-modal-body .signal-row { margin-bottom: 0.7rem; }
  .detail-modal-body .swipe-card-founders { margin-bottom: 0.7rem; }
  .detail-modal-body .swipe-card-booth { font-size: 0.8rem; color: var(--text2); margin-bottom: 0.5rem; }
  .detail-modal-body .detail-links { display: flex; gap: 0.5rem; margin-top: 0.8rem; }
  .detail-modal-body .detail-links a { display: inline-flex; align-items: center; gap: 0.3rem; padding: 0.45rem 1rem; border-radius: 100px; font-size: 0.78rem; font-weight: 500; text-decoration: none; transition: all 0.2s; background: var(--bg3); color: var(--text2); border: 1px solid var(--border); }
  .detail-modal-body .detail-links a:hover { border-color: var(--purple); color: var(--purple); }

  /* ── Main Content ── */
  .main {
    max-width: 1440px;
    margin: 0 auto;
    padding: 0 2rem 3rem;
  }

  /* ── Section Heading ── */
  .section-heading {
    font-family: 'Space Grotesk', sans-serif;
    font-size: 1.4rem;
    font-weight: 600;
    margin: 0 0 1.2rem;
    display: flex;
    align-items: center;
    gap: 0.6rem;
    color: var(--text);
  }
  .section-heading .accent-bar {
    width: 4px; height: 22px;
    background: linear-gradient(180deg, var(--orange), var(--purple));
    border-radius: 2px;
  }

  /* ── Filters ── */
  .filters-section { margin-bottom: 1.5rem; }
  .filters-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 0.75rem;
    flex-wrap: wrap;
    gap: 0.75rem;
  }
  .search-box { position: relative; flex: 1; max-width: 380px; }
  .search-box input {
    width: 100%;
    padding: 0.65rem 1rem 0.65rem 2.6rem;
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 10px;
    color: var(--text);
    font-family: 'Rubik', sans-serif;
    font-size: 0.85rem;
    outline: none;
    transition: border-color 0.3s;
  }
  .search-box input:focus { border-color: var(--purple); }
  .search-box input::placeholder { color: var(--text3); }
  .search-box svg {
    position: absolute;
    left: 0.8rem; top: 50%;
    transform: translateY(-50%);
    width: 15px; height: 15px;
    color: var(--text3);
  }
  .result-count { font-size: 0.82rem; color: var(--text3); }
  .result-count span { color: var(--orange); font-weight: 600; }
  .card-save-btn {
    position: absolute; top: 0.6rem; right: 0.6rem;
    background: none; border: none; cursor: pointer; padding: 0.2rem;
    color: var(--border2); transition: all 0.2s; opacity: 0;
    line-height: 0;
  }
  .card:hover .card-save-btn { opacity: 1; }
  .card-save-btn:hover { color: #f43f5e; transform: scale(1.2); }
  .card-save-btn.is-saved { color: #f43f5e; opacity: 1; }
  .card-booth {
    display: inline-flex; align-items: center; gap: 0.25rem;
    font-size: 0.65rem; color: var(--text3); background: var(--bg3);
    padding: 0.15rem 0.5rem; border-radius: 100px; margin-top: 0.35rem; margin-bottom: 0.25rem;
  }
  .card-booth span { font-weight: 600; color: var(--text2); }
  .card { position: relative; }

  .filter-rows { display: flex; flex-direction: column; gap: 0.6rem; }
  .filter-row { display: flex; align-items: center; gap: 0.6rem; flex-wrap: wrap; }
  .filter-label {
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--text3);
    min-width: 60px;
    flex-shrink: 0;
  }
  .filter-chips { display: flex; gap: 0.35rem; flex-wrap: wrap; }
  .chip {
    padding: 0.3rem 0.75rem;
    border-radius: 100px;
    font-size: 0.75rem;
    cursor: pointer;
    transition: all 0.2s;
    border: 1px solid var(--border);
    background: var(--bg2);
    color: var(--text2);
    white-space: nowrap;
    user-select: none;
  }
  .chip:hover { border-color: var(--purple); color: var(--purple); }
  .chip.active { background: var(--purple); border-color: var(--purple); color: #fff; }
  .chip-count { font-size: 0.65rem; opacity: 0.5; margin-left: 0.2rem; }

  .clear-filters {
    padding: 0.3rem 0.75rem;
    border-radius: 100px;
    font-size: 0.75rem;
    cursor: pointer;
    border: 1px solid var(--orange);
    background: transparent;
    color: var(--orange);
    font-family: 'Rubik', sans-serif;
    transition: all 0.2s;
  }
  .clear-filters:hover { background: var(--orange); color: #fff; }
  .grid-view-pills {
    display: inline-flex; margin-left: auto; border: 1px solid var(--border);
    border-radius: 8px; overflow: hidden; font-size: 0.72rem; font-family: 'Rubik', sans-serif;
  }
  .grid-view-pills button {
    padding: 0.3rem 0.65rem; border: none; background: transparent;
    color: var(--text3); cursor: pointer; white-space: nowrap; transition: all 0.15s;
  }
  .grid-view-pills button + button { border-left: 1px solid var(--border); }
  .grid-view-pills button.active { background: var(--orange); color: #fff; }
  .grid-view-pills button:not(.active):hover { background: var(--bg2); }

  .sort-select {
    padding: 0.45rem 0.75rem;
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 10px;
    color: var(--text2);
    font-family: 'Rubik', sans-serif;
    font-size: 0.78rem;
    cursor: pointer;
    outline: none;
  }
  .sort-select:focus { border-color: var(--purple); }

  /* ── Grid ── */
  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(330px, 1fr));
    gap: 0.85rem;
  }
  .card {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 1.3rem;
    transition: all 0.3s ease;
    cursor: pointer;
    position: relative;
    overflow: hidden;
  }
  .card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--orange), var(--purple));
    opacity: 0;
    transition: opacity 0.3s;
  }
  .card:hover {
    border-color: var(--purple);
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(99,0,255,0.08);
  }
  .card:hover::before { opacity: 1; }

  .card-top {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    gap: 0.75rem;
    margin-bottom: 0.6rem;
  }
  .card-name {
    font-family: 'Space Grotesk', sans-serif;
    font-size: 1.1rem;
    font-weight: 600;
    line-height: 1.3;
    color: var(--text);
    display: flex;
    align-items: center;
    gap: 0.4rem;
  }
  .card-favicon {
    width: 18px;
    height: 18px;
    border-radius: 3px;
    flex-shrink: 0;
  }
  .card-round {
    font-size: 0.62rem;
    padding: 0.18rem 0.55rem;
    border-radius: 100px;
    white-space: nowrap;
    font-weight: 600;
    letter-spacing: 0.03em;
    flex-shrink: 0;
  }
  .round-seed { background: #e8f5e9; color: #2e7d32; }
  .round-early { background: #e3f2fd; color: #1565c0; }
  .round-series-a { background: #fff3e0; color: #e65100; }
  .round-series-b { background: #f3e5f5; color: #7b1fa2; }
  .round-series-c { background: #fce4ec; color: #c62828; }
  .round-late { background: #f5f0e0; color: #8a7430; }

  .card-tagline {
    font-size: 0.82rem;
    color: var(--text2);
    line-height: 1.5;
    margin-bottom: 0.85rem;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  .card-meta { display: flex; flex-wrap: wrap; gap: 0.45rem; margin-bottom: 0.6rem; }
  .meta-item {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.72rem;
    color: var(--text3);
  }
  .meta-item svg { width: 12px; height: 12px; flex-shrink: 0; }
  .meta-item .meta-value { color: var(--text2); }

  .card-tags { display: flex; flex-wrap: wrap; gap: 0.25rem; margin-top: 0.2rem; }
  .card-tag {
    font-size: 0.65rem;
    padding: 0.12rem 0.45rem;
    border-radius: 5px;
    background: var(--bg3);
    color: var(--text3);
  }
  /* ── Dealroom Signal ── */
  .signal-row {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 0.55rem;
    margin-bottom: 0.15rem;
  }
  .signal-label {
    font-size: 0.65rem;
    color: var(--text3);
    font-weight: 500;
    white-space: nowrap;
    letter-spacing: 0.01em;
  }
  .signal-track {
    flex: 1;
    height: 6px;
    background: var(--bg3);
    border-radius: 100px;
    overflow: hidden;
    position: relative;
  }
  .signal-fill {
    height: 100%;
    border-radius: 100px;
    background: linear-gradient(90deg, #6300ff 0%, #06b6d4 50%, #10b981 100%);
    transition: width 0.6s ease;
  }
  .signal-score {
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text);
    min-width: 22px;
    text-align: right;
  }

  .card-links {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.85rem;
    padding-top: 0.65rem;
    border-top: 1px solid var(--border);
  }
  .card-link {
    font-size: 0.72rem;
    color: var(--cyan);
    text-decoration: none;
    display: flex;
    align-items: center;
    gap: 0.25rem;
    transition: color 0.2s;
  }
  .card-link:hover { color: var(--orange); }
  .card-link svg { width: 11px; height: 11px; }

  /* ── Pagination ── */
  .pagination { display: flex; justify-content: center; align-items: center; gap: 0.4rem; margin-top: 1.5rem; }
  .page-btn {
    padding: 0.45rem 0.9rem;
    border-radius: 8px;
    border: 1px solid var(--border);
    background: var(--bg2);
    color: var(--text2);
    font-family: 'Rubik', sans-serif;
    font-size: 0.82rem;
    cursor: pointer;
    transition: all 0.2s;
  }
  .page-btn:hover { border-color: var(--purple); }
  .page-btn.active { background: var(--purple); border-color: var(--purple); color: #fff; }
  .page-btn:disabled { opacity: 0.3; cursor: default; }

  /* ── Interactive Map ── */
  .map-section { padding: 2rem 0; }
  .map-layout {
    display: grid;
    grid-template-columns: 320px 1fr;
    gap: 0;
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 14px;
    overflow: hidden;
    height: 600px;
  }
  .map-sidebar {
    border-right: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  .map-sidebar-header {
    padding: 1rem 1.2rem 0.7rem;
    border-bottom: 1px solid var(--border);
  }
  .map-sidebar-header h3 {
    font-family: 'Space Grotesk', sans-serif;
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 0.6rem;
  }
  .map-search-wrap {
    position: relative;
  }
  .map-search-wrap input {
    width: 100%;
    padding: 0.5rem 0.7rem 0.5rem 2rem;
    border: 1px solid var(--border);
    border-radius: 8px;
    font-family: 'Rubik', sans-serif;
    font-size: 0.78rem;
    background: var(--bg);
    color: var(--text);
    outline: none;
    transition: border-color 0.2s;
  }
  .map-search-wrap input:focus { border-color: var(--purple); }
  .map-search-wrap svg {
    position: absolute; left: 0.6rem; top: 50%; transform: translateY(-50%);
    width: 13px; height: 13px; color: var(--text3);
  }
  .map-hall-tabs {
    display: flex;
    gap: 0.3rem;
    padding: 0.6rem 1.2rem;
    border-bottom: 1px solid var(--border);
  }
  .map-hall-tab {
    padding: 0.3rem 0.7rem;
    border-radius: 6px;
    border: 1px solid var(--border);
    background: var(--bg);
    font-size: 0.7rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
    color: var(--text2);
  }
  .map-hall-tab.active { background: var(--purple); color: #fff; border-color: var(--purple); }
  .map-booth-list {
    flex: 1;
    overflow-y: auto;
    padding: 0.5rem 0;
  }
  .map-booth-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1.2rem;
    cursor: pointer;
    transition: background 0.15s;
    border-left: 3px solid transparent;
  }
  .map-booth-item:hover { background: var(--bg); }
  .map-booth-item.active { background: rgba(99,0,255,0.05); border-left-color: var(--purple); }
  .map-booth-item.matched { }
  .map-booth-item .booth-dot {
    width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0;
  }
  .map-booth-item .booth-dot.dr-match { background: var(--purple); }
  .map-booth-item .booth-dot.no-match { background: var(--border2); }
  .map-booth-name {
    font-size: 0.75rem; color: var(--text); font-weight: 500;
    overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
    flex: 1; min-width: 0;
  }
  .map-booth-code {
    font-family: 'Space Grotesk', sans-serif;
    font-size: 0.65rem; font-weight: 600; color: var(--purple);
    background: rgba(99,0,255,0.07); padding: 0.1rem 0.35rem; border-radius: 3px;
    white-space: nowrap;
  }
  .map-booth-count {
    padding: 0.4rem 1.2rem;
    font-size: 0.68rem;
    color: var(--text3);
    border-top: 1px solid var(--border);
  }
  .map-viewer {
    position: relative;
    overflow: hidden;
    cursor: grab;
    touch-action: none;
    background: var(--bg);
  }
  .map-viewer:active { cursor: grabbing; }
  .map-controls {
    position: absolute; bottom: 1rem; right: 1rem;
    display: flex; gap: 0.3rem; z-index: 5;
  }
  .map-controls .fp-btn {
    width: 36px; height: 36px; border-radius: 10px;
    border: 1px solid var(--border); background: var(--bg2);
    cursor: pointer; display: flex; align-items: center; justify-content: center;
    color: var(--text2); font-size: 1.1rem; font-weight: 600;
    transition: all 0.2s; box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  }
  .map-controls .fp-btn:hover { border-color: var(--purple); color: var(--purple); }
  /* Booth detail in sidebar */
  .map-booth-item .booth-detail-links a {
    font-size: 0.68rem; color: var(--cyan); text-decoration: none;
  }
  .map-booth-item .booth-detail-links a:hover { color: var(--orange); }
  /* Map popup card */
  .map-popup {
    position: absolute; top: 1rem; left: 1rem; right: 1rem;
    max-width: 380px; z-index: 10;
    background: var(--bg2); border: 1px solid var(--border);
    border-radius: 14px; box-shadow: 0 12px 40px rgba(0,0,0,0.15);
    padding: 1.2rem; animation: mapPopIn 0.2s ease;
    max-height: calc(100% - 2rem); overflow-y: auto;
  }
  @keyframes mapPopIn { from { opacity: 0; transform: translateY(-8px); } to { opacity: 1; transform: translateY(0); } }
  .map-popup-close {
    position: absolute; top: 0.5rem; right: 0.5rem;
    background: none; border: none; cursor: pointer;
    color: var(--text3); font-size: 1.2rem; line-height: 1;
    width: 28px; height: 28px; border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    transition: all 0.15s;
  }
  .map-popup-close:hover { background: var(--bg); color: var(--text); }
  .map-popup-name {
    font-family: 'Space Grotesk', sans-serif; font-size: 1.1rem;
    font-weight: 600; color: var(--text); margin-bottom: 0.3rem;
    display: flex; align-items: center; gap: 0.4rem; padding-right: 2rem;
  }
  .map-popup-name img { width: 18px; height: 18px; border-radius: 3px; }
  .map-popup-tagline { font-size: 0.78rem; color: var(--text2); line-height: 1.5; margin-bottom: 0.5rem; }
  .map-popup-meta { display: flex; flex-wrap: wrap; gap: 0.2rem 0.6rem; font-size: 0.72rem; color: var(--text3); margin-bottom: 0.5rem; }
  .map-popup-booth {
    display: inline-flex; align-items: center; gap: 0.3rem;
    font-size: 0.7rem; color: var(--purple); font-weight: 600;
    background: rgba(99,0,255,0.06); padding: 0.2rem 0.6rem;
    border-radius: 100px; margin-bottom: 0.5rem;
  }
  .map-popup-tags { display: flex; flex-wrap: wrap; gap: 0.25rem; margin-bottom: 0.5rem; }
  .map-popup-tags span { font-size: 0.62rem; padding: 0.12rem 0.4rem; border-radius: 5px; background: var(--bg3); color: var(--text2); }
  .map-popup-links { display: flex; gap: 0.6rem; margin-top: 0.5rem; padding-top: 0.5rem; border-top: 1px solid var(--border); }
  .map-popup-links a { font-size: 0.72rem; color: var(--cyan); text-decoration: none; display: flex; align-items: center; gap: 0.2rem; }
  .map-popup-links a:hover { color: var(--orange); }
  .map-popup-save {
    background: none; border: 1px solid var(--border); border-radius: 8px;
    padding: 0.3rem 0.7rem; font-size: 0.7rem; font-family: 'Rubik', sans-serif;
    color: var(--text2); cursor: pointer; display: flex; align-items: center; gap: 0.3rem;
    transition: all 0.2s; margin-left: auto;
  }
  .map-popup-save:hover { border-color: #f43f5e; color: #f43f5e; }
  .map-popup-save.is-saved { color: #f43f5e; border-color: #f43f5e; background: rgba(244,63,94,0.05); }
  @media (max-width: 900px) {
    .map-layout { grid-template-columns: 1fr; grid-template-rows: 300px 400px; height: auto; }
    .map-sidebar { border-right: none; border-bottom: 1px solid var(--border); }
  }

  /* ── Add Startup Modal ── */
  .modal-overlay {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.4);
    backdrop-filter: blur(4px);
    z-index: 200;
    display: none;
    align-items: center;
    justify-content: center;
    padding: 1rem;
  }
  .modal-overlay.open { display: flex; }
  .modal {
    background: var(--bg2);
    border-radius: 18px;
    padding: 2rem;
    max-width: 440px;
    width: 100%;
    box-shadow: 0 20px 60px rgba(0,0,0,0.15);
    position: relative;
  }
  .modal-close {
    position: absolute;
    top: 1rem; right: 1rem;
    width: 32px; height: 32px;
    border-radius: 50%;
    border: none;
    background: var(--bg);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text3);
    font-size: 1.1rem;
    transition: all 0.2s;
  }
  .modal-close:hover { background: var(--border); color: var(--text); }
  .modal h3 {
    font-family: 'Space Grotesk', sans-serif;
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 0.4rem;
  }
  .modal p { font-size: 0.85rem; color: var(--text3); margin-bottom: 1.2rem; line-height: 1.5; }
  .modal-input-group { margin-bottom: 1rem; }
  .modal-input-group label { display: block; font-size: 0.75rem; color: var(--text3); margin-bottom: 0.3rem; text-transform: uppercase; letter-spacing: 0.06em; }
  .modal-input-group input, .modal-input-group textarea {
    width: 100%;
    padding: 0.65rem 0.9rem;
    border: 1px solid var(--border);
    border-radius: 10px;
    font-family: 'Rubik', sans-serif;
    font-size: 0.88rem;
    color: var(--text);
    outline: none;
    transition: border-color 0.3s;
    background: var(--bg);
  }
  .modal-input-group input:focus, .modal-input-group textarea:focus { border-color: var(--purple); }
  .modal-input-group textarea { resize: vertical; min-height: 70px; }
  .modal-submit {
    width: 100%;
    padding: 0.7rem;
    border-radius: 10px;
    border: none;
    background: var(--orange);
    color: #fff;
    font-family: 'Rubik', sans-serif;
    font-size: 0.9rem;
    font-weight: 500;
    cursor: pointer;
    transition: background 0.2s;
  }
  .modal-submit:hover { background: #e5551a; }
  .modal-submit:disabled { opacity: 0.5; cursor: default; }
  .modal-success { text-align: center; padding: 1rem 0; }
  .modal-success svg { width: 48px; height: 48px; color: var(--lime); margin-bottom: 0.75rem; }
  .modal-success h4 { font-family: 'Space Grotesk', sans-serif; font-size: 1.1rem; margin-bottom: 0.4rem; }
  .modal-success p { color: var(--text3); font-size: 0.85rem; }

  /* ── Loading ── */
  .loading { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 4rem; gap: 0.75rem; }
  .spinner { width: 36px; height: 36px; border: 3px solid var(--border); border-top-color: var(--orange); border-radius: 50%; animation: spin 0.8s linear infinite; }
  @keyframes spin { to { transform: rotate(360deg); } }
  .loading-text { color: var(--text3); font-size: 0.85rem; }

  .no-results { text-align: center; padding: 3rem; color: var(--text3); }
  .no-results svg { width: 48px; height: 48px; margin-bottom: 1rem; opacity: 0.3; }

  /* ── Swipe Mode ── */
  .swipe-fab {
    position: fixed; bottom: 2rem; right: 2rem; z-index: 90;
    width: 56px; height: 56px; border-radius: 50%;
    background: linear-gradient(135deg, var(--orange), #e5551a);
    border: none; cursor: pointer; display: flex; align-items: center; justify-content: center;
    box-shadow: 0 4px 20px rgba(255,97,49,0.4);
    transition: all 0.3s; color: #fff; font-size: 1.5rem;
  }
  .swipe-fab:hover { transform: scale(1.08); box-shadow: 0 6px 24px rgba(255,97,49,0.5); }
  .swipe-overlay {
    position: fixed; inset: 0; z-index: 300;
    background: linear-gradient(135deg, #0a0a14 0%, #1a1a2e 100%);
    display: none; flex-direction: column; align-items: center; justify-content: center;
    overflow: hidden;
  }
  .swipe-overlay.open { display: flex; }
  .swipe-header {
    position: absolute; top: 0; left: 0; right: 0;
    display: flex; align-items: center; justify-content: space-between;
    padding: 1rem 1.5rem; z-index: 5;
  }
  .swipe-header-title { color: #fff; font-family: 'Space Grotesk', sans-serif; font-weight: 600; font-size: 0.9rem; opacity: 0.7; }
  .swipe-close {
    width: 40px; height: 40px; border-radius: 50%; border: 1px solid rgba(255,255,255,0.15);
    background: rgba(255,255,255,0.05); color: #fff; font-size: 1.2rem;
    cursor: pointer; display: flex; align-items: center; justify-content: center;
    transition: all 0.2s;
  }
  .swipe-close:hover { background: rgba(255,255,255,0.15); }
  .swipe-counter { color: rgba(255,255,255,0.5); font-size: 0.75rem; }
  .swipe-stack {
    position: relative; width: 380px; max-width: 90vw; height: 520px; max-height: 70vh;
  }
  .swipe-card {
    position: absolute; inset: 0;
    background: #fff; border-radius: 20px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.3);
    overflow: hidden; cursor: grab;
    transition: transform 0.4s ease, opacity 0.4s ease;
    touch-action: pan-y; user-select: none;
    display: flex; flex-direction: column;
  }
  .swipe-card:active { cursor: grabbing; }
  .swipe-card.swiping { transition: none; }
  .swipe-card.exit-left { transform: translateX(-150%) rotate(-15deg); opacity: 0; pointer-events: none; }
  .swipe-card.exit-right { transform: translateX(150%) rotate(15deg); opacity: 0; pointer-events: none; }
  .swipe-card-top {
    padding: 1.5rem 1.5rem 1rem;
    flex: 1; overflow-y: auto;
  }
  .swipe-card-name {
    font-family: 'Space Grotesk', sans-serif; font-size: 1.4rem; font-weight: 700;
    color: var(--text); margin-bottom: 0.25rem;
  }
  .swipe-save-btn {
    position: absolute; top: 1rem; right: 1rem;
    background: none; border: none; cursor: pointer; padding: 0.3rem;
    color: var(--border2); transition: all 0.2s; line-height: 0; z-index: 5;
  }
  .swipe-save-btn:hover { color: #f43f5e; transform: scale(1.2); }
  .swipe-save-btn.is-saved { color: #f43f5e; }
  .swipe-card-tagline { font-size: 0.85rem; color: var(--text2); line-height: 1.5; margin-bottom: 0.75rem; }
  .swipe-card-meta { display: flex; flex-wrap: wrap; gap: 0.3rem 0.6rem; font-size: 0.78rem; color: var(--text3); margin-bottom: 0.75rem; }
  .swipe-card-tags { display: flex; flex-wrap: wrap; gap: 0.4rem; margin-bottom: 0.75rem; }
  .swipe-card-tags span {
    font-size: 0.68rem; padding: 0.2rem 0.5rem; border-radius: 100px;
    background: var(--bg3); color: var(--text2);
  }
  .swipe-card-signal { margin-bottom: 0.6rem; }
  .swipe-card-founders {
    font-size: 0.78rem; color: var(--text3); margin-bottom: 0.6rem;
  }
  .swipe-card-founders .swipe-founder-label { font-size: 0.65rem; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text3); margin-bottom: 0.35rem; font-weight: 600; }
  .swipe-founder-row { display: flex; align-items: center; gap: 0.5rem; padding: 0.35rem 0; }
  .swipe-founder-row + .swipe-founder-row { border-top: 1px solid var(--border); }
  .swipe-founder-avatar { width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.55rem; font-weight: 700; color: #fff; flex-shrink: 0; }
  .swipe-founder-details { flex: 1; min-width: 0; }
  .swipe-founder-name { font-size: 0.78rem; font-weight: 600; color: var(--text); display: flex; align-items: center; gap: 0.35rem; }
  .swipe-founder-name a { color: var(--text); text-decoration: none; }
  .swipe-founder-name a:hover { color: var(--orange); }
  .swipe-founder-name svg { width: 12px; height: 12px; color: #0077b5; flex-shrink: 0; }
  .swipe-founder-sub { font-size: 0.68rem; color: var(--text3); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .swipe-founder-badge { font-size: 0.55rem; padding: 0.1rem 0.35rem; border-radius: 100px; font-weight: 600; }
  .swipe-founder-badge.sf { background: rgba(249,115,22,0.15); color: #f97316; }
  .swipe-founder-badge.tf { background: rgba(139,92,246,0.15); color: #8b5cf6; }
  .swipe-card-bottom {
    padding: 1rem 1.5rem 1.2rem;
    border-top: 1px solid var(--border);
    display: flex; gap: 0.6rem;
  }
  .swipe-card-bottom a {
    font-size: 0.78rem; color: var(--cyan); text-decoration: none;
    display: flex; align-items: center; gap: 0.3rem;
  }
  .swipe-card-bottom a:hover { color: var(--orange); }
  .swipe-hint {
    position: absolute; top: 50%; transform: translateY(-50%);
    font-size: 1.1rem; font-weight: 700; padding: 0.5rem 1rem;
    border-radius: 8px; pointer-events: none; opacity: 0;
    transition: opacity 0.15s;
    font-family: 'Space Grotesk', sans-serif;
  }
  .swipe-hint.hint-left { left: 1rem; color: #ef4444; border: 2px solid #ef4444; background: rgba(239,68,68,0.1); }
  .swipe-hint.hint-right { right: 1rem; color: #10b981; border: 2px solid #10b981; background: rgba(16,185,129,0.1); }
  .swipe-actions {
    position: absolute; bottom: 0; left: 0; right: 0;
    display: flex; justify-content: center; align-items: center; gap: 1.2rem;
    padding: 1.2rem 1.5rem 1.5rem; z-index: 5;
  }
  .swipe-btn {
    border-radius: 50%;
    border: 2px solid; display: flex; align-items: center; justify-content: center;
    cursor: pointer;
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    background: rgba(15,20,30,0.6); backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
  }
  .swipe-btn svg { pointer-events: none; }
  .swipe-btn:active { transform: scale(0.9); }
  .swipe-btn.btn-skip {
    width: 64px; height: 64px; border-color: rgba(239,68,68,0.5); color: #ef4444;
  }
  .swipe-btn.btn-skip:hover {
    background: #ef4444; color: #fff; border-color: #ef4444;
    box-shadow: 0 0 20px rgba(239,68,68,0.4), 0 0 40px rgba(239,68,68,0.15);
    transform: scale(1.1);
  }
  .swipe-btn.btn-save {
    width: 64px; height: 64px; border-color: rgba(244,63,94,0.5); color: #f43f5e;
  }
  .swipe-btn.btn-save:hover {
    background: linear-gradient(135deg, #f43f5e, #ec4899); color: #fff; border-color: #f43f5e;
    box-shadow: 0 0 24px rgba(244,63,94,0.5), 0 0 48px rgba(244,63,94,0.15);
    transform: scale(1.1);
  }
  .swipe-btn.btn-info {
    width: 48px; height: 48px; border-color: rgba(6,182,212,0.4); color: var(--cyan);
  }
  .swipe-btn.btn-info:hover {
    background: var(--cyan); color: #fff; border-color: var(--cyan);
    box-shadow: 0 0 16px rgba(6,182,212,0.4), 0 0 32px rgba(6,182,212,0.1);
    transform: scale(1.1);
  }
  .swipe-empty { text-align: center; color: rgba(255,255,255,0.6); }
  .swipe-empty h3 { font-family: 'Space Grotesk', sans-serif; font-size: 1.2rem; color: #fff; margin-bottom: 0.5rem; }
  .swipe-card-booth { font-size: 0.78rem; color: var(--text3); margin-bottom: 0.5rem; }
  .swipe-card-booth span { background: rgba(99,102,241,0.1); color: #6366f1; padding: 0.15rem 0.5rem; border-radius: 4px; font-weight: 600; font-size: 0.72rem; margin-left: 0.3rem; }
  /* Swipe filter screen */
  .swipe-filter {
    background: rgba(255,255,255,0.06); border-radius: 18px; padding: 2rem 1.5rem;
    max-width: 380px; width: 100%; text-align: center;
  }
  .swipe-filter h3 { font-family: 'Space Grotesk', sans-serif; font-size: 1.1rem; color: #fff; margin-bottom: 0.3rem; }
  .swipe-filter p { font-size: 0.8rem; color: rgba(255,255,255,0.5); margin-bottom: 1.2rem; }
  .swipe-filter-group { text-align: left; margin-bottom: 1rem; }
  .swipe-filter-group label { display: block; font-size: 0.72rem; font-weight: 600; color: rgba(255,255,255,0.5); text-transform: uppercase; letter-spacing: 0.06em; margin-bottom: 0.4rem; }
  .swipe-filter-chips { display: flex; flex-wrap: wrap; gap: 0.4rem; }
  .swipe-filter-chip {
    background: rgba(255,255,255,0.08); color: rgba(255,255,255,0.7); border: 1px solid rgba(255,255,255,0.12);
    padding: 0.35rem 0.7rem; border-radius: 100px; font-size: 0.75rem; cursor: pointer; transition: all 0.15s;
  }
  .swipe-filter-chip:hover { background: rgba(255,255,255,0.14); }
  .swipe-filter-chip.selected { background: var(--orange); color: #fff; border-color: var(--orange); }
  .swipe-filter-go {
    margin-top: 1.2rem; background: var(--orange); color: #fff; border: none; padding: 0.65rem 2rem;
    border-radius: 100px; font-family: 'Rubik', sans-serif; font-size: 0.85rem; font-weight: 600;
    cursor: pointer; transition: all 0.15s; width: 100%;
  }
  .swipe-filter-go:hover { background: #e5551a; transform: scale(1.02); }
  .swipe-filter-count { font-size: 0.7rem; color: rgba(255,255,255,0.4); margin-top: 0.6rem; }
  .swipe-saved-count {
    position: absolute; top: 1rem; right: 5rem;
    background: rgba(16,185,129,0.15); color: #10b981;
    font-size: 0.75rem; font-weight: 600; padding: 0.3rem 0.8rem;
    border-radius: 100px; border: 1px solid rgba(16,185,129,0.3);
  }

  /* ── Footer ── */
  .footer {
    text-align: center;
    padding: 1.5rem 2rem;
    border-top: 1px solid var(--border);
    color: var(--text3);
    font-size: 0.75rem;
    background: var(--bg2);
  }
  .footer a { color: var(--cyan); text-decoration: none; }
  .footer a:hover { color: var(--orange); }

  /* ── Scroll to top ── */
  .scroll-top {
    position: fixed;
    bottom: 5.5rem; right: 2rem;
    width: 40px; height: 40px;
    border-radius: 50%;
    background: var(--purple);
    border: none;
    color: #fff;
    cursor: pointer;
    display: none;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 16px rgba(99,0,255,0.3);
    transition: transform 0.2s;
    z-index: 50;
  }
  .scroll-top:hover { transform: scale(1.1); }
  .scroll-top.visible { display: flex; }

  /* ── Founder Directory ── */
  .founders-section { padding: 2rem 0; }
  .founders-search { margin-bottom: 1.2rem; position: relative; max-width: 400px; }
  .founders-search input {
    width: 100%;
    padding: 0.6rem 1rem 0.6rem 2.5rem;
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 10px;
    color: var(--text);
    font-family: 'Rubik', sans-serif;
    font-size: 0.85rem;
    outline: none;
    transition: border-color 0.3s;
  }
  .founders-search input:focus { border-color: var(--purple); }
  .founders-search input::placeholder { color: var(--text3); }
  .founders-search svg {
    position: absolute; left: 0.8rem; top: 50%;
    transform: translateY(-50%);
    width: 15px; height: 15px; color: var(--text3);
  }
  .founders-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 0.75rem;
  }
  .founder-card {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 1rem;
    display: flex;
    gap: 0.75rem;
    transition: all 0.2s;
  }
  .founder-card:hover { border-color: var(--purple); box-shadow: 0 4px 16px rgba(99,0,255,0.06); }
  .founder-avatar {
    width: 48px; height: 48px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--orange), var(--purple));
    display: flex;
    align-items: center;
    justify-content: center;
    color: #fff;
    font-family: 'Space Grotesk', sans-serif;
    font-weight: 700;
    font-size: 1rem;
    flex-shrink: 0;
    overflow: hidden;
  }
  .founder-avatar img { width: 100%; height: 100%; object-fit: cover; border-radius: 50%; }
  .founder-avatar.has-photo { background: none; }
  .founder-info { flex: 1; min-width: 0; }
  .founder-name {
    font-family: 'Space Grotesk', sans-serif;
    font-weight: 600;
    font-size: 0.88rem;
    line-height: 1.3;
    color: var(--text);
  }
  .founder-company {
    font-size: 0.72rem;
    color: var(--orange);
    font-weight: 500;
    margin-top: 0.1rem;
    display: flex;
    align-items: center;
    gap: 0.3rem;
  }
  .founder-favicon {
    width: 14px; height: 14px; border-radius: 2px; flex-shrink: 0;
    image-rendering: -webkit-optimize-contrast;
  }
  .founder-meta {
    font-size: 0.68rem;
    color: var(--text3);
    margin-top: 0.3rem;
    line-height: 1.4;
  }
  .founder-badges { display: flex; gap: 0.25rem; margin-top: 0.3rem; flex-wrap: wrap; }
  .founder-badge {
    font-size: 0.58rem;
    padding: 0.1rem 0.4rem;
    border-radius: 4px;
    font-weight: 500;
  }
  .badge-serial { background: #f3e5f5; color: #7b1fa2; }
  .badge-top { background: #fff3e0; color: #e65100; }
  .founder-links { margin-top: 0.35rem; }
  .founder-links a {
    font-size: 0.68rem;
    color: var(--cyan);
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 0.2rem;
  }
  .founder-links a:hover { color: var(--orange); }
  .founder-links a svg { width: 11px; height: 11px; }
  .founders-pagination { display: flex; justify-content: center; align-items: center; gap: 0.4rem; margin-top: 1.2rem; }
  .founders-count { font-size: 0.82rem; color: var(--text3); margin-bottom: 0.75rem; }
  .founders-count span { color: var(--orange); font-weight: 600; }

  /* ── Responsive ── */
  /* Hamburger menu + mobile heart — hidden on desktop */
  .header-right-mobile { display: none; align-items: center; gap: 0.75rem; }
  .nav-saved-mobile { display: none !important; }
  .hamburger-btn {
    display: none;
    background: none; border: none; cursor: pointer; padding: 0.4rem;
    color: rgba(255,255,255,0.7); transition: color 0.2s;
  }
  .hamburger-btn:hover { color: #fff; }
  .hamburger-btn svg { display: block; }
  .saved-badge-mobile { position: absolute; top: -6px; right: -10px; background: #f43f5e; color: #fff; font-size: 0.55rem; font-weight: 700; min-width: 14px; height: 14px; border-radius: 99px; display: none; align-items: center; justify-content: center; padding: 0 3px; line-height: 1; }
  .saved-badge-mobile.has-saved { display: flex; }

  @media (max-width: 768px) {
    .header { padding: 0.6rem 1rem; }
    .header-inner { flex-wrap: nowrap; }
    .header-logos img { height: 22px; }
    .header-logos .logo-divider, .header-logos > span { display: none; }
    .header-logos > svg { height: 16px; }
    .header-right-mobile { display: flex; }
    .nav-saved-mobile { display: inline-flex !important; position: relative; }
    .nav-saved-desktop { display: none !important; }
    .hamburger-btn { display: flex; align-items: center; }
    .header-inner { position: relative; }
    .header-nav {
      display: none;
      position: absolute; top: 100%; left: -1rem; right: -1rem;
      background: var(--header-bg); border-top: 1px solid rgba(255,255,255,0.08);
      flex-direction: column; align-items: stretch;
      padding: 0.5rem 1rem 0.75rem; gap: 0;
      box-shadow: 0 8px 24px rgba(0,0,0,0.3);
      z-index: 101;
    }
    .header-nav.mobile-open { display: flex; }
    .header-nav a, .header-nav .add-startup-btn {
      padding: 0.7rem 0.5rem; font-size: 0.85rem;
      border-bottom: 1px solid rgba(255,255,255,0.06);
      width: 100%; text-align: left;
    }
    .header-nav a:last-of-type { border-bottom: none; }
    .header-nav .add-startup-btn {
      margin-top: 0.4rem; text-align: center;
      border-bottom: none; border-radius: 8px;
      justify-content: center;
    }
    .stats-bar { gap: 0.4rem; padding: 0 1rem 2rem; }
    .stat-card { min-width: 0; padding: 0.6rem 0.4rem; overflow: hidden; }
    .stat-value { font-size: 1rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .stat-label { font-size: 0.58rem; letter-spacing: 0.04em; }
    .grid { grid-template-columns: 1fr; }
    .filter-row { flex-direction: column; align-items: flex-start; }
    .filter-label { min-width: auto; }
    .charts-grid { grid-template-columns: 1fr !important; }
    .chart-card-leaderboard { grid-column: auto !important; grid-row: auto !important; max-height: none; }
    .leaderboard-list { position: static; }
    .leaderboard-list-inner { position: static; overflow: visible; }
    .leaderboard-list-inner .leaderboard-row:nth-child(n+6) { display: none; }
    .bar-label { min-width: 70px; font-size: 0.65rem; }
    .bar-fill span { font-size: 0.58rem; }
    .map-viewer { height: 350px; }
    .hero-number { font-size: 4rem; }
  }
</style>
</head>
<body>

<!-- Header -->
<header class="header">
  <div class="header-inner">
    <div class="header-logos">
      <img src="https://event-assets.gsma.com/4YFN/logos/4YFN_Logo_LockUp_Dated_WHT_RGB.png" alt="4YFN 2026" />
      <div class="logo-divider"></div>
      <span style="font-size:0.65rem;color:rgba(255,255,255,0.45);letter-spacing:0.04em;">Powered by</span>
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 222.15 53.28" style="height:20px;" aria-label="Dealroom"><defs><style>.dr-wh{fill:#fff;}</style></defs><g><path class="dr-wh" d="M201.48,27.53a2.47,2.47,0,0,1,1.22.29,2.25,2.25,0,0,1,.87.75l2.8-2.94A5.37,5.37,0,0,0,204,24.2a8.89,8.89,0,0,0-2.56-.4,8.6,8.6,0,0,0-3,.5,7.15,7.15,0,0,0-2.44,1.46A6.79,6.79,0,0,0,194.44,28a7.63,7.63,0,0,0,0,5.93,6.89,6.89,0,0,0,1.62,2.27,7.31,7.31,0,0,0,2.44,1.46,8.6,8.6,0,0,0,3,.5,8.26,8.26,0,0,0,2.56-.41,5.35,5.35,0,0,0,2.33-1.42l-2.8-2.94a3.63,3.63,0,0,1-.87.74,2.26,2.26,0,0,1-1.22.3,3.22,3.22,0,0,1-2.5-1,3.53,3.53,0,0,1-.89-2.51,3.52,3.52,0,0,1,.89-2.5A3.22,3.22,0,0,1,201.48,27.53Z"/><path class="dr-wh" d="M158.18,25.76a7.15,7.15,0,0,0-2.44-1.46,8.6,8.6,0,0,0-3-.5,8.69,8.69,0,0,0-3,.5,7.17,7.17,0,0,0-2.43,1.46A6.68,6.68,0,0,0,145.71,28a7.63,7.63,0,0,0,0,5.93,6.78,6.78,0,0,0,1.63,2.27,7.17,7.17,0,0,0,2.43,1.46h0a8.69,8.69,0,0,0,3,.5,8.6,8.6,0,0,0,3-.5,7.31,7.31,0,0,0,2.44-1.46A6.92,6.92,0,0,0,159.81,34a7.63,7.63,0,0,0,0-5.93A6.82,6.82,0,0,0,158.18,25.76Zm-2.91,7.75a3.76,3.76,0,0,1-5,0,3.56,3.56,0,0,1-.89-2.51,3.53,3.53,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0,3.53,3.53,0,0,1,.89,2.51A3.56,3.56,0,0,1,155.27,33.51Z"/><path class="dr-wh" d="M141.46,25.76A7.31,7.31,0,0,0,139,24.3a9.16,9.16,0,0,0-6,0,7.17,7.17,0,0,0-2.43,1.46A6.68,6.68,0,0,0,129,28,7.75,7.75,0,0,0,129,34a6.78,6.78,0,0,0,1.63,2.27,7.17,7.17,0,0,0,2.43,1.46h0a9.16,9.16,0,0,0,6,0,7.31,7.31,0,0,0,2.44-1.46A7.07,7.07,0,0,0,143.09,34a7.75,7.75,0,0,0,0-5.93A7,7,0,0,0,141.46,25.76Zm-2.91,7.75a3.76,3.76,0,0,1-5,0,3.56,3.56,0,0,1-.89-2.51,3.48,3.48,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0,3.53,3.53,0,0,1,.89,2.51A3.56,3.56,0,0,1,138.55,33.51Z"/><path class="dr-wh" d="M74.14,25.61h0a4,4,0,0,0-1.88-1.41,7.49,7.49,0,0,0-2.48-.4,5.58,5.58,0,0,0-2.63.6,6.19,6.19,0,0,0-2,1.63,7.32,7.32,0,0,0-1.24,2.32,8.9,8.9,0,0,0-.44,2.76A8.17,8.17,0,0,0,63.93,34,6.63,6.63,0,0,0,65.3,36.2a6.07,6.07,0,0,0,2.14,1.47h0a7.11,7.11,0,0,0,2.77.53,5,5,0,0,0,1.38-.2,6.46,6.46,0,0,0,1.21-.51,5.56,5.56,0,0,0,1-.7,4.66,4.66,0,0,0,.66-.74h0v1.81h3.9V16.51H74.14Zm-.56,7.89a3.74,3.74,0,0,1-5,0A3.53,3.53,0,0,1,67.69,31a3.56,3.56,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0A3.56,3.56,0,0,1,74.47,31,3.53,3.53,0,0,1,73.58,33.5Z"/><path class="dr-wh" d="M221.55,28a6.82,6.82,0,0,0-1.63-2.27,7.31,7.31,0,0,0-2.44-1.46,8.6,8.6,0,0,0-3-.5,8.69,8.69,0,0,0-3,.5,7.17,7.17,0,0,0-2.43,1.46A6.68,6.68,0,0,0,207.45,28a7.75,7.75,0,0,0,0,5.93,6.78,6.78,0,0,0,1.63,2.27,7.17,7.17,0,0,0,2.43,1.46,8.69,8.69,0,0,0,3,.5,8.6,8.6,0,0,0,3-.5,7.31,7.31,0,0,0,2.44-1.46A6.92,6.92,0,0,0,221.55,34a7.63,7.63,0,0,0,0-5.93ZM217,33.51a3.76,3.76,0,0,1-5,0A3.56,3.56,0,0,1,211.1,31a3.53,3.53,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0A3.54,3.54,0,0,1,217.9,31,3.56,3.56,0,0,1,217,33.51Z"/><path class="dr-wh" d="M93.17,25.76a5.56,5.56,0,0,0-2-1.45,6.66,6.66,0,0,0-2.68-.51,8.46,8.46,0,0,0-3,.51A7,7,0,0,0,83,25.76,6.78,6.78,0,0,0,81.41,28a7.75,7.75,0,0,0,0,5.93A6.78,6.78,0,0,0,83,36.23a7,7,0,0,0,2.43,1.46h0a8.58,8.58,0,0,0,3,.5,7.71,7.71,0,0,0,3.23-.71,6.7,6.7,0,0,0,2.57-2l-3-2.17A4.8,4.8,0,0,1,90,34.51a3.05,3.05,0,0,1-1.77.46,3.12,3.12,0,0,1-2.09-.71,3.32,3.32,0,0,1-1.1-1.94h9.85V31a9.08,9.08,0,0,0-.46-3A6.63,6.63,0,0,0,93.17,25.76Zm-8.11,3.68a2.66,2.66,0,0,1,.24-1,2.42,2.42,0,0,1,.6-.82,3,3,0,0,1,.91-.58h0a3.24,3.24,0,0,1,1.23-.23,2.51,2.51,0,0,1,1.9.77,2.45,2.45,0,0,1,.71,1.83Z"/><path class="dr-wh" d="M108.19,25.64a4.47,4.47,0,0,0-1.92-1.37,8.68,8.68,0,0,0-3.07-.47,9.87,9.87,0,0,0-3.28.56A7.65,7.65,0,0,0,97.15,26l2.26,2.31a5.29,5.29,0,0,1,1.54-1.2,4.35,4.35,0,0,1,1.91-.44,2.91,2.91,0,0,1,1.91.67,2.23,2.23,0,0,1,.81,1.79l-1.91,0a20.62,20.62,0,0,0-2.07.17,13.6,13.6,0,0,0-2,.44,6,6,0,0,0-1.71.84A3.87,3.87,0,0,0,96.71,32a4.21,4.21,0,0,0-.44,2,4.15,4.15,0,0,0,.4,1.84,3.83,3.83,0,0,0,1.08,1.32,4.41,4.41,0,0,0,1.57.8h0a6.09,6.09,0,0,0,1.84.28,6.37,6.37,0,0,0,2.48-.48,4,4,0,0,0,1.88-1.58h.06v1.72h3.9v-7a14.61,14.61,0,0,0-.29-3A5.21,5.21,0,0,0,108.19,25.64Zm-2.61,7.1a2.23,2.23,0,0,1-1,1.92,3.45,3.45,0,0,1-1,.48,4.1,4.1,0,0,1-1.2.17A2.69,2.69,0,0,1,101,35a1.21,1.21,0,0,1-.65-1.13,1.35,1.35,0,0,1,.47-1.1,3,3,0,0,1,1.13-.6,6.43,6.43,0,0,1,1.38-.24h0c.49,0,.89,0,1.2,0h1Z"/><path class="dr-wh" d="M191,33.58a2.6,2.6,0,0,0-.84-.55,2.73,2.73,0,0,0-1-.2,2.76,2.76,0,0,0-1,.2,2.5,2.5,0,0,0-1.38,1.38,2.54,2.54,0,0,0-.2,1,2.58,2.58,0,0,0,.2,1,2.41,2.41,0,0,0,.55.83,2.56,2.56,0,0,0,.83.55h0a2.67,2.67,0,0,0,1,.2,2.73,2.73,0,0,0,1-.2,2.6,2.6,0,0,0,.84-.55,2.73,2.73,0,0,0,.55-.83,2.76,2.76,0,0,0,.2-1,2.62,2.62,0,0,0-.75-1.85Z"/><rect class="dr-wh" x="111.67" y="16.51" width="4.24" height="21.35"/><path class="dr-wh" d="M182.91,25.54a3.7,3.7,0,0,0-1.5-1.27,5.34,5.34,0,0,0-2.33-.47,5.42,5.42,0,0,0-2.57.56,4.53,4.53,0,0,0-1.78,1.9,3.78,3.78,0,0,0-1.68-1.87,5.46,5.46,0,0,0-2.56-.59,4.87,4.87,0,0,0-1.42.2,5.18,5.18,0,0,0-1.16.51,3.71,3.71,0,0,0-.87.71,3.18,3.18,0,0,0-.57.79h-.06V24.14h-4.07V37.86h4.24V31a9.36,9.36,0,0,1,.09-1.3,3.4,3.4,0,0,1,.35-1.12,2,2,0,0,1,.78-.79,2.67,2.67,0,0,1,1.33-.29,1.67,1.67,0,0,1,1.12.33,2.05,2.05,0,0,1,.55.82,3.92,3.92,0,0,1,.2,1c0,.36,0,.66,0,.9v7.26h4.25V30.6a5.28,5.28,0,0,1,.12-1.19,2.77,2.77,0,0,1,.43-1,2,2,0,0,1,.79-.67,2.75,2.75,0,0,1,1.23-.23,1.56,1.56,0,0,1,1.46.68,3.32,3.32,0,0,1,.41,1.66v8h4.23v-8.1a10.65,10.65,0,0,0-.23-2.33A5.37,5.37,0,0,0,182.91,25.54Z"/><path class="dr-wh" d="M126.69,23.79a4.07,4.07,0,0,0-2.35.64,5.21,5.21,0,0,0-1.62,1.9h0v-2.2h-4.24V37.86h4.24V32.12a12.9,12.9,0,0,1,.11-1.86,3.58,3.58,0,0,1,.5-1.45,2.48,2.48,0,0,1,1.08-.95,4.55,4.55,0,0,1,1.93-.34,5.62,5.62,0,0,1,.92.07,6.77,6.77,0,0,1,.89.21V23.94a3.87,3.87,0,0,0-.68-.12Z"/><path class="dr-wh" d="M32.75,20.12H31v13h1.3a5.05,5.05,0,0,0,4.17-1.65,8,8,0,0,0,1.33-5.05,7.34,7.34,0,0,0-1.26-4.72A4.66,4.66,0,0,0,32.75,20.12Z"/><path class="dr-wh" d="M51.89,0H1.5A1.5,1.5,0,0,0,0,1.5V51.77a1.51,1.51,0,0,0,1.51,1.51H51.88a1.52,1.52,0,0,0,1.51-1.51V1.5A1.5,1.5,0,0,0,51.89,0ZM15.36,38.2H9.15V27.55h6.21Zm7.81,0H17v-17h6.21Zm18-3.14q-3.18,3.13-9,3.14H24.82V15.07h7.87q5.56,0,8.6,2.85t3,8.23C44.32,30,43.26,33,41.13,35.06Z"/></g></svg>
    </div>
    <div class="header-right-mobile">
      <a href="#" class="nav-saved nav-saved-mobile" onclick="event.preventDefault();showSavedCompanies();" title="Saved companies"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="1"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg><span class="saved-badge saved-badge-mobile" id="navSavedBadgeMobile"></span></a>
      <button class="hamburger-btn" onclick="document.querySelector('.header-nav').classList.toggle('mobile-open')" aria-label="Menu">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
      </button>
    </div>
    <nav class="header-nav">
      <a href="#startups" onclick="this.parentElement.classList.remove('mobile-open')">Startups</a>
      <a href="#founders" onclick="this.parentElement.classList.remove('mobile-open')">Founders</a>
      <a href="#floorplan" onclick="this.parentElement.classList.remove('mobile-open')">Venue Map</a>
      <a href="#" class="nav-saved nav-saved-desktop" onclick="event.preventDefault();showSavedCompanies();" title="Saved companies"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="1"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg><span class="saved-badge" id="navSavedBadge"></span></a>
      <button class="add-startup-btn" onclick="this.parentElement.classList.remove('mobile-open');openModal()">+ Add your startup</button>
    </nav>
  </div>
</header>

<!-- Hero -->
<section class="hero">
  <div class="hero-badge">
    <span class="dot"></span>
    3 &ndash; 6 March 2026 &middot; Fira Gran Via, Barcelona
  </div>
  <div class="hero-number" id="heroNumber">—</div>
  <div class="hero-subtitle">Startups Shaping the Future</div>
  <p>Explore the full lineup of companies attending 4YFN 2026. Filter by theme, funding stage, and more to find the innovators that matter to you.</p>
  <div class="hero-links">
    <a href="#startups" class="hero-link primary">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
      Explore Startups
    </a>
    <a href="#floorplan" class="hero-link secondary">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
      View Venue Map
    </a>
  </div>
</section>

<!-- Stats -->
<div class="stats-bar" id="statsBar">
  <div class="stat-card"><div class="stat-value" id="statFunding">—</div><div class="stat-label">Total Funding</div></div>
  <div class="stat-card"><div class="stat-value" id="statUnicorns">—</div><div class="stat-label">Unicorns</div></div>
  <div class="stat-card"><div class="stat-value" id="statEmployees">—</div><div class="stat-label">Employees</div></div>
  <div class="stat-card"><div class="stat-value" id="statCountries">—</div><div class="stat-label">Countries</div></div>
</div>

<!-- Charts + Leaderboard -->
<section class="charts-section" id="charts">
  <div class="charts-grid">
    <div class="chart-card" id="chartThemes">
      <div class="chart-card-header">
        <div class="chart-title">Startups by Theme</div>
        <button class="share-btn" onclick="shareChart('chartThemes')" title="Download as image"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg></button>
      </div>
      <div class="bar-chart" id="barThemes"></div>
      <div class="chart-watermark">
        <img src="" class="wm-4yfn-logo" style="height:14px;" />
        <span class="wm-divider"></span>
        <span>Powered by</span>
        <svg class="wm-dr-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 222.15 53.28" aria-label="Dealroom"><g fill="#666"><path d="M201.48,27.53a2.47,2.47,0,0,1,1.22.29,2.25,2.25,0,0,1,.87.75l2.8-2.94A5.37,5.37,0,0,0,204,24.2a8.89,8.89,0,0,0-2.56-.4,8.6,8.6,0,0,0-3,.5,7.15,7.15,0,0,0-2.44,1.46A6.79,6.79,0,0,0,194.44,28a7.63,7.63,0,0,0,0,5.93,6.89,6.89,0,0,0,1.62,2.27,7.31,7.31,0,0,0,2.44,1.46,8.6,8.6,0,0,0,3,.5,8.26,8.26,0,0,0,2.56-.41,5.35,5.35,0,0,0,2.33-1.42l-2.8-2.94a3.63,3.63,0,0,1-.87.74,2.26,2.26,0,0,1-1.22.3,3.22,3.22,0,0,1-2.5-1,3.53,3.53,0,0,1-.89-2.51,3.52,3.52,0,0,1,.89-2.5A3.22,3.22,0,0,1,201.48,27.53Z"/><path d="M158.18,25.76a7.15,7.15,0,0,0-2.44-1.46,8.6,8.6,0,0,0-3-.5,8.69,8.69,0,0,0-3,.5,7.17,7.17,0,0,0-2.43,1.46A6.68,6.68,0,0,0,145.71,28a7.63,7.63,0,0,0,0,5.93,6.78,6.78,0,0,0,1.63,2.27,7.17,7.17,0,0,0,2.43,1.46h0a8.69,8.69,0,0,0,3,.5,8.6,8.6,0,0,0,3-.5,7.31,7.31,0,0,0,2.44-1.46A6.92,6.92,0,0,0,159.81,34a7.63,7.63,0,0,0,0-5.93A6.82,6.82,0,0,0,158.18,25.76Zm-2.91,7.75a3.76,3.76,0,0,1-5,0,3.56,3.56,0,0,1-.89-2.51,3.53,3.53,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0,3.53,3.53,0,0,1,.89,2.51A3.56,3.56,0,0,1,155.27,33.51Z"/><path d="M141.46,25.76A7.31,7.31,0,0,0,139,24.3a9.16,9.16,0,0,0-6,0,7.17,7.17,0,0,0-2.43,1.46A6.68,6.68,0,0,0,129,28,7.75,7.75,0,0,0,129,34a6.78,6.78,0,0,0,1.63,2.27,7.17,7.17,0,0,0,2.43,1.46h0a9.16,9.16,0,0,0,6,0,7.31,7.31,0,0,0,2.44-1.46A7.07,7.07,0,0,0,143.09,34a7.75,7.75,0,0,0,0-5.93A7,7,0,0,0,141.46,25.76Zm-2.91,7.75a3.76,3.76,0,0,1-5,0,3.56,3.56,0,0,1-.89-2.51,3.48,3.48,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0,3.53,3.53,0,0,1,.89,2.51A3.56,3.56,0,0,1,138.55,33.51Z"/><path d="M74.14,25.61h0a4,4,0,0,0-1.88-1.41,7.49,7.49,0,0,0-2.48-.4,5.58,5.58,0,0,0-2.63.6,6.19,6.19,0,0,0-2,1.63,7.32,7.32,0,0,0-1.24,2.32,8.9,8.9,0,0,0-.44,2.76A8.17,8.17,0,0,0,63.93,34,6.63,6.63,0,0,0,65.3,36.2a6.07,6.07,0,0,0,2.14,1.47h0a7.11,7.11,0,0,0,2.77.53,5,5,0,0,0,1.38-.2,6.46,6.46,0,0,0,1.21-.51,5.56,5.56,0,0,0,1-.7,4.66,4.66,0,0,0,.66-.74h0v1.81h3.9V16.51H74.14Zm-.56,7.89a3.74,3.74,0,0,1-5,0A3.53,3.53,0,0,1,67.69,31a3.56,3.56,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0A3.56,3.56,0,0,1,74.47,31,3.53,3.53,0,0,1,73.58,33.5Z"/><path d="M221.55,28a6.82,6.82,0,0,0-1.63-2.27,7.31,7.31,0,0,0-2.44-1.46,8.6,8.6,0,0,0-3-.5,8.69,8.69,0,0,0-3,.5,7.17,7.17,0,0,0-2.43,1.46A6.68,6.68,0,0,0,207.45,28a7.75,7.75,0,0,0,0,5.93,6.78,6.78,0,0,0,1.63,2.27,7.17,7.17,0,0,0,2.43,1.46,8.69,8.69,0,0,0,3,.5,8.6,8.6,0,0,0,3-.5,7.31,7.31,0,0,0,2.44-1.46A6.92,6.92,0,0,0,221.55,34a7.63,7.63,0,0,0,0-5.93ZM217,33.51a3.76,3.76,0,0,1-5,0A3.56,3.56,0,0,1,211.1,31a3.53,3.53,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0A3.54,3.54,0,0,1,217.9,31,3.56,3.56,0,0,1,217,33.51Z"/><path d="M93.17,25.76a5.56,5.56,0,0,0-2-1.45,6.66,6.66,0,0,0-2.68-.51,8.46,8.46,0,0,0-3,.51A7,7,0,0,0,83,25.76,6.78,6.78,0,0,0,81.41,28a7.75,7.75,0,0,0,0,5.93A6.78,6.78,0,0,0,83,36.23a7,7,0,0,0,2.43,1.46h0a8.58,8.58,0,0,0,3,.5,7.71,7.71,0,0,0,3.23-.71,6.7,6.7,0,0,0,2.57-2l-3-2.17A4.8,4.8,0,0,1,90,34.51a3.05,3.05,0,0,1-1.77.46,3.12,3.12,0,0,1-2.09-.71,3.32,3.32,0,0,1-1.1-1.94h9.85V31a9.08,9.08,0,0,0-.46-3A6.63,6.63,0,0,0,93.17,25.76Zm-8.11,3.68a2.66,2.66,0,0,1,.24-1,2.42,2.42,0,0,1,.6-.82,3,3,0,0,1,.91-.58h0a3.24,3.24,0,0,1,1.23-.23,2.51,2.51,0,0,1,1.9.77,2.45,2.45,0,0,1,.71,1.83Z"/><path d="M108.19,25.64a4.47,4.47,0,0,0-1.92-1.37,8.68,8.68,0,0,0-3.07-.47,9.87,9.87,0,0,0-3.28.56A7.65,7.65,0,0,0,97.15,26l2.26,2.31a5.29,5.29,0,0,1,1.54-1.2,4.35,4.35,0,0,1,1.91-.44,2.91,2.91,0,0,1,1.91.67,2.23,2.23,0,0,1,.81,1.79l-1.91,0a20.62,20.62,0,0,0-2.07.17,13.6,13.6,0,0,0-2,.44,6,6,0,0,0-1.71.84A3.87,3.87,0,0,0,96.71,32a4.21,4.21,0,0,0-.44,2,4.15,4.15,0,0,0,.4,1.84,3.83,3.83,0,0,0,1.08,1.32,4.41,4.41,0,0,0,1.57.8h0a6.09,6.09,0,0,0,1.84.28,6.37,6.37,0,0,0,2.48-.48,4,4,0,0,0,1.88-1.58h.06v1.72h3.9v-7a14.61,14.61,0,0,0-.29-3A5.21,5.21,0,0,0,108.19,25.64Zm-2.61,7.1a2.23,2.23,0,0,1-1,1.92,3.45,3.45,0,0,1-1,.48,4.1,4.1,0,0,1-1.2.17A2.69,2.69,0,0,1,101,35a1.21,1.21,0,0,1-.65-1.13,1.35,1.35,0,0,1,.47-1.1,3,3,0,0,1,1.13-.6,6.43,6.43,0,0,1,1.38-.24h0c.49,0,.89,0,1.2,0h1Z"/><path d="M191,33.58a2.6,2.6,0,0,0-.84-.55,2.73,2.73,0,0,0-1-.2,2.76,2.76,0,0,0-1,.2,2.5,2.5,0,0,0-1.38,1.38,2.54,2.54,0,0,0-.2,1,2.58,2.58,0,0,0,.2,1,2.41,2.41,0,0,0,.55.83,2.56,2.56,0,0,0,.83.55h0a2.67,2.67,0,0,0,1,.2,2.73,2.73,0,0,0,1-.2,2.6,2.6,0,0,0,.84-.55,2.73,2.73,0,0,0,.55-.83,2.76,2.76,0,0,0,.2-1,2.62,2.62,0,0,0-.75-1.85Z"/><rect x="111.67" y="16.51" width="4.24" height="21.35"/><path d="M182.91,25.54a3.7,3.7,0,0,0-1.5-1.27,5.34,5.34,0,0,0-2.33-.47,5.42,5.42,0,0,0-2.57.56,4.53,4.53,0,0,0-1.78,1.9,3.78,3.78,0,0,0-1.68-1.87,5.46,5.46,0,0,0-2.56-.59,4.87,4.87,0,0,0-1.42.2,5.18,5.18,0,0,0-1.16.51,3.71,3.71,0,0,0-.87.71,3.18,3.18,0,0,0-.57.79h-.06V24.14h-4.07V37.86h4.24V31a9.36,9.36,0,0,1,.09-1.3,3.4,3.4,0,0,1,.35-1.12,2,2,0,0,1,.78-.79,2.67,2.67,0,0,1,1.33-.29,1.67,1.67,0,0,1,1.12.33,2.05,2.05,0,0,1,.55.82,3.92,3.92,0,0,1,.2,1c0,.36,0,.66,0,.9v7.26h4.25V30.6a5.28,5.28,0,0,1,.12-1.19,2.77,2.77,0,0,1,.43-1,2,2,0,0,1,.79-.67,2.75,2.75,0,0,1,1.23-.23,1.56,1.56,0,0,1,1.46.68,3.32,3.32,0,0,1,.41,1.66v8h4.23v-8.1a10.65,10.65,0,0,0-.23-2.33A5.37,5.37,0,0,0,182.91,25.54Z"/><path d="M126.69,23.79a4.07,4.07,0,0,0-2.35.64,5.21,5.21,0,0,0-1.62,1.9h0v-2.2h-4.24V37.86h4.24V32.12a12.9,12.9,0,0,1,.11-1.86,3.58,3.58,0,0,1,.5-1.45,2.48,2.48,0,0,1,1.08-.95,4.55,4.55,0,0,1,1.93-.34,5.62,5.62,0,0,1,.92.07,6.77,6.77,0,0,1,.89.21V23.94a3.87,3.87,0,0,0-.68-.12Z"/><path d="M32.75,20.12H31v13h1.3a5.05,5.05,0,0,0,4.17-1.65,8,8,0,0,0,1.33-5.05,7.34,7.34,0,0,0-1.26-4.72A4.66,4.66,0,0,0,32.75,20.12Z"/><path d="M51.89,0H1.5A1.5,1.5,0,0,0,0,1.5V51.77a1.51,1.51,0,0,0,1.51,1.51H51.88a1.52,1.52,0,0,0,1.51-1.51V1.5A1.5,1.5,0,0,0,51.89,0ZM15.36,38.2H9.15V27.55h6.21Zm7.81,0H17v-17h6.21Zm18-3.14q-3.18,3.13-9,3.14H24.82V15.07h7.87q5.56,0,8.6,2.85t3,8.23C44.32,30,43.26,33,41.13,35.06Z"/></g></svg>
      </div>
    </div>
    <div class="chart-card" id="chartStages">
      <div class="chart-card-header">
        <div class="chart-title">Funding Stage Distribution</div>
        <button class="share-btn" onclick="shareChart('chartStages')" title="Download as image"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg></button>
      </div>
      <div class="col-chart" id="barStages"></div>
      <div class="chart-watermark">
        <img src="" class="wm-4yfn-logo" style="height:14px;" />
        <span class="wm-divider"></span>
        <span>Powered by</span>
        <svg class="wm-dr-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 222.15 53.28" aria-label="Dealroom"><g fill="#666"><path d="M201.48,27.53a2.47,2.47,0,0,1,1.22.29,2.25,2.25,0,0,1,.87.75l2.8-2.94A5.37,5.37,0,0,0,204,24.2a8.89,8.89,0,0,0-2.56-.4,8.6,8.6,0,0,0-3,.5,7.15,7.15,0,0,0-2.44,1.46A6.79,6.79,0,0,0,194.44,28a7.63,7.63,0,0,0,0,5.93,6.89,6.89,0,0,0,1.62,2.27,7.31,7.31,0,0,0,2.44,1.46,8.6,8.6,0,0,0,3,.5,8.26,8.26,0,0,0,2.56-.41,5.35,5.35,0,0,0,2.33-1.42l-2.8-2.94a3.63,3.63,0,0,1-.87.74,2.26,2.26,0,0,1-1.22.3,3.22,3.22,0,0,1-2.5-1,3.53,3.53,0,0,1-.89-2.51,3.52,3.52,0,0,1,.89-2.5A3.22,3.22,0,0,1,201.48,27.53Z"/><path d="M158.18,25.76a7.15,7.15,0,0,0-2.44-1.46,8.6,8.6,0,0,0-3-.5,8.69,8.69,0,0,0-3,.5,7.17,7.17,0,0,0-2.43,1.46A6.68,6.68,0,0,0,145.71,28a7.63,7.63,0,0,0,0,5.93,6.78,6.78,0,0,0,1.63,2.27,7.17,7.17,0,0,0,2.43,1.46h0a8.69,8.69,0,0,0,3,.5,8.6,8.6,0,0,0,3-.5,7.31,7.31,0,0,0,2.44-1.46A6.92,6.92,0,0,0,159.81,34a7.63,7.63,0,0,0,0-5.93A6.82,6.82,0,0,0,158.18,25.76Zm-2.91,7.75a3.76,3.76,0,0,1-5,0,3.56,3.56,0,0,1-.89-2.51,3.53,3.53,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0,3.53,3.53,0,0,1,.89,2.51A3.56,3.56,0,0,1,155.27,33.51Z"/><path d="M141.46,25.76A7.31,7.31,0,0,0,139,24.3a9.16,9.16,0,0,0-6,0,7.17,7.17,0,0,0-2.43,1.46A6.68,6.68,0,0,0,129,28,7.75,7.75,0,0,0,129,34a6.78,6.78,0,0,0,1.63,2.27,7.17,7.17,0,0,0,2.43,1.46h0a9.16,9.16,0,0,0,6,0,7.31,7.31,0,0,0,2.44-1.46A7.07,7.07,0,0,0,143.09,34a7.75,7.75,0,0,0,0-5.93A7,7,0,0,0,141.46,25.76Zm-2.91,7.75a3.76,3.76,0,0,1-5,0,3.56,3.56,0,0,1-.89-2.51,3.48,3.48,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0,3.53,3.53,0,0,1,.89,2.51A3.56,3.56,0,0,1,138.55,33.51Z"/><path d="M74.14,25.61h0a4,4,0,0,0-1.88-1.41,7.49,7.49,0,0,0-2.48-.4,5.58,5.58,0,0,0-2.63.6,6.19,6.19,0,0,0-2,1.63,7.32,7.32,0,0,0-1.24,2.32,8.9,8.9,0,0,0-.44,2.76A8.17,8.17,0,0,0,63.93,34,6.63,6.63,0,0,0,65.3,36.2a6.07,6.07,0,0,0,2.14,1.47h0a7.11,7.11,0,0,0,2.77.53,5,5,0,0,0,1.38-.2,6.46,6.46,0,0,0,1.21-.51,5.56,5.56,0,0,0,1-.7,4.66,4.66,0,0,0,.66-.74h0v1.81h3.9V16.51H74.14Zm-.56,7.89a3.74,3.74,0,0,1-5,0A3.53,3.53,0,0,1,67.69,31a3.56,3.56,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0A3.56,3.56,0,0,1,74.47,31,3.53,3.53,0,0,1,73.58,33.5Z"/><path d="M221.55,28a6.82,6.82,0,0,0-1.63-2.27,7.31,7.31,0,0,0-2.44-1.46,8.6,8.6,0,0,0-3-.5,8.69,8.69,0,0,0-3,.5,7.17,7.17,0,0,0-2.43,1.46A6.68,6.68,0,0,0,207.45,28a7.75,7.75,0,0,0,0,5.93,6.78,6.78,0,0,0,1.63,2.27,7.17,7.17,0,0,0,2.43,1.46,8.69,8.69,0,0,0,3,.5,8.6,8.6,0,0,0,3-.5,7.31,7.31,0,0,0,2.44-1.46A6.92,6.92,0,0,0,221.55,34a7.63,7.63,0,0,0,0-5.93ZM217,33.51a3.76,3.76,0,0,1-5,0A3.56,3.56,0,0,1,211.1,31a3.53,3.53,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0A3.54,3.54,0,0,1,217.9,31,3.56,3.56,0,0,1,217,33.51Z"/><path d="M93.17,25.76a5.56,5.56,0,0,0-2-1.45,6.66,6.66,0,0,0-2.68-.51,8.46,8.46,0,0,0-3,.51A7,7,0,0,0,83,25.76,6.78,6.78,0,0,0,81.41,28a7.75,7.75,0,0,0,0,5.93A6.78,6.78,0,0,0,83,36.23a7,7,0,0,0,2.43,1.46h0a8.58,8.58,0,0,0,3,.5,7.71,7.71,0,0,0,3.23-.71,6.7,6.7,0,0,0,2.57-2l-3-2.17A4.8,4.8,0,0,1,90,34.51a3.05,3.05,0,0,1-1.77.46,3.12,3.12,0,0,1-2.09-.71,3.32,3.32,0,0,1-1.1-1.94h9.85V31a9.08,9.08,0,0,0-.46-3A6.63,6.63,0,0,0,93.17,25.76Zm-8.11,3.68a2.66,2.66,0,0,1,.24-1,2.42,2.42,0,0,1,.6-.82,3,3,0,0,1,.91-.58h0a3.24,3.24,0,0,1,1.23-.23,2.51,2.51,0,0,1,1.9.77,2.45,2.45,0,0,1,.71,1.83Z"/><path d="M108.19,25.64a4.47,4.47,0,0,0-1.92-1.37,8.68,8.68,0,0,0-3.07-.47,9.87,9.87,0,0,0-3.28.56A7.65,7.65,0,0,0,97.15,26l2.26,2.31a5.29,5.29,0,0,1,1.54-1.2,4.35,4.35,0,0,1,1.91-.44,2.91,2.91,0,0,1,1.91.67,2.23,2.23,0,0,1,.81,1.79l-1.91,0a20.62,20.62,0,0,0-2.07.17,13.6,13.6,0,0,0-2,.44,6,6,0,0,0-1.71.84A3.87,3.87,0,0,0,96.71,32a4.21,4.21,0,0,0-.44,2,4.15,4.15,0,0,0,.4,1.84,3.83,3.83,0,0,0,1.08,1.32,4.41,4.41,0,0,0,1.57.8h0a6.09,6.09,0,0,0,1.84.28,6.37,6.37,0,0,0,2.48-.48,4,4,0,0,0,1.88-1.58h.06v1.72h3.9v-7a14.61,14.61,0,0,0-.29-3A5.21,5.21,0,0,0,108.19,25.64Zm-2.61,7.1a2.23,2.23,0,0,1-1,1.92,3.45,3.45,0,0,1-1,.48,4.1,4.1,0,0,1-1.2.17A2.69,2.69,0,0,1,101,35a1.21,1.21,0,0,1-.65-1.13,1.35,1.35,0,0,1,.47-1.1,3,3,0,0,1,1.13-.6,6.43,6.43,0,0,1,1.38-.24h0c.49,0,.89,0,1.2,0h1Z"/><path d="M191,33.58a2.6,2.6,0,0,0-.84-.55,2.73,2.73,0,0,0-1-.2,2.76,2.76,0,0,0-1,.2,2.5,2.5,0,0,0-1.38,1.38,2.54,2.54,0,0,0-.2,1,2.58,2.58,0,0,0,.2,1,2.41,2.41,0,0,0,.55.83,2.56,2.56,0,0,0,.83.55h0a2.67,2.67,0,0,0,1,.2,2.73,2.73,0,0,0,1-.2,2.6,2.6,0,0,0,.84-.55,2.73,2.73,0,0,0,.55-.83,2.76,2.76,0,0,0,.2-1,2.62,2.62,0,0,0-.75-1.85Z"/><rect x="111.67" y="16.51" width="4.24" height="21.35"/><path d="M182.91,25.54a3.7,3.7,0,0,0-1.5-1.27,5.34,5.34,0,0,0-2.33-.47,5.42,5.42,0,0,0-2.57.56,4.53,4.53,0,0,0-1.78,1.9,3.78,3.78,0,0,0-1.68-1.87,5.46,5.46,0,0,0-2.56-.59,4.87,4.87,0,0,0-1.42.2,5.18,5.18,0,0,0-1.16.51,3.71,3.71,0,0,0-.87.71,3.18,3.18,0,0,0-.57.79h-.06V24.14h-4.07V37.86h4.24V31a9.36,9.36,0,0,1,.09-1.3,3.4,3.4,0,0,1,.35-1.12,2,2,0,0,1,.78-.79,2.67,2.67,0,0,1,1.33-.29,1.67,1.67,0,0,1,1.12.33,2.05,2.05,0,0,1,.55.82,3.92,3.92,0,0,1,.2,1c0,.36,0,.66,0,.9v7.26h4.25V30.6a5.28,5.28,0,0,1,.12-1.19,2.77,2.77,0,0,1,.43-1,2,2,0,0,1,.79-.67,2.75,2.75,0,0,1,1.23-.23,1.56,1.56,0,0,1,1.46.68,3.32,3.32,0,0,1,.41,1.66v8h4.23v-8.1a10.65,10.65,0,0,0-.23-2.33A5.37,5.37,0,0,0,182.91,25.54Z"/><path d="M126.69,23.79a4.07,4.07,0,0,0-2.35.64,5.21,5.21,0,0,0-1.62,1.9h0v-2.2h-4.24V37.86h4.24V32.12a12.9,12.9,0,0,1,.11-1.86,3.58,3.58,0,0,1,.5-1.45,2.48,2.48,0,0,1,1.08-.95,4.55,4.55,0,0,1,1.93-.34,5.62,5.62,0,0,1,.92.07,6.77,6.77,0,0,1,.89.21V23.94a3.87,3.87,0,0,0-.68-.12Z"/><path d="M32.75,20.12H31v13h1.3a5.05,5.05,0,0,0,4.17-1.65,8,8,0,0,0,1.33-5.05,7.34,7.34,0,0,0-1.26-4.72A4.66,4.66,0,0,0,32.75,20.12Z"/><path d="M51.89,0H1.5A1.5,1.5,0,0,0,0,1.5V51.77a1.51,1.51,0,0,0,1.51,1.51H51.88a1.52,1.52,0,0,0,1.51-1.51V1.5A1.5,1.5,0,0,0,51.89,0ZM15.36,38.2H9.15V27.55h6.21Zm7.81,0H17v-17h6.21Zm18-3.14q-3.18,3.13-9,3.14H24.82V15.07h7.87q5.56,0,8.6,2.85t3,8.23C44.32,30,43.26,33,41.13,35.06Z"/></g></svg>
      </div>
    </div>
    <div class="chart-card" id="chartCountries">
      <div class="chart-card-header">
        <div class="chart-title">Top Countries</div>
        <button class="share-btn" onclick="shareChart('chartCountries')" title="Download as image"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg></button>
      </div>
      <div class="treemap" id="barCountries"></div>
      <div class="chart-watermark">
        <img src="" class="wm-4yfn-logo" style="height:14px;" />
        <span class="wm-divider"></span>
        <span>Powered by</span>
        <svg class="wm-dr-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 222.15 53.28" aria-label="Dealroom"><g fill="#666"><path d="M201.48,27.53a2.47,2.47,0,0,1,1.22.29,2.25,2.25,0,0,1,.87.75l2.8-2.94A5.37,5.37,0,0,0,204,24.2a8.89,8.89,0,0,0-2.56-.4,8.6,8.6,0,0,0-3,.5,7.15,7.15,0,0,0-2.44,1.46A6.79,6.79,0,0,0,194.44,28a7.63,7.63,0,0,0,0,5.93,6.89,6.89,0,0,0,1.62,2.27,7.31,7.31,0,0,0,2.44,1.46,8.6,8.6,0,0,0,3,.5,8.26,8.26,0,0,0,2.56-.41,5.35,5.35,0,0,0,2.33-1.42l-2.8-2.94a3.63,3.63,0,0,1-.87.74,2.26,2.26,0,0,1-1.22.3,3.22,3.22,0,0,1-2.5-1,3.53,3.53,0,0,1-.89-2.51,3.52,3.52,0,0,1,.89-2.5A3.22,3.22,0,0,1,201.48,27.53Z"/><path d="M158.18,25.76a7.15,7.15,0,0,0-2.44-1.46,8.6,8.6,0,0,0-3-.5,8.69,8.69,0,0,0-3,.5,7.17,7.17,0,0,0-2.43,1.46A6.68,6.68,0,0,0,145.71,28a7.63,7.63,0,0,0,0,5.93,6.78,6.78,0,0,0,1.63,2.27,7.17,7.17,0,0,0,2.43,1.46h0a8.69,8.69,0,0,0,3,.5,8.6,8.6,0,0,0,3-.5,7.31,7.31,0,0,0,2.44-1.46A6.92,6.92,0,0,0,159.81,34a7.63,7.63,0,0,0,0-5.93A6.82,6.82,0,0,0,158.18,25.76Zm-2.91,7.75a3.76,3.76,0,0,1-5,0,3.56,3.56,0,0,1-.89-2.51,3.53,3.53,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0,3.53,3.53,0,0,1,.89,2.51A3.56,3.56,0,0,1,155.27,33.51Z"/><path d="M141.46,25.76A7.31,7.31,0,0,0,139,24.3a9.16,9.16,0,0,0-6,0,7.17,7.17,0,0,0-2.43,1.46A6.68,6.68,0,0,0,129,28,7.75,7.75,0,0,0,129,34a6.78,6.78,0,0,0,1.63,2.27,7.17,7.17,0,0,0,2.43,1.46h0a9.16,9.16,0,0,0,6,0,7.31,7.31,0,0,0,2.44-1.46A7.07,7.07,0,0,0,143.09,34a7.75,7.75,0,0,0,0-5.93A7,7,0,0,0,141.46,25.76Zm-2.91,7.75a3.76,3.76,0,0,1-5,0,3.56,3.56,0,0,1-.89-2.51,3.48,3.48,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0,3.53,3.53,0,0,1,.89,2.51A3.56,3.56,0,0,1,138.55,33.51Z"/><path d="M74.14,25.61h0a4,4,0,0,0-1.88-1.41,7.49,7.49,0,0,0-2.48-.4,5.58,5.58,0,0,0-2.63.6,6.19,6.19,0,0,0-2,1.63,7.32,7.32,0,0,0-1.24,2.32,8.9,8.9,0,0,0-.44,2.76A8.17,8.17,0,0,0,63.93,34,6.63,6.63,0,0,0,65.3,36.2a6.07,6.07,0,0,0,2.14,1.47h0a7.11,7.11,0,0,0,2.77.53,5,5,0,0,0,1.38-.2,6.46,6.46,0,0,0,1.21-.51,5.56,5.56,0,0,0,1-.7,4.66,4.66,0,0,0,.66-.74h0v1.81h3.9V16.51H74.14Zm-.56,7.89a3.74,3.74,0,0,1-5,0A3.53,3.53,0,0,1,67.69,31a3.56,3.56,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0A3.56,3.56,0,0,1,74.47,31,3.53,3.53,0,0,1,73.58,33.5Z"/><path d="M221.55,28a6.82,6.82,0,0,0-1.63-2.27,7.31,7.31,0,0,0-2.44-1.46,8.6,8.6,0,0,0-3-.5,8.69,8.69,0,0,0-3,.5,7.17,7.17,0,0,0-2.43,1.46A6.68,6.68,0,0,0,207.45,28a7.75,7.75,0,0,0,0,5.93,6.78,6.78,0,0,0,1.63,2.27,7.17,7.17,0,0,0,2.43,1.46,8.69,8.69,0,0,0,3,.5,8.6,8.6,0,0,0,3-.5,7.31,7.31,0,0,0,2.44-1.46A6.92,6.92,0,0,0,221.55,34a7.63,7.63,0,0,0,0-5.93ZM217,33.51a3.76,3.76,0,0,1-5,0A3.56,3.56,0,0,1,211.1,31a3.53,3.53,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0A3.54,3.54,0,0,1,217.9,31,3.56,3.56,0,0,1,217,33.51Z"/><path d="M93.17,25.76a5.56,5.56,0,0,0-2-1.45,6.66,6.66,0,0,0-2.68-.51,8.46,8.46,0,0,0-3,.51A7,7,0,0,0,83,25.76,6.78,6.78,0,0,0,81.41,28a7.75,7.75,0,0,0,0,5.93A6.78,6.78,0,0,0,83,36.23a7,7,0,0,0,2.43,1.46h0a8.58,8.58,0,0,0,3,.5,7.71,7.71,0,0,0,3.23-.71,6.7,6.7,0,0,0,2.57-2l-3-2.17A4.8,4.8,0,0,1,90,34.51a3.05,3.05,0,0,1-1.77.46,3.12,3.12,0,0,1-2.09-.71,3.32,3.32,0,0,1-1.1-1.94h9.85V31a9.08,9.08,0,0,0-.46-3A6.63,6.63,0,0,0,93.17,25.76Zm-8.11,3.68a2.66,2.66,0,0,1,.24-1,2.42,2.42,0,0,1,.6-.82,3,3,0,0,1,.91-.58h0a3.24,3.24,0,0,1,1.23-.23,2.51,2.51,0,0,1,1.9.77,2.45,2.45,0,0,1,.71,1.83Z"/><path d="M108.19,25.64a4.47,4.47,0,0,0-1.92-1.37,8.68,8.68,0,0,0-3.07-.47,9.87,9.87,0,0,0-3.28.56A7.65,7.65,0,0,0,97.15,26l2.26,2.31a5.29,5.29,0,0,1,1.54-1.2,4.35,4.35,0,0,1,1.91-.44,2.91,2.91,0,0,1,1.91.67,2.23,2.23,0,0,1,.81,1.79l-1.91,0a20.62,20.62,0,0,0-2.07.17,13.6,13.6,0,0,0-2,.44,6,6,0,0,0-1.71.84A3.87,3.87,0,0,0,96.71,32a4.21,4.21,0,0,0-.44,2,4.15,4.15,0,0,0,.4,1.84,3.83,3.83,0,0,0,1.08,1.32,4.41,4.41,0,0,0,1.57.8h0a6.09,6.09,0,0,0,1.84.28,6.37,6.37,0,0,0,2.48-.48,4,4,0,0,0,1.88-1.58h.06v1.72h3.9v-7a14.61,14.61,0,0,0-.29-3A5.21,5.21,0,0,0,108.19,25.64Zm-2.61,7.1a2.23,2.23,0,0,1-1,1.92,3.45,3.45,0,0,1-1,.48,4.1,4.1,0,0,1-1.2.17A2.69,2.69,0,0,1,101,35a1.21,1.21,0,0,1-.65-1.13,1.35,1.35,0,0,1,.47-1.1,3,3,0,0,1,1.13-.6,6.43,6.43,0,0,1,1.38-.24h0c.49,0,.89,0,1.2,0h1Z"/><path d="M191,33.58a2.6,2.6,0,0,0-.84-.55,2.73,2.73,0,0,0-1-.2,2.76,2.76,0,0,0-1,.2,2.5,2.5,0,0,0-1.38,1.38,2.54,2.54,0,0,0-.2,1,2.58,2.58,0,0,0,.2,1,2.41,2.41,0,0,0,.55.83,2.56,2.56,0,0,0,.83.55h0a2.67,2.67,0,0,0,1,.2,2.73,2.73,0,0,0,1-.2,2.6,2.6,0,0,0,.84-.55,2.73,2.73,0,0,0,.55-.83,2.76,2.76,0,0,0,.2-1,2.62,2.62,0,0,0-.75-1.85Z"/><rect x="111.67" y="16.51" width="4.24" height="21.35"/><path d="M182.91,25.54a3.7,3.7,0,0,0-1.5-1.27,5.34,5.34,0,0,0-2.33-.47,5.42,5.42,0,0,0-2.57.56,4.53,4.53,0,0,0-1.78,1.9,3.78,3.78,0,0,0-1.68-1.87,5.46,5.46,0,0,0-2.56-.59,4.87,4.87,0,0,0-1.42.2,5.18,5.18,0,0,0-1.16.51,3.71,3.71,0,0,0-.87.71,3.18,3.18,0,0,0-.57.79h-.06V24.14h-4.07V37.86h4.24V31a9.36,9.36,0,0,1,.09-1.3,3.4,3.4,0,0,1,.35-1.12,2,2,0,0,1,.78-.79,2.67,2.67,0,0,1,1.33-.29,1.67,1.67,0,0,1,1.12.33,2.05,2.05,0,0,1,.55.82,3.92,3.92,0,0,1,.2,1c0,.36,0,.66,0,.9v7.26h4.25V30.6a5.28,5.28,0,0,1,.12-1.19,2.77,2.77,0,0,1,.43-1,2,2,0,0,1,.79-.67,2.75,2.75,0,0,1,1.23-.23,1.56,1.56,0,0,1,1.46.68,3.32,3.32,0,0,1,.41,1.66v8h4.23v-8.1a10.65,10.65,0,0,0-.23-2.33A5.37,5.37,0,0,0,182.91,25.54Z"/><path d="M126.69,23.79a4.07,4.07,0,0,0-2.35.64,5.21,5.21,0,0,0-1.62,1.9h0v-2.2h-4.24V37.86h4.24V32.12a12.9,12.9,0,0,1,.11-1.86,3.58,3.58,0,0,1,.5-1.45,2.48,2.48,0,0,1,1.08-.95,4.55,4.55,0,0,1,1.93-.34,5.62,5.62,0,0,1,.92.07,6.77,6.77,0,0,1,.89.21V23.94a3.87,3.87,0,0,0-.68-.12Z"/><path d="M32.75,20.12H31v13h1.3a5.05,5.05,0,0,0,4.17-1.65,8,8,0,0,0,1.33-5.05,7.34,7.34,0,0,0-1.26-4.72A4.66,4.66,0,0,0,32.75,20.12Z"/><path d="M51.89,0H1.5A1.5,1.5,0,0,0,0,1.5V51.77a1.51,1.51,0,0,0,1.51,1.51H51.88a1.52,1.52,0,0,0,1.51-1.51V1.5A1.5,1.5,0,0,0,51.89,0ZM15.36,38.2H9.15V27.55h6.21Zm7.81,0H17v-17h6.21Zm18-3.14q-3.18,3.13-9,3.14H24.82V15.07h7.87q5.56,0,8.6,2.85t3,8.23C44.32,30,43.26,33,41.13,35.06Z"/></g></svg>
      </div>
    </div>
    <div class="chart-card" id="chartYears">
      <div class="chart-card-header">
        <div class="chart-title">Founded Year</div>
        <button class="share-btn" onclick="shareChart('chartYears')" title="Download as image"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg></button>
      </div>
      <div class="col-chart" id="barYears"></div>
      <div class="chart-watermark">
        <img src="" class="wm-4yfn-logo" style="height:14px;" />
        <span class="wm-divider"></span>
        <span>Powered by</span>
        <svg class="wm-dr-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 222.15 53.28" aria-label="Dealroom"><g fill="#666"><path d="M201.48,27.53a2.47,2.47,0,0,1,1.22.29,2.25,2.25,0,0,1,.87.75l2.8-2.94A5.37,5.37,0,0,0,204,24.2a8.89,8.89,0,0,0-2.56-.4,8.6,8.6,0,0,0-3,.5,7.15,7.15,0,0,0-2.44,1.46A6.79,6.79,0,0,0,194.44,28a7.63,7.63,0,0,0,0,5.93,6.89,6.89,0,0,0,1.62,2.27,7.31,7.31,0,0,0,2.44,1.46,8.6,8.6,0,0,0,3,.5,8.26,8.26,0,0,0,2.56-.41,5.35,5.35,0,0,0,2.33-1.42l-2.8-2.94a3.63,3.63,0,0,1-.87.74,2.26,2.26,0,0,1-1.22.3,3.22,3.22,0,0,1-2.5-1,3.53,3.53,0,0,1-.89-2.51,3.52,3.52,0,0,1,.89-2.5A3.22,3.22,0,0,1,201.48,27.53Z"/><path d="M158.18,25.76a7.15,7.15,0,0,0-2.44-1.46,8.6,8.6,0,0,0-3-.5,8.69,8.69,0,0,0-3,.5,7.17,7.17,0,0,0-2.43,1.46A6.68,6.68,0,0,0,145.71,28a7.63,7.63,0,0,0,0,5.93,6.78,6.78,0,0,0,1.63,2.27,7.17,7.17,0,0,0,2.43,1.46h0a8.69,8.69,0,0,0,3,.5,8.6,8.6,0,0,0,3-.5,7.31,7.31,0,0,0,2.44-1.46A6.92,6.92,0,0,0,159.81,34a7.63,7.63,0,0,0,0-5.93A6.82,6.82,0,0,0,158.18,25.76Zm-2.91,7.75a3.76,3.76,0,0,1-5,0,3.56,3.56,0,0,1-.89-2.51,3.53,3.53,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0,3.53,3.53,0,0,1,.89,2.51A3.56,3.56,0,0,1,155.27,33.51Z"/><path d="M141.46,25.76A7.31,7.31,0,0,0,139,24.3a9.16,9.16,0,0,0-6,0,7.17,7.17,0,0,0-2.43,1.46A6.68,6.68,0,0,0,129,28,7.75,7.75,0,0,0,129,34a6.78,6.78,0,0,0,1.63,2.27,7.17,7.17,0,0,0,2.43,1.46h0a9.16,9.16,0,0,0,6,0,7.31,7.31,0,0,0,2.44-1.46A7.07,7.07,0,0,0,143.09,34a7.75,7.75,0,0,0,0-5.93A7,7,0,0,0,141.46,25.76Zm-2.91,7.75a3.76,3.76,0,0,1-5,0,3.56,3.56,0,0,1-.89-2.51,3.48,3.48,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0,3.53,3.53,0,0,1,.89,2.51A3.56,3.56,0,0,1,138.55,33.51Z"/><path d="M74.14,25.61h0a4,4,0,0,0-1.88-1.41,7.49,7.49,0,0,0-2.48-.4,5.58,5.58,0,0,0-2.63.6,6.19,6.19,0,0,0-2,1.63,7.32,7.32,0,0,0-1.24,2.32,8.9,8.9,0,0,0-.44,2.76A8.17,8.17,0,0,0,63.93,34,6.63,6.63,0,0,0,65.3,36.2a6.07,6.07,0,0,0,2.14,1.47h0a7.11,7.11,0,0,0,2.77.53,5,5,0,0,0,1.38-.2,6.46,6.46,0,0,0,1.21-.51,5.56,5.56,0,0,0,1-.7,4.66,4.66,0,0,0,.66-.74h0v1.81h3.9V16.51H74.14Zm-.56,7.89a3.74,3.74,0,0,1-5,0A3.53,3.53,0,0,1,67.69,31a3.56,3.56,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0A3.56,3.56,0,0,1,74.47,31,3.53,3.53,0,0,1,73.58,33.5Z"/><path d="M221.55,28a6.82,6.82,0,0,0-1.63-2.27,7.31,7.31,0,0,0-2.44-1.46,8.6,8.6,0,0,0-3-.5,8.69,8.69,0,0,0-3,.5,7.17,7.17,0,0,0-2.43,1.46A6.68,6.68,0,0,0,207.45,28a7.75,7.75,0,0,0,0,5.93,6.78,6.78,0,0,0,1.63,2.27,7.17,7.17,0,0,0,2.43,1.46,8.69,8.69,0,0,0,3,.5,8.6,8.6,0,0,0,3-.5,7.31,7.31,0,0,0,2.44-1.46A6.92,6.92,0,0,0,221.55,34a7.63,7.63,0,0,0,0-5.93ZM217,33.51a3.76,3.76,0,0,1-5,0A3.56,3.56,0,0,1,211.1,31a3.53,3.53,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0A3.54,3.54,0,0,1,217.9,31,3.56,3.56,0,0,1,217,33.51Z"/><path d="M93.17,25.76a5.56,5.56,0,0,0-2-1.45,6.66,6.66,0,0,0-2.68-.51,8.46,8.46,0,0,0-3,.51A7,7,0,0,0,83,25.76,6.78,6.78,0,0,0,81.41,28a7.75,7.75,0,0,0,0,5.93A6.78,6.78,0,0,0,83,36.23a7,7,0,0,0,2.43,1.46h0a8.58,8.58,0,0,0,3,.5,7.71,7.71,0,0,0,3.23-.71,6.7,6.7,0,0,0,2.57-2l-3-2.17A4.8,4.8,0,0,1,90,34.51a3.05,3.05,0,0,1-1.77.46,3.12,3.12,0,0,1-2.09-.71,3.32,3.32,0,0,1-1.1-1.94h9.85V31a9.08,9.08,0,0,0-.46-3A6.63,6.63,0,0,0,93.17,25.76Zm-8.11,3.68a2.66,2.66,0,0,1,.24-1,2.42,2.42,0,0,1,.6-.82,3,3,0,0,1,.91-.58h0a3.24,3.24,0,0,1,1.23-.23,2.51,2.51,0,0,1,1.9.77,2.45,2.45,0,0,1,.71,1.83Z"/><path d="M108.19,25.64a4.47,4.47,0,0,0-1.92-1.37,8.68,8.68,0,0,0-3.07-.47,9.87,9.87,0,0,0-3.28.56A7.65,7.65,0,0,0,97.15,26l2.26,2.31a5.29,5.29,0,0,1,1.54-1.2,4.35,4.35,0,0,1,1.91-.44,2.91,2.91,0,0,1,1.91.67,2.23,2.23,0,0,1,.81,1.79l-1.91,0a20.62,20.62,0,0,0-2.07.17,13.6,13.6,0,0,0-2,.44,6,6,0,0,0-1.71.84A3.87,3.87,0,0,0,96.71,32a4.21,4.21,0,0,0-.44,2,4.15,4.15,0,0,0,.4,1.84,3.83,3.83,0,0,0,1.08,1.32,4.41,4.41,0,0,0,1.57.8h0a6.09,6.09,0,0,0,1.84.28,6.37,6.37,0,0,0,2.48-.48,4,4,0,0,0,1.88-1.58h.06v1.72h3.9v-7a14.61,14.61,0,0,0-.29-3A5.21,5.21,0,0,0,108.19,25.64Zm-2.61,7.1a2.23,2.23,0,0,1-1,1.92,3.45,3.45,0,0,1-1,.48,4.1,4.1,0,0,1-1.2.17A2.69,2.69,0,0,1,101,35a1.21,1.21,0,0,1-.65-1.13,1.35,1.35,0,0,1,.47-1.1,3,3,0,0,1,1.13-.6,6.43,6.43,0,0,1,1.38-.24h0c.49,0,.89,0,1.2,0h1Z"/><path d="M191,33.58a2.6,2.6,0,0,0-.84-.55,2.73,2.73,0,0,0-1-.2,2.76,2.76,0,0,0-1,.2,2.5,2.5,0,0,0-1.38,1.38,2.54,2.54,0,0,0-.2,1,2.58,2.58,0,0,0,.2,1,2.41,2.41,0,0,0,.55.83,2.56,2.56,0,0,0,.83.55h0a2.67,2.67,0,0,0,1,.2,2.73,2.73,0,0,0,1-.2,2.6,2.6,0,0,0,.84-.55,2.73,2.73,0,0,0,.55-.83,2.76,2.76,0,0,0,.2-1,2.62,2.62,0,0,0-.75-1.85Z"/><rect x="111.67" y="16.51" width="4.24" height="21.35"/><path d="M182.91,25.54a3.7,3.7,0,0,0-1.5-1.27,5.34,5.34,0,0,0-2.33-.47,5.42,5.42,0,0,0-2.57.56,4.53,4.53,0,0,0-1.78,1.9,3.78,3.78,0,0,0-1.68-1.87,5.46,5.46,0,0,0-2.56-.59,4.87,4.87,0,0,0-1.42.2,5.18,5.18,0,0,0-1.16.51,3.71,3.71,0,0,0-.87.71,3.18,3.18,0,0,0-.57.79h-.06V24.14h-4.07V37.86h4.24V31a9.36,9.36,0,0,1,.09-1.3,3.4,3.4,0,0,1,.35-1.12,2,2,0,0,1,.78-.79,2.67,2.67,0,0,1,1.33-.29,1.67,1.67,0,0,1,1.12.33,2.05,2.05,0,0,1,.55.82,3.92,3.92,0,0,1,.2,1c0,.36,0,.66,0,.9v7.26h4.25V30.6a5.28,5.28,0,0,1,.12-1.19,2.77,2.77,0,0,1,.43-1,2,2,0,0,1,.79-.67,2.75,2.75,0,0,1,1.23-.23,1.56,1.56,0,0,1,1.46.68,3.32,3.32,0,0,1,.41,1.66v8h4.23v-8.1a10.65,10.65,0,0,0-.23-2.33A5.37,5.37,0,0,0,182.91,25.54Z"/><path d="M126.69,23.79a4.07,4.07,0,0,0-2.35.64,5.21,5.21,0,0,0-1.62,1.9h0v-2.2h-4.24V37.86h4.24V32.12a12.9,12.9,0,0,1,.11-1.86,3.58,3.58,0,0,1,.5-1.45,2.48,2.48,0,0,1,1.08-.95,4.55,4.55,0,0,1,1.93-.34,5.62,5.62,0,0,1,.92.07,6.77,6.77,0,0,1,.89.21V23.94a3.87,3.87,0,0,0-.68-.12Z"/><path d="M32.75,20.12H31v13h1.3a5.05,5.05,0,0,0,4.17-1.65,8,8,0,0,0,1.33-5.05,7.34,7.34,0,0,0-1.26-4.72A4.66,4.66,0,0,0,32.75,20.12Z"/><path d="M51.89,0H1.5A1.5,1.5,0,0,0,0,1.5V51.77a1.51,1.51,0,0,0,1.51,1.51H51.88a1.52,1.52,0,0,0,1.51-1.51V1.5A1.5,1.5,0,0,0,51.89,0ZM15.36,38.2H9.15V27.55h6.21Zm7.81,0H17v-17h6.21Zm18-3.14q-3.18,3.13-9,3.14H24.82V15.07h7.87q5.56,0,8.6,2.85t3,8.23C44.32,30,43.26,33,41.13,35.06Z"/></g></svg>
      </div>
    </div>
    <div class="chart-card" id="chartFounders">
      <div class="chart-card-header">
        <div class="chart-title">Serial vs First-time Founders</div>
        <button class="share-btn" onclick="shareChart('chartFounders')" title="Download as image"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg></button>
      </div>
      <div class="donut-chart" id="donutFounders"></div>
      <div class="chart-watermark">
        <img src="" class="wm-4yfn-logo" style="height:14px;" />
        <span class="wm-divider"></span>
        <span>Powered by</span>
        <svg class="wm-dr-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 222.15 53.28" aria-label="Dealroom"><g fill="#666"><path d="M201.48,27.53a2.47,2.47,0,0,1,1.22.29,2.25,2.25,0,0,1,.87.75l2.8-2.94A5.37,5.37,0,0,0,204,24.2a8.89,8.89,0,0,0-2.56-.4,8.6,8.6,0,0,0-3,.5,7.15,7.15,0,0,0-2.44,1.46A6.79,6.79,0,0,0,194.44,28a7.63,7.63,0,0,0,0,5.93,6.89,6.89,0,0,0,1.62,2.27,7.31,7.31,0,0,0,2.44,1.46,8.6,8.6,0,0,0,3,.5,8.26,8.26,0,0,0,2.56-.41,5.35,5.35,0,0,0,2.33-1.42l-2.8-2.94a3.63,3.63,0,0,1-.87.74,2.26,2.26,0,0,1-1.22.3,3.22,3.22,0,0,1-2.5-1,3.53,3.53,0,0,1-.89-2.51,3.52,3.52,0,0,1,.89-2.5A3.22,3.22,0,0,1,201.48,27.53Z"/><path d="M158.18,25.76a7.15,7.15,0,0,0-2.44-1.46,8.6,8.6,0,0,0-3-.5,8.69,8.69,0,0,0-3,.5,7.17,7.17,0,0,0-2.43,1.46A6.68,6.68,0,0,0,145.71,28a7.63,7.63,0,0,0,0,5.93,6.78,6.78,0,0,0,1.63,2.27,7.17,7.17,0,0,0,2.43,1.46h0a8.69,8.69,0,0,0,3,.5,8.6,8.6,0,0,0,3-.5,7.31,7.31,0,0,0,2.44-1.46A6.92,6.92,0,0,0,159.81,34a7.63,7.63,0,0,0,0-5.93A6.82,6.82,0,0,0,158.18,25.76Zm-2.91,7.75a3.76,3.76,0,0,1-5,0,3.56,3.56,0,0,1-.89-2.51,3.53,3.53,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0,3.53,3.53,0,0,1,.89,2.51A3.56,3.56,0,0,1,155.27,33.51Z"/><path d="M141.46,25.76A7.31,7.31,0,0,0,139,24.3a9.16,9.16,0,0,0-6,0,7.17,7.17,0,0,0-2.43,1.46A6.68,6.68,0,0,0,129,28,7.75,7.75,0,0,0,129,34a6.78,6.78,0,0,0,1.63,2.27,7.17,7.17,0,0,0,2.43,1.46h0a9.16,9.16,0,0,0,6,0,7.31,7.31,0,0,0,2.44-1.46A7.07,7.07,0,0,0,143.09,34a7.75,7.75,0,0,0,0-5.93A7,7,0,0,0,141.46,25.76Zm-2.91,7.75a3.76,3.76,0,0,1-5,0,3.56,3.56,0,0,1-.89-2.51,3.48,3.48,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0,3.53,3.53,0,0,1,.89,2.51A3.56,3.56,0,0,1,138.55,33.51Z"/><path d="M74.14,25.61h0a4,4,0,0,0-1.88-1.41,7.49,7.49,0,0,0-2.48-.4,5.58,5.58,0,0,0-2.63.6,6.19,6.19,0,0,0-2,1.63,7.32,7.32,0,0,0-1.24,2.32,8.9,8.9,0,0,0-.44,2.76A8.17,8.17,0,0,0,63.93,34,6.63,6.63,0,0,0,65.3,36.2a6.07,6.07,0,0,0,2.14,1.47h0a7.11,7.11,0,0,0,2.77.53,5,5,0,0,0,1.38-.2,6.46,6.46,0,0,0,1.21-.51,5.56,5.56,0,0,0,1-.7,4.66,4.66,0,0,0,.66-.74h0v1.81h3.9V16.51H74.14Zm-.56,7.89a3.74,3.74,0,0,1-5,0A3.53,3.53,0,0,1,67.69,31a3.56,3.56,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0A3.56,3.56,0,0,1,74.47,31,3.53,3.53,0,0,1,73.58,33.5Z"/><path d="M221.55,28a6.82,6.82,0,0,0-1.63-2.27,7.31,7.31,0,0,0-2.44-1.46,8.6,8.6,0,0,0-3-.5,8.69,8.69,0,0,0-3,.5,7.17,7.17,0,0,0-2.43,1.46A6.68,6.68,0,0,0,207.45,28a7.75,7.75,0,0,0,0,5.93,6.78,6.78,0,0,0,1.63,2.27,7.17,7.17,0,0,0,2.43,1.46,8.69,8.69,0,0,0,3,.5,8.6,8.6,0,0,0,3-.5,7.31,7.31,0,0,0,2.44-1.46A6.92,6.92,0,0,0,221.55,34a7.63,7.63,0,0,0,0-5.93ZM217,33.51a3.76,3.76,0,0,1-5,0A3.56,3.56,0,0,1,211.1,31a3.53,3.53,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0A3.54,3.54,0,0,1,217.9,31,3.56,3.56,0,0,1,217,33.51Z"/><path d="M93.17,25.76a5.56,5.56,0,0,0-2-1.45,6.66,6.66,0,0,0-2.68-.51,8.46,8.46,0,0,0-3,.51A7,7,0,0,0,83,25.76,6.78,6.78,0,0,0,81.41,28a7.75,7.75,0,0,0,0,5.93A6.78,6.78,0,0,0,83,36.23a7,7,0,0,0,2.43,1.46h0a8.58,8.58,0,0,0,3,.5,7.71,7.71,0,0,0,3.23-.71,6.7,6.7,0,0,0,2.57-2l-3-2.17A4.8,4.8,0,0,1,90,34.51a3.05,3.05,0,0,1-1.77.46,3.12,3.12,0,0,1-2.09-.71,3.32,3.32,0,0,1-1.1-1.94h9.85V31a9.08,9.08,0,0,0-.46-3A6.63,6.63,0,0,0,93.17,25.76Zm-8.11,3.68a2.66,2.66,0,0,1,.24-1,2.42,2.42,0,0,1,.6-.82,3,3,0,0,1,.91-.58h0a3.24,3.24,0,0,1,1.23-.23,2.51,2.51,0,0,1,1.9.77,2.45,2.45,0,0,1,.71,1.83Z"/><path d="M108.19,25.64a4.47,4.47,0,0,0-1.92-1.37,8.68,8.68,0,0,0-3.07-.47,9.87,9.87,0,0,0-3.28.56A7.65,7.65,0,0,0,97.15,26l2.26,2.31a5.29,5.29,0,0,1,1.54-1.2,4.35,4.35,0,0,1,1.91-.44,2.91,2.91,0,0,1,1.91.67,2.23,2.23,0,0,1,.81,1.79l-1.91,0a20.62,20.62,0,0,0-2.07.17,13.6,13.6,0,0,0-2,.44,6,6,0,0,0-1.71.84A3.87,3.87,0,0,0,96.71,32a4.21,4.21,0,0,0-.44,2,4.15,4.15,0,0,0,.4,1.84,3.83,3.83,0,0,0,1.08,1.32,4.41,4.41,0,0,0,1.57.8h0a6.09,6.09,0,0,0,1.84.28,6.37,6.37,0,0,0,2.48-.48,4,4,0,0,0,1.88-1.58h.06v1.72h3.9v-7a14.61,14.61,0,0,0-.29-3A5.21,5.21,0,0,0,108.19,25.64Zm-2.61,7.1a2.23,2.23,0,0,1-1,1.92,3.45,3.45,0,0,1-1,.48,4.1,4.1,0,0,1-1.2.17A2.69,2.69,0,0,1,101,35a1.21,1.21,0,0,1-.65-1.13,1.35,1.35,0,0,1,.47-1.1,3,3,0,0,1,1.13-.6,6.43,6.43,0,0,1,1.38-.24h0c.49,0,.89,0,1.2,0h1Z"/><path d="M191,33.58a2.6,2.6,0,0,0-.84-.55,2.73,2.73,0,0,0-1-.2,2.76,2.76,0,0,0-1,.2,2.5,2.5,0,0,0-1.38,1.38,2.54,2.54,0,0,0-.2,1,2.58,2.58,0,0,0,.2,1,2.41,2.41,0,0,0,.55.83,2.56,2.56,0,0,0,.83.55h0a2.67,2.67,0,0,0,1,.2,2.73,2.73,0,0,0,1-.2,2.6,2.6,0,0,0,.84-.55,2.73,2.73,0,0,0,.55-.83,2.76,2.76,0,0,0,.2-1,2.62,2.62,0,0,0-.75-1.85Z"/><rect x="111.67" y="16.51" width="4.24" height="21.35"/><path d="M182.91,25.54a3.7,3.7,0,0,0-1.5-1.27,5.34,5.34,0,0,0-2.33-.47,5.42,5.42,0,0,0-2.57.56,4.53,4.53,0,0,0-1.78,1.9,3.78,3.78,0,0,0-1.68-1.87,5.46,5.46,0,0,0-2.56-.59,4.87,4.87,0,0,0-1.42.2,5.18,5.18,0,0,0-1.16.51,3.71,3.71,0,0,0-.87.71,3.18,3.18,0,0,0-.57.79h-.06V24.14h-4.07V37.86h4.24V31a9.36,9.36,0,0,1,.09-1.3,3.4,3.4,0,0,1,.35-1.12,2,2,0,0,1,.78-.79,2.67,2.67,0,0,1,1.33-.29,1.67,1.67,0,0,1,1.12.33,2.05,2.05,0,0,1,.55.82,3.92,3.92,0,0,1,.2,1c0,.36,0,.66,0,.9v7.26h4.25V30.6a5.28,5.28,0,0,1,.12-1.19,2.77,2.77,0,0,1,.43-1,2,2,0,0,1,.79-.67,2.75,2.75,0,0,1,1.23-.23,1.56,1.56,0,0,1,1.46.68,3.32,3.32,0,0,1,.41,1.66v8h4.23v-8.1a10.65,10.65,0,0,0-.23-2.33A5.37,5.37,0,0,0,182.91,25.54Z"/><path d="M126.69,23.79a4.07,4.07,0,0,0-2.35.64,5.21,5.21,0,0,0-1.62,1.9h0v-2.2h-4.24V37.86h4.24V32.12a12.9,12.9,0,0,1,.11-1.86,3.58,3.58,0,0,1,.5-1.45,2.48,2.48,0,0,1,1.08-.95,4.55,4.55,0,0,1,1.93-.34,5.62,5.62,0,0,1,.92.07,6.77,6.77,0,0,1,.89.21V23.94a3.87,3.87,0,0,0-.68-.12Z"/><path d="M32.75,20.12H31v13h1.3a5.05,5.05,0,0,0,4.17-1.65,8,8,0,0,0,1.33-5.05,7.34,7.34,0,0,0-1.26-4.72A4.66,4.66,0,0,0,32.75,20.12Z"/><path d="M51.89,0H1.5A1.5,1.5,0,0,0,0,1.5V51.77a1.51,1.51,0,0,0,1.51,1.51H51.88a1.52,1.52,0,0,0,1.51-1.51V1.5A1.5,1.5,0,0,0,51.89,0ZM15.36,38.2H9.15V27.55h6.21Zm7.81,0H17v-17h6.21Zm18-3.14q-3.18,3.13-9,3.14H24.82V15.07h7.87q5.56,0,8.6,2.85t3,8.23C44.32,30,43.26,33,41.13,35.06Z"/></g></svg>
      </div>
    </div>
    <div class="chart-card" id="chartTeamSize">
      <div class="chart-card-header">
        <div class="chart-title">Team Size Distribution</div>
        <button class="share-btn" onclick="shareChart('chartTeamSize')" title="Download as image"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg></button>
      </div>
      <div class="col-chart" id="barTeamSize"></div>
      <div class="chart-watermark">
        <img src="" class="wm-4yfn-logo" style="height:14px;" />
        <span class="wm-divider"></span>
        <span>Powered by</span>
        <svg class="wm-dr-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 222.15 53.28" aria-label="Dealroom"><g fill="#666"><path d="M201.48,27.53a2.47,2.47,0,0,1,1.22.29,2.25,2.25,0,0,1,.87.75l2.8-2.94A5.37,5.37,0,0,0,204,24.2a8.89,8.89,0,0,0-2.56-.4,8.6,8.6,0,0,0-3,.5,7.15,7.15,0,0,0-2.44,1.46A6.79,6.79,0,0,0,194.44,28a7.63,7.63,0,0,0,0,5.93,6.89,6.89,0,0,0,1.62,2.27,7.31,7.31,0,0,0,2.44,1.46,8.6,8.6,0,0,0,3,.5,8.26,8.26,0,0,0,2.56-.41,5.35,5.35,0,0,0,2.33-1.42l-2.8-2.94a3.63,3.63,0,0,1-.87.74,2.26,2.26,0,0,1-1.22.3,3.22,3.22,0,0,1-2.5-1,3.53,3.53,0,0,1-.89-2.51,3.52,3.52,0,0,1,.89-2.5A3.22,3.22,0,0,1,201.48,27.53Z"/><path d="M158.18,25.76a7.15,7.15,0,0,0-2.44-1.46,8.6,8.6,0,0,0-3-.5,8.69,8.69,0,0,0-3,.5,7.17,7.17,0,0,0-2.43,1.46A6.68,6.68,0,0,0,145.71,28a7.63,7.63,0,0,0,0,5.93,6.78,6.78,0,0,0,1.63,2.27,7.17,7.17,0,0,0,2.43,1.46h0a8.69,8.69,0,0,0,3,.5,8.6,8.6,0,0,0,3-.5,7.31,7.31,0,0,0,2.44-1.46A6.92,6.92,0,0,0,159.81,34a7.63,7.63,0,0,0,0-5.93A6.82,6.82,0,0,0,158.18,25.76Zm-2.91,7.75a3.76,3.76,0,0,1-5,0,3.56,3.56,0,0,1-.89-2.51,3.53,3.53,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0,3.53,3.53,0,0,1,.89,2.51A3.56,3.56,0,0,1,155.27,33.51Z"/><path d="M141.46,25.76A7.31,7.31,0,0,0,139,24.3a9.16,9.16,0,0,0-6,0,7.17,7.17,0,0,0-2.43,1.46A6.68,6.68,0,0,0,129,28,7.75,7.75,0,0,0,129,34a6.78,6.78,0,0,0,1.63,2.27,7.17,7.17,0,0,0,2.43,1.46h0a9.16,9.16,0,0,0,6,0,7.31,7.31,0,0,0,2.44-1.46A7.07,7.07,0,0,0,143.09,34a7.75,7.75,0,0,0,0-5.93A7,7,0,0,0,141.46,25.76Zm-2.91,7.75a3.76,3.76,0,0,1-5,0,3.56,3.56,0,0,1-.89-2.51,3.48,3.48,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0,3.53,3.53,0,0,1,.89,2.51A3.56,3.56,0,0,1,138.55,33.51Z"/><path d="M74.14,25.61h0a4,4,0,0,0-1.88-1.41,7.49,7.49,0,0,0-2.48-.4,5.58,5.58,0,0,0-2.63.6,6.19,6.19,0,0,0-2,1.63,7.32,7.32,0,0,0-1.24,2.32,8.9,8.9,0,0,0-.44,2.76A8.17,8.17,0,0,0,63.93,34,6.63,6.63,0,0,0,65.3,36.2a6.07,6.07,0,0,0,2.14,1.47h0a7.11,7.11,0,0,0,2.77.53,5,5,0,0,0,1.38-.2,6.46,6.46,0,0,0,1.21-.51,5.56,5.56,0,0,0,1-.7,4.66,4.66,0,0,0,.66-.74h0v1.81h3.9V16.51H74.14Zm-.56,7.89a3.74,3.74,0,0,1-5,0A3.53,3.53,0,0,1,67.69,31a3.56,3.56,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0A3.56,3.56,0,0,1,74.47,31,3.53,3.53,0,0,1,73.58,33.5Z"/><path d="M221.55,28a6.82,6.82,0,0,0-1.63-2.27,7.31,7.31,0,0,0-2.44-1.46,8.6,8.6,0,0,0-3-.5,8.69,8.69,0,0,0-3,.5,7.17,7.17,0,0,0-2.43,1.46A6.68,6.68,0,0,0,207.45,28a7.75,7.75,0,0,0,0,5.93,6.78,6.78,0,0,0,1.63,2.27,7.17,7.17,0,0,0,2.43,1.46,8.69,8.69,0,0,0,3,.5,8.6,8.6,0,0,0,3-.5,7.31,7.31,0,0,0,2.44-1.46A6.92,6.92,0,0,0,221.55,34a7.63,7.63,0,0,0,0-5.93ZM217,33.51a3.76,3.76,0,0,1-5,0A3.56,3.56,0,0,1,211.1,31a3.53,3.53,0,0,1,.89-2.51h0a3.76,3.76,0,0,1,5,0A3.54,3.54,0,0,1,217.9,31,3.56,3.56,0,0,1,217,33.51Z"/><path d="M93.17,25.76a5.56,5.56,0,0,0-2-1.45,6.66,6.66,0,0,0-2.68-.51,8.46,8.46,0,0,0-3,.51A7,7,0,0,0,83,25.76,6.78,6.78,0,0,0,81.41,28a7.75,7.75,0,0,0,0,5.93A6.78,6.78,0,0,0,83,36.23a7,7,0,0,0,2.43,1.46h0a8.58,8.58,0,0,0,3,.5,7.71,7.71,0,0,0,3.23-.71,6.7,6.7,0,0,0,2.57-2l-3-2.17A4.8,4.8,0,0,1,90,34.51a3.05,3.05,0,0,1-1.77.46,3.12,3.12,0,0,1-2.09-.71,3.32,3.32,0,0,1-1.1-1.94h9.85V31a9.08,9.08,0,0,0-.46-3A6.63,6.63,0,0,0,93.17,25.76Zm-8.11,3.68a2.66,2.66,0,0,1,.24-1,2.42,2.42,0,0,1,.6-.82,3,3,0,0,1,.91-.58h0a3.24,3.24,0,0,1,1.23-.23,2.51,2.51,0,0,1,1.9.77,2.45,2.45,0,0,1,.71,1.83Z"/><path d="M108.19,25.64a4.47,4.47,0,0,0-1.92-1.37,8.68,8.68,0,0,0-3.07-.47,9.87,9.87,0,0,0-3.28.56A7.65,7.65,0,0,0,97.15,26l2.26,2.31a5.29,5.29,0,0,1,1.54-1.2,4.35,4.35,0,0,1,1.91-.44,2.91,2.91,0,0,1,1.91.67,2.23,2.23,0,0,1,.81,1.79l-1.91,0a20.62,20.62,0,0,0-2.07.17,13.6,13.6,0,0,0-2,.44,6,6,0,0,0-1.71.84A3.87,3.87,0,0,0,96.71,32a4.21,4.21,0,0,0-.44,2,4.15,4.15,0,0,0,.4,1.84,3.83,3.83,0,0,0,1.08,1.32,4.41,4.41,0,0,0,1.57.8h0a6.09,6.09,0,0,0,1.84.28,6.37,6.37,0,0,0,2.48-.48,4,4,0,0,0,1.88-1.58h.06v1.72h3.9v-7a14.61,14.61,0,0,0-.29-3A5.21,5.21,0,0,0,108.19,25.64Zm-2.61,7.1a2.23,2.23,0,0,1-1,1.92,3.45,3.45,0,0,1-1,.48,4.1,4.1,0,0,1-1.2.17A2.69,2.69,0,0,1,101,35a1.21,1.21,0,0,1-.65-1.13,1.35,1.35,0,0,1,.47-1.1,3,3,0,0,1,1.13-.6,6.43,6.43,0,0,1,1.38-.24h0c.49,0,.89,0,1.2,0h1Z"/><path d="M191,33.58a2.6,2.6,0,0,0-.84-.55,2.73,2.73,0,0,0-1-.2,2.76,2.76,0,0,0-1,.2,2.5,2.5,0,0,0-1.38,1.38,2.54,2.54,0,0,0-.2,1,2.58,2.58,0,0,0,.2,1,2.41,2.41,0,0,0,.55.83,2.56,2.56,0,0,0,.83.55h0a2.67,2.67,0,0,0,1,.2,2.73,2.73,0,0,0,1-.2,2.6,2.6,0,0,0,.84-.55,2.73,2.73,0,0,0,.55-.83,2.76,2.76,0,0,0,.2-1,2.62,2.62,0,0,0-.75-1.85Z"/><rect x="111.67" y="16.51" width="4.24" height="21.35"/><path d="M182.91,25.54a3.7,3.7,0,0,0-1.5-1.27,5.34,5.34,0,0,0-2.33-.47,5.42,5.42,0,0,0-2.57.56,4.53,4.53,0,0,0-1.78,1.9,3.78,3.78,0,0,0-1.68-1.87,5.46,5.46,0,0,0-2.56-.59,4.87,4.87,0,0,0-1.42.2,5.18,5.18,0,0,0-1.16.51,3.71,3.71,0,0,0-.87.71,3.18,3.18,0,0,0-.57.79h-.06V24.14h-4.07V37.86h4.24V31a9.36,9.36,0,0,1,.09-1.3,3.4,3.4,0,0,1,.35-1.12,2,2,0,0,1,.78-.79,2.67,2.67,0,0,1,1.33-.29,1.67,1.67,0,0,1,1.12.33,2.05,2.05,0,0,1,.55.82,3.92,3.92,0,0,1,.2,1c0,.36,0,.66,0,.9v7.26h4.25V30.6a5.28,5.28,0,0,1,.12-1.19,2.77,2.77,0,0,1,.43-1,2,2,0,0,1,.79-.67,2.75,2.75,0,0,1,1.23-.23,1.56,1.56,0,0,1,1.46.68,3.32,3.32,0,0,1,.41,1.66v8h4.23v-8.1a10.65,10.65,0,0,0-.23-2.33A5.37,5.37,0,0,0,182.91,25.54Z"/><path d="M126.69,23.79a4.07,4.07,0,0,0-2.35.64,5.21,5.21,0,0,0-1.62,1.9h0v-2.2h-4.24V37.86h4.24V32.12a12.9,12.9,0,0,1,.11-1.86,3.58,3.58,0,0,1,.5-1.45,2.48,2.48,0,0,1,1.08-.95,4.55,4.55,0,0,1,1.93-.34,5.62,5.62,0,0,1,.92.07,6.77,6.77,0,0,1,.89.21V23.94a3.87,3.87,0,0,0-.68-.12Z"/><path d="M32.75,20.12H31v13h1.3a5.05,5.05,0,0,0,4.17-1.65,8,8,0,0,0,1.33-5.05,7.34,7.34,0,0,0-1.26-4.72A4.66,4.66,0,0,0,32.75,20.12Z"/><path d="M51.89,0H1.5A1.5,1.5,0,0,0,0,1.5V51.77a1.51,1.51,0,0,0,1.51,1.51H51.88a1.52,1.52,0,0,0,1.51-1.51V1.5A1.5,1.5,0,0,0,51.89,0ZM15.36,38.2H9.15V27.55h6.21Zm7.81,0H17v-17h6.21Zm18-3.14q-3.18,3.13-9,3.14H24.82V15.07h7.87q5.56,0,8.6,2.85t3,8.23C44.32,30,43.26,33,41.13,35.06Z"/></g></svg>
      </div>
    </div>
    <div class="chart-card chart-card-leaderboard" id="leaderboard">
      <div class="chart-card-header">
        <div class="chart-title">
          <svg viewBox="0 0 24 24" fill="none" stroke="var(--orange)" stroke-width="2" width="18" height="18" style="vertical-align:middle;margin-right:0.4rem;"><path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/></svg>
          Most Saved Startups
        </div>
      </div>
      <div id="leaderboardList" class="leaderboard-list">
        <div class="leaderboard-empty">Loading leaderboard...</div>
      </div>
    </div>
  </div>
</section>

<!-- Main Content -->
<div class="main" id="startups">
  <h2 class="section-heading" style="scroll-margin-top:60px;">
    <span class="accent-bar"></span>
    Startup Explorer
  </h2>

  <div class="filters-section">
    <div class="filters-header">
      <div class="search-box">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
        <input type="text" id="searchInput" placeholder="Search startups by name, tagline, or city..." />
      </div>
      <select class="sort-select" id="sortSelect">
        <option value="signal-desc">Dealroom Signal: High &rarr; Low</option>
        <option value="name">Sort: A-Z</option>
        <option value="name-desc">Sort: Z-A</option>
        <option value="funding-desc">Funding: High &rarr; Low</option>
        <option value="funding-asc">Funding: Low &rarr; High</option>
        <option value="employees-desc">Team: Large &rarr; Small</option>
        <option value="newest">Newest first</option>
      </select>
      <div class="result-count">Showing <span id="resultCount">0</span> startups</div>
    </div>
    <div class="filter-rows">
      <div class="filter-row">
        <span class="filter-label">Theme</span>
        <div class="filter-chips" id="industryFilters"></div>
      </div>
      <div class="filter-row">
        <span class="filter-label">Stage</span>
        <div class="filter-chips" id="stageFilters"></div>
        <button class="clear-filters" id="clearFilters" style="display:none;">Clear all</button>
        <div class="grid-view-pills" id="gridViewPills">
          <button class="active" onclick="setGridView('all')">All</button>
          <button id="gridViewSaved" style="display:none" onclick="setGridView('saved')">Saved</button>
          <button id="gridViewSkipped" style="display:none" onclick="setGridView('hide-skipped')">Hide skipped</button>
        </div>
      </div>
    </div>
  </div>

  <div id="grid" class="grid">
    <div class="loading">
      <div class="spinner"></div>
      <div class="loading-text">Loading startup data...</div>
    </div>
  </div>
  <div class="pagination" id="pagination"></div>

  <!-- Founders -->
  <div class="founders-section" id="founders" style="scroll-margin-top:60px;">
    <h2 class="section-heading">
      <span class="accent-bar"></span>
      Founder Directory
    </h2>
    <div class="founders-search">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
      <input type="text" id="founderSearch" placeholder="Search founders by name, company, or university..." />
    </div>
    <div class="filter-row" style="margin-bottom:0.3rem;">
      <span class="filter-label">THEME</span>
      <div class="filter-chips" id="founderThemeFilters"></div>
    </div>
    <div class="filter-row" style="margin-bottom:0.75rem;">
      <span class="filter-label">STAGE</span>
      <div class="filter-chips" id="founderStageFilters"></div>
    </div>
    <div class="founders-count">Showing <span id="founderCount">0</span> founders</div>
    <div class="founders-grid" id="foundersGrid"></div>
    <div class="founders-pagination" id="foundersPagination"></div>
  </div>

  <!-- Interactive Map -->
  <div class="map-section" id="floorplan" style="scroll-margin-top:60px;">
    <h2 class="section-heading">
      <span class="accent-bar"></span>
      Interactive Venue Map
    </h2>
    <div class="map-layout">
      <div class="map-sidebar">
        <div class="map-sidebar-header">
          <h3>Find a Booth</h3>
          <div class="map-search-wrap">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
            <input type="text" id="mapSearch" placeholder="Search companies..." />
          </div>
        </div>
        <div class="map-hall-tabs">
          <button class="map-hall-tab active" data-hall="all">All</button>
          <button class="map-hall-tab" data-hall="8.1">Hall 8.1</button>
          <button class="map-hall-tab" data-hall="8.0">Hall 8.0</button>
        </div>
        <div class="map-booth-list" id="mapBoothList"></div>
        <div class="map-booth-count" id="mapBoothCount">Loading...</div>
      </div>
      <div class="map-viewer" id="mapViewer">
        <img id="mapImage" src="https://event-assets.gsma.com/4YFN/Images/4YFN26_Floorplan.webp" alt="4YFN 2026 Floorplan" style="position:absolute;transform-origin:0 0;user-select:none;-webkit-user-drag:none;max-width:none;" />
        <div id="mapPopup"></div>
        <div class="map-controls">
          <button class="fp-btn" onclick="mapZoom(1.3)" title="Zoom in">+</button>
          <button class="fp-btn" onclick="mapZoom(0.77)" title="Zoom out">&minus;</button>
          <button class="fp-btn" onclick="mapReset()" title="Reset view" style="font-size:0.75rem;">&#8634;</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Add Startup Modal -->
<div class="modal-overlay" id="addModal">
  <div class="modal">
    <button class="modal-close" onclick="closeModal()">&times;</button>
    <div id="modalForm">
      <h3>Add Your Startup</h3>
      <p>Attending 4YFN as a visitor? Add your company so other attendees can discover you.</p>
      <div class="modal-input-group">
        <label>Company URL</label>
        <input type="url" id="startupUrl" placeholder="https://yourcompany.com" required />
      </div>
      <div class="modal-input-group">
        <label>Anything else? (optional)</label>
        <textarea id="startupNote" placeholder="e.g. booth number, what you're looking for..."></textarea>
      </div>
      <button class="modal-submit" id="submitBtn" onclick="submitStartup()">Submit</button>
    </div>
    <div id="modalSuccess" style="display:none;" class="modal-success">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
      <h4>Thanks!</h4>
      <p>We've received your submission. Our team will review it shortly.</p>
    </div>
  </div>
</div>

<!-- Share toast -->
<div class="share-toast" id="shareToast">Image downloaded!</div>

<!-- Company Detail Modal -->
<div class="detail-overlay" id="detailOverlay" onclick="if(event.target===this)closeDetailModal()">
  <div class="detail-modal">
    <button class="detail-modal-close" onclick="closeDetailModal()">&times;</button>
    <div class="detail-modal-body" id="detailModalBody"></div>
  </div>
</div>

<!-- Swipe Mode FAB -->
<button class="swipe-fab" onclick="openSwipeMode()" title="Swipe through startups">
  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M9 3h6l3 3-3 3H9"/><path d="M15 21H9l-3-3 3-3h6"/></svg>
</button>

<!-- Swipe Mode Overlay -->
<div class="swipe-overlay" id="swipeOverlay">
  <div class="swipe-header">
    <div>
      <div class="swipe-header-title">Startup Explorer</div>
      <div class="swipe-counter" id="swipeCounter">0 / 0</div>
    </div>
    <div class="swipe-saved-count" id="swipeSavedCount">0 saved</div>
    <button class="swipe-close" onclick="closeSwipeMode()">&times;</button>
  </div>
  <!-- Filter screen -->
  <div class="swipe-filter" id="swipeFilter" style="display:none;">
    <h3>What are you looking for?</h3>
    <p>Pick themes & stages to see the most relevant startups</p>
    <div class="swipe-filter-group">
      <label>Theme</label>
      <div class="swipe-filter-chips" id="swipeFilterThemes"></div>
    </div>
    <div class="swipe-filter-group">
      <label>Funding Stage</label>
      <div class="swipe-filter-chips" id="swipeFilterStages"></div>
    </div>
    <div class="swipe-filter-count" id="swipeFilterCount"></div>
    <button class="swipe-filter-go" onclick="startSwipeSwiping()">Start exploring</button>
  </div>
  <!-- Card stack -->
  <div class="swipe-stack" id="swipeStack"></div>
  <div class="swipe-actions" id="swipeActions">
    <button class="swipe-btn btn-skip" onclick="swipeAction('left')" title="Skip"><svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
    <button class="swipe-btn btn-info" onclick="swipeShowLinks()" title="View on Dealroom"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg></button>
    <button class="swipe-btn btn-save" onclick="swipeAction('right')" title="Save to favourites"><svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="1"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg></button>
  </div>
</div>

<!-- Footer -->
<footer class="footer">
  Data powered by <a href="https://dealroom.co" target="_blank" rel="noopener">Dealroom</a> &middot;
  <a href="https://www.4yfn.com/" target="_blank" rel="noopener">4yfn.com</a> &middot;
  3 &ndash; 6 March 2026, Barcelona
</footer>

<button class="scroll-top" id="scrollTop" aria-label="Scroll to top">
  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="m18 15-6-6-6 6"/></svg>
</button>

<script>
const SHEET_ID = '1kNGDPIvgT14IyYNnMlIBP8ZvnQJeM_6vJccPMGZd9P8';
const PER_PAGE = 24;

// ── Anonymous Session ID (per tab, no PII) ──
const SESSION_ID = sessionStorage.getItem('4yfn_session') || (() => {
  const id = 'sess_' + Math.random().toString(36).substring(2, 10) + Date.now().toString(36);
  sessionStorage.setItem('4yfn_session', id);
  return id;
})();

// ── Visitor IP & Location (for tracking) ──
let visitorInfo = { ip: '', city: '', country: '' };
fetch('https://ipapi.co/json/')
  .then(r => r.json())
  .then(data => { visitorInfo = { ip: data.ip || '', city: data.city || '', country: data.country_name || '' }; })
  .catch(() => {});

// ── Save Tracking (Google Sheets backend, swappable) ──
const TRACKER_ENDPOINT = 'https://script.google.com/macros/s/AKfycbynlhIM_7Zg42PhgXmzgsZ4Wc09P3cq2KijRgmHYSX3jWzgBrQwZLvlZyZpqjYPAsRW/exec';

const SwipeTracker = {
  _endpoint: TRACKER_ENDPOINT,
  _enabled: TRACKER_ENDPOINT !== 'PASTE_YOUR_APPS_SCRIPT_URL_HERE',
  _sent: new Set(),  // dedupe: max 1 track per company per session

  trackSave(companyName, source) {
    if (!this._enabled) return;
    if (this._sent.has(companyName)) return;  // already tracked this company in this session
    this._sent.add(companyName);

    // Look up Dealroom ID from column A ("ID") in the spreadsheet
    let dealroomId = '';
    const match = (typeof allData !== 'undefined') && allData.find(d => d['Name'] === companyName);
    if (match && match['ID']) {
      dealroomId = match['ID'];
    }

    const payload = {
      company: companyName,
      timestamp: new Date().toISOString(),
      sessionId: SESSION_ID,
      source: source,  // 'swipe', 'grid', or 'map'
      dealroomId: dealroomId,
      ip: visitorInfo.ip,
      city: visitorInfo.city,
      country: visitorInfo.country
    };
    if (navigator.sendBeacon) {
      navigator.sendBeacon(this._endpoint, JSON.stringify(payload));
    } else {
      fetch(this._endpoint, {
        method: 'POST',
        body: JSON.stringify(payload),
        keepalive: true
      }).catch(() => {});
    }
  },

  fetchLeaderboard() {
    if (!this._enabled) return Promise.resolve([]);
    return fetch(`${this._endpoint}?action=leaderboard`, { redirect: 'follow' })
      .then(r => {
        if (!r.ok) throw new Error(r.status);
        return r.json();
      })
      .then(data => data.leaderboard || [])
      .catch(() => []);
  },

  setEndpoint(url) {
    this._endpoint = url;
    this._enabled = true;
  }
};

let allData = [];
let filtered = [];
let currentPage = 1;
let activeIndustries = [];
let activeStages = [];
let swipeSkipped = JSON.parse(localStorage.getItem('4yfn_skipped') || '[]');
let gridViewMode = 'all'; // 'all' | 'saved' | 'hide-skipped'

// ── Stage Groups ──
const STAGE_GROUPS = {
  'Pre-Seed / Angel': ['ANGEL', 'SUPPORT PROGRAM', 'GRANT'],
  'Seed': ['SEED'],
  'Early (Series A)': ['SERIES A', 'EARLY VC'],
  'Growth (B-C)': ['SERIES B', 'SERIES C'],
  'Late / Other': ['LATE VC', 'GROWTH EQUITY VC', 'GROWTH EQUITY NON VC', 'IPO', 'POST IPO EQUITY', 'POST IPO CONVERTIBLE', 'PRIVATE PLACEMENT VC', 'DEBT', 'SECONDARY', 'ACQUISITION', 'BUYOUT', 'SPINOUT']
};

function getStageGroup(round) {
  if (!round || round === 'N/A') return 'Pre-Seed / Angel';
  for (const [group, stages] of Object.entries(STAGE_GROUPS)) {
    if (stages.includes(round)) return group;
  }
  return 'Pre-Seed / Angel';
}

function getRoundClass(round) {
  if (!round) return 'round-other';
  const r = round.toUpperCase();
  // Keep specific series rounds as-is
  if (r === 'EARLY VC') return 'round-early';
  if (r.startsWith('SERIES')) return r === 'SERIES A' ? 'round-series-a' : r === 'SERIES B' ? 'round-series-b' : r === 'SERIES C' ? 'round-series-c' : 'round-late';
  // Pre-Seed / Angel group (includes spinouts as early-stage)
  const preSeed = ['ANGEL', 'SUPPORT PROGRAM', 'GRANT', 'SEED', 'SPINOUT'];
  if (preSeed.includes(r)) return 'round-seed';
  // Everything else is Late / Other
  return 'round-late';
}

// NOTE: Column says "USD M" but values are raw USD
function formatFunding(val) {
  const n = parseFloat(val);
  if (!n || isNaN(n)) return null;
  if (n >= 1e9) return `$${(n/1e9).toFixed(1)}B`;
  if (n >= 1e6) return `$${(n/1e6).toFixed(1)}M`;
  if (n >= 1e3) return `$${(n/1e3).toFixed(0)}K`;
  return `$${n}`;
}

function formatBigNumber(n) {
  if (n >= 1e9) return `$${(n/1e9).toFixed(1)}B`;
  if (n >= 1e6) return `$${(n/1e6).toFixed(0)}M`;
  if (n >= 1e3) return `$${(n/1e3).toFixed(0)}K`;
  return `$${n.toLocaleString()}`;
}

function formatEmployees(val) {
  const n = parseInt(val);
  if (!n || isNaN(n)) return null;
  if (n >= 1000) return `${(n/1000).toFixed(1)}k`;
  return String(n);
}

// ── Country Flags ──
const COUNTRY_FLAGS = {
  'Afghanistan':'\u{1F1E6}\u{1F1EB}','Albania':'\u{1F1E6}\u{1F1F1}','Algeria':'\u{1F1E9}\u{1F1FF}','Andorra':'\u{1F1E6}\u{1F1E9}','Angola':'\u{1F1E6}\u{1F1F4}','Argentina':'\u{1F1E6}\u{1F1F7}','Armenia':'\u{1F1E6}\u{1F1F2}','Australia':'\u{1F1E6}\u{1F1FA}','Austria':'\u{1F1E6}\u{1F1F9}','Azerbaijan':'\u{1F1E6}\u{1F1FF}',
  'Bahamas':'\u{1F1E7}\u{1F1F8}','Bahrain':'\u{1F1E7}\u{1F1ED}','Bangladesh':'\u{1F1E7}\u{1F1E9}','Barbados':'\u{1F1E7}\u{1F1E7}','Belarus':'\u{1F1E7}\u{1F1FE}','Belgium':'\u{1F1E7}\u{1F1EA}','Belize':'\u{1F1E7}\u{1F1FF}','Benin':'\u{1F1E7}\u{1F1EF}','Bhutan':'\u{1F1E7}\u{1F1F9}','Bolivia':'\u{1F1E7}\u{1F1F4}',
  'Bosnia and Herzegovina':'\u{1F1E7}\u{1F1E6}','Botswana':'\u{1F1E7}\u{1F1FC}','Brazil':'\u{1F1E7}\u{1F1F7}','Brunei':'\u{1F1E7}\u{1F1F3}','Bulgaria':'\u{1F1E7}\u{1F1EC}','Burkina Faso':'\u{1F1E7}\u{1F1EB}','Burundi':'\u{1F1E7}\u{1F1EE}','Cambodia':'\u{1F1F0}\u{1F1ED}','Cameroon':'\u{1F1E8}\u{1F1F2}',
  'Canada':'\u{1F1E8}\u{1F1E6}','Chile':'\u{1F1E8}\u{1F1F1}','China':'\u{1F1E8}\u{1F1F3}','Colombia':'\u{1F1E8}\u{1F1F4}','Costa Rica':'\u{1F1E8}\u{1F1F7}','Croatia':'\u{1F1ED}\u{1F1F7}','Cuba':'\u{1F1E8}\u{1F1FA}','Cyprus':'\u{1F1E8}\u{1F1FE}','Czech Republic':'\u{1F1E8}\u{1F1FF}','Czechia':'\u{1F1E8}\u{1F1FF}',
  'Denmark':'\u{1F1E9}\u{1F1F0}','Dominican Republic':'\u{1F1E9}\u{1F1F4}','Ecuador':'\u{1F1EA}\u{1F1E8}','Egypt':'\u{1F1EA}\u{1F1EC}','El Salvador':'\u{1F1F8}\u{1F1FB}','Estonia':'\u{1F1EA}\u{1F1EA}','Ethiopia':'\u{1F1EA}\u{1F1F9}',
  'Finland':'\u{1F1EB}\u{1F1EE}','France':'\u{1F1EB}\u{1F1F7}','Georgia':'\u{1F1EC}\u{1F1EA}','Germany':'\u{1F1E9}\u{1F1EA}','Ghana':'\u{1F1EC}\u{1F1ED}','Greece':'\u{1F1EC}\u{1F1F7}','Guatemala':'\u{1F1EC}\u{1F1F9}',
  'Honduras':'\u{1F1ED}\u{1F1F3}','Hong Kong':'\u{1F1ED}\u{1F1F0}','Hungary':'\u{1F1ED}\u{1F1FA}','Iceland':'\u{1F1EE}\u{1F1F8}','India':'\u{1F1EE}\u{1F1F3}','Indonesia':'\u{1F1EE}\u{1F1E9}','Iran':'\u{1F1EE}\u{1F1F7}','Iraq':'\u{1F1EE}\u{1F1F6}','Ireland':'\u{1F1EE}\u{1F1EA}','Israel':'\u{1F1EE}\u{1F1F1}',
  'Italy':'\u{1F1EE}\u{1F1F9}','Jamaica':'\u{1F1EF}\u{1F1F2}','Japan':'\u{1F1EF}\u{1F1F5}','Jordan':'\u{1F1EF}\u{1F1F4}','Kazakhstan':'\u{1F1F0}\u{1F1FF}','Kenya':'\u{1F1F0}\u{1F1EA}','Kosovo':'\u{1F1FD}\u{1F1F0}','Kuwait':'\u{1F1F0}\u{1F1FC}',
  'Latvia':'\u{1F1F1}\u{1F1FB}','Lebanon':'\u{1F1F1}\u{1F1E7}','Liechtenstein':'\u{1F1F1}\u{1F1EE}','Lithuania':'\u{1F1F1}\u{1F1F9}','Luxembourg':'\u{1F1F1}\u{1F1FA}','Malaysia':'\u{1F1F2}\u{1F1FE}','Malta':'\u{1F1F2}\u{1F1F9}','Mauritius':'\u{1F1F2}\u{1F1FA}','Mexico':'\u{1F1F2}\u{1F1FD}',
  'Moldova':'\u{1F1F2}\u{1F1E9}','Monaco':'\u{1F1F2}\u{1F1E8}','Mongolia':'\u{1F1F2}\u{1F1F3}','Montenegro':'\u{1F1F2}\u{1F1EA}','Morocco':'\u{1F1F2}\u{1F1E6}','Mozambique':'\u{1F1F2}\u{1F1FF}','Myanmar':'\u{1F1F2}\u{1F1F2}',
  'Nepal':'\u{1F1F3}\u{1F1F5}','Netherlands':'\u{1F1F3}\u{1F1F1}','New Zealand':'\u{1F1F3}\u{1F1FF}','Nicaragua':'\u{1F1F3}\u{1F1EE}','Nigeria':'\u{1F1F3}\u{1F1EC}','North Macedonia':'\u{1F1F2}\u{1F1F0}','Norway':'\u{1F1F3}\u{1F1F4}',
  'Oman':'\u{1F1F4}\u{1F1F2}','Pakistan':'\u{1F1F5}\u{1F1F0}','Palestine':'\u{1F1F5}\u{1F1F8}','Panama':'\u{1F1F5}\u{1F1E6}','Paraguay':'\u{1F1F5}\u{1F1FE}','Peru':'\u{1F1F5}\u{1F1EA}','Philippines':'\u{1F1F5}\u{1F1ED}','Poland':'\u{1F1F5}\u{1F1F1}','Portugal':'\u{1F1F5}\u{1F1F9}','Qatar':'\u{1F1F6}\u{1F1E6}',
  'Romania':'\u{1F1F7}\u{1F1F4}','Russia':'\u{1F1F7}\u{1F1FA}','Rwanda':'\u{1F1F7}\u{1F1FC}','Saudi Arabia':'\u{1F1F8}\u{1F1E6}','Senegal':'\u{1F1F8}\u{1F1F3}','Serbia':'\u{1F1F7}\u{1F1F8}','Singapore':'\u{1F1F8}\u{1F1EC}','Slovakia':'\u{1F1F8}\u{1F1F0}','Slovenia':'\u{1F1F8}\u{1F1EE}',
  'South Africa':'\u{1F1FF}\u{1F1E6}','South Korea':'\u{1F1F0}\u{1F1F7}','Spain':'\u{1F1EA}\u{1F1F8}','Sri Lanka':'\u{1F1F1}\u{1F1F0}','Sweden':'\u{1F1F8}\u{1F1EA}','Switzerland':'\u{1F1E8}\u{1F1ED}','Taiwan':'\u{1F1F9}\u{1F1FC}','Tanzania':'\u{1F1F9}\u{1F1FF}','Thailand':'\u{1F1F9}\u{1F1ED}',
  'Tunisia':'\u{1F1F9}\u{1F1F3}','Turkey':'\u{1F1F9}\u{1F1F7}','Uganda':'\u{1F1FA}\u{1F1EC}','Ukraine':'\u{1F1FA}\u{1F1E6}','United Arab Emirates':'\u{1F1E6}\u{1F1EA}','UAE':'\u{1F1E6}\u{1F1EA}','United Kingdom':'\u{1F1EC}\u{1F1E7}','UK':'\u{1F1EC}\u{1F1E7}',
  'United States':'\u{1F1FA}\u{1F1F8}','USA':'\u{1F1FA}\u{1F1F8}','US':'\u{1F1FA}\u{1F1F8}','Uruguay':'\u{1F1FA}\u{1F1FE}','Uzbekistan':'\u{1F1FA}\u{1F1FF}','Venezuela':'\u{1F1FB}\u{1F1EA}','Vietnam':'\u{1F1FB}\u{1F1F3}','Zambia':'\u{1F1FF}\u{1F1F2}','Zimbabwe':'\u{1F1FF}\u{1F1FC}'
};

function countryFlag(c) { return (!c || c==='N/A') ? '' : (COUNTRY_FLAGS[c] || '\u{1F30D}'); }

function displayRound(round) {
  if (!round) return null;
  const r = round.toUpperCase();
  // Show specific rounds as-is: Early VC, any Series
  if (r === 'EARLY VC') return 'Early VC';
  if (r.startsWith('SERIES')) return round.split(' ').map(w => w[0].toUpperCase() + w.slice(1).toLowerCase()).join(' ');
  // Group into Pre-Seed/Angel (includes Spinout) or Late/Other
  const preSeed = ['ANGEL', 'SUPPORT PROGRAM', 'GRANT', 'SEED', 'SPINOUT'];
  if (preSeed.includes(r)) return 'Pre-Seed / Angel';
  // Everything else
  return 'Late / Other';
}

// ── JSONP Data Loader ──
function loadData() {
  return new Promise((resolve, reject) => {
    window.google = window.google || {};
    window.google.visualization = window.google.visualization || {};
    window.google.visualization.Query = window.google.visualization.Query || {};
    window.google.visualization.Query.setResponse = function(json) {
      try {
        const cols = json.table.cols.map(c => c.label);
        allData = json.table.rows.map(row => {
          const obj = {};
          cols.forEach((col, i) => {
            const cell = row.c[i];
            obj[col] = cell ? (cell.v != null ? String(cell.v) : '') : '';
          });
          return obj;
        });
        computeStats();
        buildCharts();
        buildFilters();
        applyFilters();
        parseFounders();
        buildFounderFilters();
        filterFounders();
        loadLeaderboard();
        updateGridViewPills();
        resolve();
      } catch (e) { reject(e); }
    };
    const script = document.createElement('script');
    script.src = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`;
    script.onerror = () => reject(new Error('Failed to load data from Google Sheets.'));
    document.head.appendChild(script);
  });
}

// ── Stats ──
function computeStats() {
  const countries = new Set();
  let funding = 0, employees = 0, unicorns = 0;
  allData.forEach(d => {
    if (d['HQ country'] && d['HQ country'] !== 'N/A') countries.add(d['HQ country']);
    funding += parseFloat(d['Total funding (USD M)']) || 0;
    employees += parseInt(d['Employees latest number']) || 0;
    if (d['Year company became unicorn']) unicorns++;
  });
  document.getElementById('heroNumber').textContent = allData.length;
  document.getElementById('statFunding').textContent = `$${(funding/1e9).toFixed(1)}B`;
  document.getElementById('statUnicorns').textContent = unicorns;
  document.getElementById('statEmployees').textContent = employees >= 1000 ? `${(employees/1000).toFixed(0)}k+` : employees;
  document.getElementById('statCountries').textContent = countries.size;
}

// ── Leaderboard ──
function loadLeaderboard() {
  const container = document.getElementById('leaderboardList');
  if (!container) return;

  SwipeTracker.fetchLeaderboard().then(data => {
    if (!data.length) {
      container.innerHTML = '<div class="leaderboard-empty">No saves tracked yet. Be the first to save a startup!</div>';
      return;
    }

    const maxCount = data[0].count;
    container.innerHTML = '<div class="leaderboard-list-inner">' + data.map((item, i) => {
      // Try to find domain from allData for favicon
      let favicon = '';
      const match = allData.find(d => d['Name'] === item.name);
      if (match && match['Website'] && match['Website'] !== 'N/A') {
        try {
          const domain = new URL(match['Website'].startsWith('http') ? match['Website'] : 'https://' + match['Website']).hostname.replace('www.', '');
          favicon = `<img class="leaderboard-favicon" src="https://www.google.com/s2/favicons?domain=${domain}&sz=32" alt="" onerror="this.style.display='none'"/>`;
        } catch(e) {}
      }
      return `<div class="leaderboard-row">
        ${favicon}
        <span class="leaderboard-name" style="cursor:pointer;" onclick="openSwipeAt('${item.name.replace(/'/g,"\\'")}')">${item.name}</span>
        <div class="leaderboard-bar-wrap">
          <div class="leaderboard-bar" style="width:${(item.count / maxCount * 100).toFixed(1)}%"></div>
        </div>
      </div>`;
    }).join('') + '</div>';
  });
}

// ── Theme Categories ──
const THEME_CATEGORIES = {
  'AI': {
    industries: ['enterprise software'],
    subIndustries: ['artificial intelligence','machine learning','natural language processing','computer vision','generative ai'],
    technologies: ['machine learning','artificial intelligence','natural language processing','computer vision','deep learning','generative ai'],
    tags: ['core ai','ai','generative ai','mlops','artificial intelligence'],
    tagline: ['\\bai\\b','artificial intelligence','machine learning','deep learning','llm','generative']
  },
  'Climate Tech': {
    industries: ['energy','transportation'],
    subIndustries: ['clean energy','renewable energy','solar','wind','carbon','sustainability','cleantech','climate','electric vehicle','ev charging','waste','circular economy','green'],
    technologies: [],
    tags: ['climate','cleantech','sustainability','carbon','renewable','clean energy','green','circular economy'],
    tagline: ['climate','sustainab','carbon','renewable','clean energy','green energy','circular economy','decarboni','emission']
  },
  'Creativity': {
    industries: ['media','music','gaming'],
    subIndustries: ['content creation','video','streaming','animation','design','creative','publishing','digital media','podcasting','augmented reality','virtual reality'],
    technologies: ['augmented reality','virtual reality'],
    tags: ['creator economy','content','creative','metaverse','xr','ar/vr'],
    tagline: ['creative','creator','content creat','design','video','music','art','media','storytell','animation']
  },
  'Cybersecurity': {
    industries: ['security'],
    subIndustries: ['cybersecurity','data privacy','identity','authentication','encryption','fraud','threat detection'],
    technologies: ['cybersecurity','blockchain'],
    tags: ['cybersecurity','data privacy','identity','fraud','zero trust'],
    tagline: ['security','cyber','privacy','encrypt','authenticat','fraud','threat','identity verif']
  },
  'Fintech': {
    industries: ['fintech'],
    subIndustries: ['payments','banking','insurance','lending','wealth management','financial management solutions','regtech','cryptocurrency','defi'],
    technologies: ['blockchain'],
    tags: ['fintech','payments','banking','insurtech','regtech','defi','crypto'],
    tagline: ['fintech','payment','banking','financ','insuran','lending','wealth','invest']
  },
  'Gaming': {
    industries: ['gaming'],
    subIndustries: ['esports','game development','game engine','interactive entertainment','virtual worlds'],
    technologies: ['gaming','unity','unreal'],
    tags: ['gaming','esports','game','metaverse'],
    tagline: ['gaming','game','esport','player','interactive entertain']
  },
  'Healthtech': {
    industries: ['health'],
    subIndustries: ['medical devices','digital health','telemedicine','biotech','diagnostics','mental health','patient care','drug discovery','clinical trials','health platform','genomics','pharmaceutical'],
    technologies: [],
    tags: ['health','medtech','biotech','digital health','patient care','telemedicine','mental health'],
    tagline: ['health','medical','patient','clinical','diagnos','therap','pharma','biotech','telemedicine','mental health','wellness']
  },
  'Spinouts': {
    industries: [],subIndustries: [],technologies: [],tags: [],tagline: [],
    roundMatch: ['SPINOUT']
  }
};

function matchesTheme(d, theme) {
  const cfg = THEME_CATEGORIES[theme];
  if (!cfg) return false;
  if (cfg.roundMatch && cfg.roundMatch.includes(d['Last round'])) return true;
  const ind = (d['Industries']||'').toLowerCase();
  const sub = (d['Sub industries']||'').toLowerCase();
  const tech = (d['Technologies']||'').toLowerCase();
  const tags = (d['Tags']||'').toLowerCase();
  const tl = (d['Tagline']||'').toLowerCase();
  if (cfg.industries.some(k => ind.includes(k))) return true;
  if (cfg.subIndustries.some(k => sub.includes(k))) return true;
  if (cfg.technologies.length && cfg.technologies.some(k => tech.includes(k))) return true;
  if (cfg.tags.some(k => tags.includes(k))) return true;
  if (cfg.tagline.some(p => new RegExp(p,'i').test(tl))) return true;
  return false;
}

// ── Build Charts ──
const CHART_COLORS = ['#f97316','#e5713e','#d16a5f','#bc6381','#a85ca3','#9455c5','#7f4ee7','#8b5cf6','#a78bfa','#c4b5fd'];

function buildBarChart(containerId, data, maxItems) {
  const container = document.getElementById(containerId);
  const items = data.slice(0, maxItems || 8);
  const max = Math.max(...items.map(d => d.count));
  container.innerHTML = items.map((d, i) => {
    const pct = max > 0 ? Math.max((d.count/max)*100, 2) : 0;
    const color = CHART_COLORS[i % CHART_COLORS.length];
    return `<div class="bar-row">
      <div class="bar-label">${d.label}</div>
      <div class="bar-track">
        <div class="bar-fill" style="width:${pct}%;background:${color};"><span>${d.count}</span></div>
      </div>
    </div>`;
  }).join('');
}

function buildColChart(containerId, data, maxItems) {
  const container = document.getElementById(containerId);
  const items = data.slice(0, maxItems || 10);
  const max = Math.max(...items.map(d => d.count));
  container.innerHTML = items.map((d, i) => {
    const pct = max > 0 ? Math.max((d.count/max)*100, 3) : 0;
    const color = CHART_COLORS[i % CHART_COLORS.length];
    return `<div class="col-item">
      <div class="col-bar" style="height:${pct}%;background:${color};"><span>${d.count}</span></div>
      <div class="col-label">${d.label}</div>
    </div>`;
  }).join('');
}

function buildTreemap(containerId, data, maxItems) {
  const container = document.getElementById(containerId);
  const items = data.slice(0, maxItems || 15);
  const total = items.reduce((s, d) => s + d.count, 0);
  const containerW = container.clientWidth || 280;
  const containerH = 190;

  // Simple squarified-ish treemap layout
  let html = '';
  items.forEach((d, i) => {
    const area = (d.count / total) * 100;
    const color = CHART_COLORS[i % CHART_COLORS.length];
    const flag = d.flag || '';
    const showLabel = area > 3;
    html += `<div class="treemap-cell" style="position:relative;flex-basis:${Math.max(area * 1.8, 8)}%;flex-grow:${Math.max(d.count, 1)};background:${color};min-height:50px;">
      ${showLabel ? `<span class="tm-flag">${flag}</span><span class="tm-label">${d.rawLabel || d.label}</span><span class="tm-count">${d.count}</span>` : `<span class="tm-flag">${flag}</span>`}
      <span class="tm-tooltip">${d.rawLabel || d.label}: ${d.count}</span>
    </div>`;
  });
  container.innerHTML = html;
}

// Merged stage groups for chart display
const CHART_STAGE_GROUPS = {
  'Pre-Seed / Angel': ['ANGEL', 'SUPPORT PROGRAM', 'GRANT'],
  'Seed': ['SEED'],
  'Early (A)': ['SERIES A', 'EARLY VC'],
  'Growth / Late': ['SERIES B', 'SERIES C', 'LATE VC', 'GROWTH EQUITY VC', 'GROWTH EQUITY NON VC', 'IPO', 'POST IPO EQUITY', 'POST IPO CONVERTIBLE', 'PRIVATE PLACEMENT VC', 'DEBT', 'SECONDARY', 'ACQUISITION', 'BUYOUT', 'SPINOUT']
};

function buildCharts() {
  // Themes (horizontal bar)
  const themeData = Object.keys(THEME_CATEGORIES).map(t => ({
    label: t,
    count: allData.filter(d => matchesTheme(d, t)).length
  })).sort((a,b) => b.count - a.count);
  buildBarChart('barThemes', themeData);

  // Stages (column chart, merged Growth+Late)
  const stageData = Object.entries(CHART_STAGE_GROUPS).map(([group, stages]) => ({
    label: group,
    count: allData.filter(d => stages.includes(d['Last round'])).length
  })).filter(d => d.count > 0);
  buildColChart('barStages', stageData);

  // Countries (treemap)
  const countryCounts = {};
  allData.forEach(d => {
    const c = d['HQ country'];
    if (c && c !== 'N/A') countryCounts[c] = (countryCounts[c]||0) + 1;
  });
  const countryData = Object.entries(countryCounts)
    .map(([label, count]) => ({ label: `${countryFlag(label)} ${label}`, rawLabel: label, flag: countryFlag(label), count }))
    .sort((a,b) => b.count - a.count);
  buildTreemap('barCountries', countryData, 15);

  // Years (column chart)
  const yearCounts = {};
  allData.forEach(d => {
    const y = parseInt(d['Launch year']);
    if (y && y >= 2010) {
      const bucket = y >= 2024 ? '2024+' : y >= 2022 ? '2022-23' : y >= 2020 ? '2020-21' : y >= 2018 ? '2018-19' : y >= 2016 ? '2016-17' : y >= 2014 ? '2014-15' : '2010-13';
      yearCounts[bucket] = (yearCounts[bucket]||0) + 1;
    }
  });
  const yearOrder = ['2010-13','2014-15','2016-17','2018-19','2020-21','2022-23','2024+'];
  const yearData = yearOrder.map(label => ({ label, count: yearCounts[label]||0 }));
  buildColChart('barYears', yearData);

  // Founder experience donut – parse semicolon-separated per-founder values
  let serial = 0, firstTime = 0;
  allData.forEach(d => {
    const vals = (d['Is serial founder (yes/no)'] || '').split(';').map(v => v.trim().toLowerCase());
    const hasSerial = vals.some(v => v === 'yes');
    if (hasSerial) serial++;
    else firstTime++;
  });
  buildDonutChart('donutFounders', [
    { label: 'Serial Founders', count: serial, color: '#f97316' },
    { label: 'First-time Founders', count: firstTime, color: '#8b5cf6' }
  ]);

  // Team size distribution
  const sizeBuckets = { '1-10': 0, '11-50': 0, '51-200': 0, '201-500': 0, '500+': 0 };
  allData.forEach(d => {
    const n = parseInt(d['Employees latest number']);
    if (!n || isNaN(n)) return;
    if (n <= 10) sizeBuckets['1-10']++;
    else if (n <= 50) sizeBuckets['11-50']++;
    else if (n <= 200) sizeBuckets['51-200']++;
    else if (n <= 500) sizeBuckets['201-500']++;
    else sizeBuckets['500+']++;
  });
  const sizeData = Object.entries(sizeBuckets).map(([label, count]) => ({ label, count }));
  buildColChart('barTeamSize', sizeData);
}

function buildDonutChart(containerId, data) {
  const container = document.getElementById(containerId);
  const total = data.reduce((s, d) => s + d.count, 0);
  const size = 120, cx = 60, cy = 60, r = 45, stroke = 18;

  let cumAngle = -90;
  let paths = '';
  data.forEach(d => {
    const angle = (d.count / total) * 360;
    const startRad = (cumAngle * Math.PI) / 180;
    const endRad = ((cumAngle + angle) * Math.PI) / 180;
    const x1 = cx + r * Math.cos(startRad);
    const y1 = cy + r * Math.sin(startRad);
    const x2 = cx + r * Math.cos(endRad);
    const y2 = cy + r * Math.sin(endRad);
    const large = angle > 180 ? 1 : 0;
    paths += `<path d="M ${x1} ${y1} A ${r} ${r} 0 ${large} 1 ${x2} ${y2}" fill="none" stroke="${d.color}" stroke-width="${stroke}" />`;
    cumAngle += angle;
  });

  const svg = `<svg class="donut-svg" width="${size}" height="${size}" viewBox="0 0 ${size} ${size}">
    ${paths}
    <text x="${cx}" y="${cy - 4}" text-anchor="middle" class="donut-center" font-size="18">${total}</text>
    <text x="${cx}" y="${cy + 12}" text-anchor="middle" class="donut-center-label" font-size="8">companies</text>
  </svg>`;

  const legend = data.map(d => `<div class="donut-legend-item">
    <span class="donut-legend-dot" style="background:${d.color};"></span>
    <span>${d.label}</span>
    <span class="donut-legend-val">${d.count} (${Math.round(d.count/total*100)}%)</span>
  </div>`).join('');

  container.innerHTML = `${svg}<div class="donut-legend">${legend}</div>`;
}

// ── Share Chart ──
// 4YFN logo embedded as data URI (black version, inverted from white via canvas)
// The remote server (event-assets.gsma.com) blocks CORS, so we embed directly.
const logo4yfnDataUri = 'data:image/png;base64,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';

async function shareChart(chartId) {
  const card = document.getElementById(chartId);
  card.classList.add('sharing');
  // Temporarily prefix chart title for export
  const titleEl = card.querySelector('.chart-title');
  const origTitle = titleEl ? titleEl.textContent.trim() : '';
  if (titleEl) titleEl.textContent = '4YFN 2026 startups: ' + origTitle;
  // Set 4YFN logo data URI on watermark images and wait for load
  const wmImgs = card.querySelectorAll('.chart-watermark img.wm-4yfn-logo');
  await Promise.all([...wmImgs].map(img => new Promise(resolve => {
    img.onload = resolve;
    img.onerror = resolve;
    img.src = logo4yfnDataUri;
  })));
  try {
    const canvas = await html2canvas(card, { backgroundColor: '#ffffff', scale: 2, useCORS: true });
    const link = document.createElement('a');
    link.download = `4yfn-2026-${chartId.replace('chart','').toLowerCase()}.png`;
    link.href = canvas.toDataURL('image/png');
    link.click();
    showToast('Image downloaded!');
  } catch(e) {
    showToast('Download failed');
  }
  // Restore original title and clear watermark srcs
  if (titleEl) titleEl.textContent = origTitle;
  wmImgs.forEach(img => { img.src = ''; });
  card.classList.remove('sharing');
}

function showToast(msg) {
  const t = document.getElementById('shareToast');
  t.textContent = msg;
  t.classList.add('visible');
  setTimeout(() => t.classList.remove('visible'), 2500);
}

// ── Build Filters ──
function buildFilters() {
  const container = document.getElementById('industryFilters');
  container.innerHTML = '';
  Object.keys(THEME_CATEGORIES).forEach(theme => {
    const count = allData.filter(d => matchesTheme(d, theme)).length;
    const chip = document.createElement('div');
    chip.className = 'chip';
    chip.dataset.value = theme;
    chip.innerHTML = `${theme}<span class="chip-count">${count}</span>`;
    chip.addEventListener('click', () => toggleIndustry(theme));
    container.appendChild(chip);
  });

  const stageContainer = document.getElementById('stageFilters');
  stageContainer.innerHTML = '';
  Object.entries(STAGE_GROUPS).forEach(([group, stages]) => {
    const count = allData.filter(d => getStageGroup(d['Last round']) === group).length;
    if (!count) return;
    const chip = document.createElement('div');
    chip.className = 'chip';
    chip.dataset.value = group;
    chip.innerHTML = `${group}<span class="chip-count">${count}</span>`;
    chip.addEventListener('click', () => toggleStage(group));
    stageContainer.appendChild(chip);
  });
}

function toggleIndustry(ind) {
  const idx = activeIndustries.indexOf(ind);
  if (idx > -1) activeIndustries.splice(idx, 1); else activeIndustries.push(ind);
  document.querySelectorAll('#industryFilters .chip').forEach(c => c.classList.toggle('active', activeIndustries.includes(c.dataset.value)));
  currentPage = 1;
  applyFilters();
  updateClearButton();
}

function toggleStage(group) {
  const idx = activeStages.indexOf(group);
  if (idx > -1) activeStages.splice(idx, 1); else activeStages.push(group);
  document.querySelectorAll('#stageFilters .chip').forEach(c => c.classList.toggle('active', activeStages.includes(c.dataset.value)));
  currentPage = 1;
  applyFilters();
  updateClearButton();
}

function updateClearButton() {
  document.getElementById('clearFilters').style.display = (activeIndustries.length || activeStages.length) ? 'inline-block' : 'none';
}

document.getElementById('clearFilters').addEventListener('click', () => {
  activeIndustries = []; activeStages = [];
  document.querySelectorAll('#industryFilters .chip, #stageFilters .chip').forEach(c => c.classList.remove('active'));
  document.getElementById('searchInput').value = '';
  currentPage = 1;
  applyFilters();
  updateClearButton();
});

function setGridView(mode) {
  gridViewMode = mode;
  document.querySelectorAll('#gridViewPills button').forEach(b => b.classList.remove('active'));
  const map = { 'all': 0, 'saved': 1, 'hide-skipped': 2 };
  document.querySelectorAll('#gridViewPills button')[map[mode]].classList.add('active');
  currentPage = 1;
  applyFilters();
}

function updateGridViewPills() {
  const savedBtn = document.getElementById('gridViewSaved');
  const skippedBtn = document.getElementById('gridViewSkipped');
  if (savedBtn) savedBtn.style.display = swipeSaved.length ? '' : 'none';
  if (skippedBtn) skippedBtn.style.display = swipeSkipped.length ? '' : 'none';
  // If active mode's data is gone, reset to 'all'
  if (gridViewMode === 'saved' && !swipeSaved.length) setGridView('all');
  if (gridViewMode === 'hide-skipped' && !swipeSkipped.length) setGridView('all');
}

// ── Apply Filters ──
function applyFilters() {
  const query = document.getElementById('searchInput').value.toLowerCase().trim();
  const sort = document.getElementById('sortSelect').value;

  filtered = allData.filter(d => {
    if (query) {
      const hay = `${d['Name']} ${d['Tagline']} ${d['HQ city']} ${d['Industries']} ${d['Sub industries']} ${d['Technologies']}`.toLowerCase();
      if (!hay.includes(query)) return false;
    }
    if (activeIndustries.length && !activeIndustries.some(t => matchesTheme(d, t))) return false;
    if (activeStages.length) {
      if (!activeStages.includes(getStageGroup(d['Last round']))) return false;
    }
    if (gridViewMode === 'saved' && !swipeSaved.includes(d['Name'])) return false;
    if (gridViewMode === 'hide-skipped' && swipeSkipped.includes(d['Name'])) return false;
    return true;
  });

  filtered.sort((a, b) => {
    switch (sort) {
      case 'signal-desc': return (parseFloat(b['Dealroom Signal - Rating'])||0) - (parseFloat(a['Dealroom Signal - Rating'])||0);
      case 'name': return a['Name'].localeCompare(b['Name']);
      case 'name-desc': return b['Name'].localeCompare(a['Name']);
      case 'funding-desc': return (parseFloat(b['Total funding (USD M)'] || 0)||0) - (parseFloat(a['Total funding (USD M)'])||0);
      case 'funding-asc': return (parseFloat(a['Total funding (USD M)'])||0) - (parseFloat(b['Total funding (USD M)'] || 0)||0);
      case 'employees-desc': return (parseInt(b['Employees latest number'])||0) - (parseInt(a['Employees latest number'])||0);
      case 'newest': return (parseInt(b['Launch year'])||0) - (parseInt(a['Launch year'])||0);
      default: return 0;
    }
  });

  document.getElementById('resultCount').textContent = filtered.length;
  renderPage();
  renderPagination();
}

// ── Render Cards ──
function renderPage() {
  const grid = document.getElementById('grid');
  const start = (currentPage - 1) * PER_PAGE;
  const pageData = filtered.slice(start, start + PER_PAGE);

  if (!pageData.length) {
    grid.innerHTML = `<div class="no-results" style="grid-column:1/-1;">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/><path d="M8 11h6"/></svg>
      <p>No startups match your filters.</p>
    </div>`;
    return;
  }

  grid.innerHTML = pageData.map(d => {
    const industries = (d['Industries']||'').split(';').map(i => i.trim()).filter(Boolean);
    const subIndustries = (d['Sub industries']||'').split(';').map(i => i.trim()).filter(Boolean);
    const allTags = [...industries, ...subIndustries].slice(0, 4);
    const round = d['Last round'];
    const funding = formatFunding(d['Total funding (USD M)']);
    const empCount = formatEmployees(d['Employees latest number']);
    const city = d['HQ city'];
    const year = d['Launch year'];
    const dr = displayRound(round);
    const valuation = d['Valuation (USD)'] ? formatBigNumber(parseFloat(d['Valuation (USD)'])) : null;
    const country = d['HQ country'];
    const flag = countryFlag(country);

    let meta = '';
    if (city && city !== 'N/A') meta += `<div class="meta-item">${flag ? `<span style="font-size:0.95rem;line-height:1;">${flag}</span>` : `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>`}<span class="meta-value">${city}</span></div>`;
    if (funding) meta += `<div class="meta-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 1v22M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg><span class="meta-value">${funding} raised</span></div>`;
    if (empCount) meta += `<div class="meta-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/></svg><span class="meta-value">${empCount} ${parseInt(d['Employees latest number'])===1?'person':'people'}</span></div>`;
    if (year && year !== 'N/A') meta += `<div class="meta-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class="meta-value">Est. ${year}</span></div>`;
    if (valuation) meta += `<div class="meta-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><span class="meta-value">${valuation} val.</span></div>`;

    const tags = allTags.map(t => `<span class="card-tag">${t}</span>`).join('');
    const signal = parseFloat(d['Dealroom Signal - Rating']);
    const signalHtml = signal && !isNaN(signal) ? `<div class="signal-row">
      <span class="signal-label">Dealroom Signal</span>
      <div class="signal-track"><div class="signal-fill" style="width:${signal}%;"></div></div>
      <span class="signal-score">${Math.round(signal)}</span>
    </div>` : '';
    let links = '';
    if (d['Dealroom URL'] && d['Dealroom URL'] !== 'N/A') links += `<a class="card-link" href="${d['Dealroom URL'].replace('app.dealroom.co','4yfn.dealroom.co')}" target="_blank" rel="noopener"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>Dealroom</a>`;
    if (d['Website'] && d['Website'] !== 'N/A') links += `<a class="card-link" href="${d['Website']}" target="_blank" rel="noopener"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>Website</a>`;

    let cardDomain = '';
    try { const w = d['Website']||''; cardDomain = w ? new URL(w.startsWith('http')?w:'https://'+w).hostname.replace('www.','') : ''; } catch(e){}

    // Booth lookup
    let boothTag = '';
    if (window.boothData && window.boothData.length) {
      const nameLower = (d['Name'] || '').toLowerCase();
      const booth = window.boothData.find(b => b.name.toLowerCase() === nameLower || (b.dealroomData && b.dealroomData['Name'] && b.dealroomData['Name'].toLowerCase() === nameLower));
      if (booth && booth.stands[0]) {
        boothTag = `<div class="card-booth">📍 Booth <span>${booth.stands[0]}</span></div>`;
      }
    }

    const isSaved = swipeSaved.includes(d['Name']);
    const heartBtn = `<button class="card-save-btn ${isSaved ? 'is-saved' : ''}" data-name="${d['Name'].replace(/"/g,'&quot;')}" title="${isSaved ? 'Remove from saved' : 'Save to favourites'}" onclick="event.stopPropagation();toggleGridSave(this)"><svg width="18" height="18" viewBox="0 0 24 24" fill="${isSaved ? 'currentColor' : 'none'}" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg></button>`;

    return `<div class="card" data-company="${d['Name'].replace(/"/g,'&quot;')}" style="cursor:pointer;">
      ${heartBtn}
      <div class="card-top">
        <div class="card-name">${cardDomain ? `<img class="card-favicon" src="https://www.google.com/s2/favicons?domain=${cardDomain}&sz=32" alt="" onerror="this.style.display='none'"/>` : ''}${d['Name']}</div>
        ${dr ? `<span class="card-round ${getRoundClass(round)}">${dr}</span>` : ''}
      </div>
      ${d['Tagline'] && d['Tagline'] !== 'N/A' ? `<div class="card-tagline">${d['Tagline']}</div>` : ''}
      ${meta ? `<div class="card-meta">${meta}</div>` : ''}
      ${boothTag}
      ${tags ? `<div class="card-tags">${tags}</div>` : ''}
      ${signalHtml}
      ${links ? `<div class="card-links">${links}</div>` : ''}
    </div>`;
  }).join('');
}

// ── Pagination ──
function renderPagination() {
  const totalPages = Math.ceil(filtered.length / PER_PAGE);
  const container = document.getElementById('pagination');
  if (totalPages <= 1) { container.innerHTML = ''; return; }
  let html = `<button class="page-btn" ${currentPage===1?'disabled':''} data-page="${currentPage-1}">&laquo;</button>`;
  const range = 2;
  for (let i = 1; i <= totalPages; i++) {
    if (i===1 || i===totalPages || (i >= currentPage-range && i <= currentPage+range)) {
      html += `<button class="page-btn ${i===currentPage?'active':''}" data-page="${i}">${i}</button>`;
    } else if (i === currentPage-range-1 || i === currentPage+range+1) {
      html += `<span style="color:var(--text3);">...</span>`;
    }
  }
  html += `<button class="page-btn" ${currentPage===totalPages?'disabled':''} data-page="${currentPage+1}">&raquo;</button>`;
  container.innerHTML = html;
  container.querySelectorAll('.page-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const p = parseInt(btn.dataset.page);
      if (p >= 1 && p <= totalPages) {
        currentPage = p;
        renderPage();
        renderPagination();
        document.querySelector('.filters-section').scrollIntoView({ behavior: 'smooth' });
      }
    });
  });
}

// ── Interactive Venue Map ──
(function() {
  const ALGOLIA_URL = 'https://8VVB6VR33K-dsn.algolia.net/1/indexes/exhibitors-barcelona4YFN/query';
  const ALGOLIA_HDR = {
    'X-Algolia-Application-Id': '8VVB6VR33K',
    'X-Algolia-API-Key': '538e9741adb619fb2d54baacbee7e54f',
    'Content-Type': 'application/json'
  };

  let boothData = [];
  let activeHall = 'all';
  let selectedItem = null;
  let mapLoaded = false;

  // Match Algolia exhibitor names to Dealroom company names
  function matchToDealroom(algoliaName) {
    if (!allData || !allData.length) return null;
    const clean = s => s.toLowerCase().replace(/\s*(at 4yfn|s\.l\.?|s\.a\.?|gmbh|ltd\.?|inc\.?|corp\.?|srl|co\.,?\s*ltd\.?|sl|sa)\.?\s*$/i, '').trim();
    const aLow = clean(algoliaName);
    for (const d of allData) {
      const dLow = clean(d['Name'] || '');
      if (!dLow) continue;
      if (dLow === aLow) return d;
      if (aLow.length >= 4 && dLow.length >= 4 && (aLow.includes(dLow) || dLow.includes(aLow))) return d;
    }
    return null;
  }

  // Build enriched card HTML for sidebar
  function buildBoothCard(b) {
    const dr = b.dealroomData;
    const code = b.stands[0] || '';
    const hallShort = b.hall.includes('8.0') ? 'Hall 8.0' : b.hall.includes('8.1') ? 'Hall 8.1' : '';
    let html = `<div class="map-booth-item ${dr ? 'matched' : ''} ${selectedItem === code ? 'active' : ''}" data-code="${code}">`;
    html += `<div class="booth-dot ${dr ? 'dr-match' : 'no-match'}"></div>`;
    html += `<div style="flex:1;min-width:0;">`;
    html += `<div class="map-booth-name">${dr ? dr['Name'] : b.name}</div>`;
    html += `<div style="display:flex;align-items:center;gap:0.4rem;margin-top:0.15rem;">`;
    html += `<span class="map-booth-code">${code}</span>`;
    html += `<span style="font-size:0.6rem;color:var(--text3);">${hallShort}</span>`;
    html += `</div>`;
    // Show expanded detail if selected
    if (selectedItem === code && dr) {
      html += `<div style="margin-top:0.5rem;padding-top:0.5rem;border-top:1px solid var(--border);">`;
      if (dr['Tagline'] && dr['Tagline'] !== 'N/A') html += `<div style="font-size:0.7rem;color:var(--text2);line-height:1.4;margin-bottom:0.4rem;">${dr['Tagline']}</div>`;
      const signal = parseFloat(dr['Dealroom Signal - Rating']);
      if (signal && !isNaN(signal)) {
        html += `<div class="signal-row" style="margin-bottom:0.4rem;"><span class="signal-label">Dealroom Signal</span><div class="signal-track"><div class="signal-fill" style="width:${signal}%"></div></div><span class="signal-score">${Math.round(signal)}</span></div>`;
      }
      let meta = [];
      const flag = countryFlag(dr['HQ country']);
      if (dr['HQ city'] && dr['HQ city'] !== 'N/A') meta.push(`${flag} ${dr['HQ city']}`);
      const funding = formatFunding(dr['Total funding (USD M)']);
      if (funding) meta.push(`${funding} raised`);
      const emp = formatEmployees(dr['Employees latest number']);
      if (emp) meta.push(`${emp} people`);
      if (meta.length) html += `<div style="font-size:0.65rem;color:var(--text3);display:flex;flex-wrap:wrap;gap:0.2rem 0.6rem;margin-bottom:0.4rem;">${meta.join(' &middot; ')}</div>`;
      html += `<div style="display:flex;gap:0.5rem;">`;
      if (dr['Website'] && dr['Website'] !== 'N/A') html += `<a href="${dr['Website']}" target="_blank" style="font-size:0.68rem;color:var(--cyan);text-decoration:none;">Website</a>`;
      if (dr['Dealroom URL'] && dr['Dealroom URL'] !== 'N/A') html += `<a href="${dr['Dealroom URL'].replace('app.dealroom.co','4yfn.dealroom.co')}" target="_blank" style="font-size:0.68rem;color:var(--cyan);text-decoration:none;">Dealroom</a>`;
      html += `</div></div>`;
    } else if (selectedItem === code && !dr) {
      html += `<div style="margin-top:0.3rem;font-size:0.65rem;color:var(--text3);">${b.country || 'Exhibitor'} &middot; ${b.type || ''}</div>`;
    }
    html += `</div></div>`;
    return html;
  }

  // Render sidebar booth list
  function renderBoothList() {
    const listEl = document.getElementById('mapBoothList');
    const countEl = document.getElementById('mapBoothCount');
    const q = (document.getElementById('mapSearch')?.value || '').toLowerCase().trim();

    let items = boothData.filter(b => {
      if (q) {
        const drName = b.dealroomData ? b.dealroomData['Name'].toLowerCase() : '';
        const standMatch = (b.stands[0] || '').toLowerCase().includes(q);
        if (!b.name.toLowerCase().includes(q) && !drName.includes(q) && !standMatch) return false;
      }
      if (activeHall === 'matched' && !b.dealroomData) return false;
      if (activeHall === '8.0' && !b.hall.includes('8.0')) return false;
      if (activeHall === '8.1' && !b.hall.includes('8.1')) return false;
      return true;
    });

    // Sort: matched first, then alphabetical
    items.sort((a, b) => {
      if (a.dealroomData && !b.dealroomData) return -1;
      if (!a.dealroomData && b.dealroomData) return 1;
      const nameA = a.dealroomData ? a.dealroomData['Name'] : a.name;
      const nameB = b.dealroomData ? b.dealroomData['Name'] : b.name;
      return nameA.localeCompare(nameB);
    });

    const shown = items.slice(0, 200);
    listEl.innerHTML = shown.map(b => buildBoothCard(b)).join('');

    // Click handlers
    listEl.querySelectorAll('.map-booth-item').forEach(el => {
      el.addEventListener('click', () => {
        const code = el.dataset.code;
        if (selectedItem === code) {
          selectedItem = null;
          hideMapPopup();
        } else {
          selectedItem = code;
          const booth = boothData.find(b => b.stands[0] === code);
          if (booth) showMapPopup(booth);
        }
        renderBoothList();
      });
    });

    const matchCount = items.filter(i => i.dealroomData).length;
    countEl.textContent = `${items.length} exhibitors${matchCount ? ` \u00b7 ${matchCount} in dataset` : ''}`;
  }

  // Image pan/zoom
  const viewer = document.getElementById('mapViewer');
  const img = document.getElementById('mapImage');
  let scale = 1, panX = 0, panY = 0;
  let dragging = false, lastX, lastY;

  function updateTransform() {
    img.style.transform = `translate(${panX}px, ${panY}px) scale(${scale})`;
  }

  img.onload = function() {
    const vw = viewer.clientWidth, vh = viewer.clientHeight;
    const iw = img.naturalWidth, ih = img.naturalHeight;
    scale = Math.min(vw/iw, vh/ih);
    panX = (vw - iw*scale) / 2;
    panY = (vh - ih*scale) / 2;
    updateTransform();
  };

  viewer.addEventListener('pointerdown', e => {
    if (e.target.closest('.map-controls') || e.target.closest('.map-popup')) return;
    dragging = true;
    lastX = e.clientX; lastY = e.clientY;
    viewer.setPointerCapture(e.pointerId);
  });
  viewer.addEventListener('pointermove', e => {
    if (!dragging) return;
    panX += e.clientX - lastX;
    panY += e.clientY - lastY;
    lastX = e.clientX; lastY = e.clientY;
    updateTransform();
  });
  viewer.addEventListener('pointerup', () => { dragging = false; });
  viewer.addEventListener('wheel', e => {
    e.preventDefault();
    const rect = viewer.getBoundingClientRect();
    const mx = e.clientX - rect.left, my = e.clientY - rect.top;
    const factor = e.deltaY < 0 ? 1.15 : 0.87;
    const newScale = Math.min(Math.max(scale * factor, 0.3), 8);
    panX = mx - (mx - panX) * (newScale / scale);
    panY = my - (my - panY) * (newScale / scale);
    scale = newScale;
    updateTransform();
  }, { passive: false });

  // Map popup functions
  function showMapPopup(booth) {
    const popup = document.getElementById('mapPopup');
    const dr = booth.dealroomData;
    const code = booth.stands[0] || '';
    const hallShort = booth.hall.includes('8.0') ? 'Hall 8.0' : booth.hall.includes('8.1') ? 'Hall 8.1' : '';

    if (!dr) {
      // No Dealroom data — show basic info
      popup.innerHTML = `<div class="map-popup">
        <button class="map-popup-close" onclick="closeMapPopup();">&times;</button>
        <div class="map-popup-name">${booth.name}</div>
        <div class="map-popup-booth">📍 ${code} &middot; ${hallShort}</div>
        <div class="map-popup-meta">${booth.country || 'Exhibitor'} &middot; ${booth.type || ''}</div>
      </div>`;
      return;
    }

    // Rich popup with Dealroom data
    let cardDomain = '';
    try { const w = dr['Website']||''; cardDomain = w ? new URL(w.startsWith('http')?w:'https://'+w).hostname.replace('www.','') : ''; } catch(e){}

    const flag = countryFlag(dr['HQ country']);
    let meta = [];
    if (dr['HQ city'] && dr['HQ city'] !== 'N/A') meta.push(`${flag} ${dr['HQ city']}`);
    const funding = formatFunding(dr['Total funding (USD M)']);
    if (funding) meta.push(`💰 ${funding}`);
    const emp = formatEmployees(dr['Employees latest number']);
    if (emp) meta.push(`👥 ${emp}`);

    const signal = parseFloat(dr['Dealroom Signal - Rating']);
    const signalHtml = signal && !isNaN(signal) ? `<div class="signal-row" style="margin:0.4rem 0;"><span class="signal-label">Dealroom Signal</span><div class="signal-track"><div class="signal-fill" style="width:${signal}%"></div></div><span class="signal-score">${Math.round(signal)}</span></div>` : '';

    const industries = (dr['Industries']||'').split(';').map(i => i.trim()).filter(Boolean).slice(0, 4);
    const tagsHtml = industries.length ? `<div class="map-popup-tags">${industries.map(t => `<span>${t}</span>`).join('')}</div>` : '';

    const isSaved = swipeSaved.includes(dr['Name']);
    let links = `<div class="map-popup-links">`;
    if (dr['Dealroom URL'] && dr['Dealroom URL'] !== 'N/A') links += `<a href="${dr['Dealroom URL'].replace('app.dealroom.co','4yfn.dealroom.co')}" target="_blank">📊 Dealroom</a>`;
    if (dr['Website'] && dr['Website'] !== 'N/A') links += `<a href="${dr['Website']}" target="_blank">🌐 Website</a>`;
    links += `<button class="map-popup-save ${isSaved ? 'is-saved' : ''}" onclick="toggleMapSave(this, '${dr['Name'].replace(/'/g, "\\'")}')"><svg width="14" height="14" viewBox="0 0 24 24" fill="${isSaved ? 'currentColor' : 'none'}" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>${isSaved ? 'Saved' : 'Save'}</button>`;
    links += `</div>`;

    popup.innerHTML = `<div class="map-popup">
      <button class="map-popup-close" onclick="closeMapPopup();">&times;</button>
      <div class="map-popup-name">${cardDomain ? `<img src="https://www.google.com/s2/favicons?domain=${cardDomain}&sz=32" alt="" onerror="this.style.display='none'"/>` : ''}${dr['Name']}</div>
      ${dr['Tagline'] && dr['Tagline'] !== 'N/A' ? `<div class="map-popup-tagline">${dr['Tagline']}</div>` : ''}
      <div class="map-popup-booth">📍 ${code} &middot; ${hallShort}</div>
      ${meta.length ? `<div class="map-popup-meta">${meta.join(' &middot; ')}</div>` : ''}
      ${tagsHtml}
      ${signalHtml}
      ${links}
    </div>`;
  }

  function hideMapPopup() {
    document.getElementById('mapPopup').innerHTML = '';
  }

  window.closeMapPopup = function() {
    hideMapPopup();
    selectedItem = null;
    renderBoothList();
  };

  window.toggleMapSave = function(btn, name) {
    const idx = swipeSaved.indexOf(name);
    if (idx > -1) {
      swipeSaved.splice(idx, 1);
      btn.classList.remove('is-saved');
      btn.querySelector('svg').setAttribute('fill', 'none');
      btn.textContent = '';
      btn.innerHTML = `<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>Save`;
    } else {
      swipeSaved.push(name);
      SwipeTracker.trackSave(name, 'map');
      btn.classList.add('is-saved');
      btn.innerHTML = `<svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>Saved`;
    }
    localStorage.setItem('4yfn_saved', JSON.stringify(swipeSaved));
    updateSwipeSavedCount();
    updateNavSavedBadge();
    updateGridViewPills();
  };

  window.mapZoom = function(factor) {
    const vw = viewer.clientWidth/2, vh = viewer.clientHeight/2;
    const newScale = Math.min(Math.max(scale * factor, 0.3), 8);
    panX = vw - (vw - panX) * (newScale / scale);
    panY = vh - (vh - panY) * (newScale / scale);
    scale = newScale;
    updateTransform();
  };
  window.mapReset = function() {
    const vw = viewer.clientWidth, vh = viewer.clientHeight;
    const iw = img.naturalWidth, ih = img.naturalHeight;
    scale = Math.min(vw/iw, vh/ih);
    panX = (vw - iw*scale) / 2;
    panY = (vh - ih*scale) / 2;
    updateTransform();
  };

  // Hall tab clicks
  document.querySelectorAll('.map-hall-tab').forEach(tab => {
    tab.addEventListener('click', () => {
      document.querySelectorAll('.map-hall-tab').forEach(t => t.classList.remove('active'));
      tab.classList.add('active');
      activeHall = tab.dataset.hall;
      selectedItem = null;
      renderBoothList();
    });
  });

  // Search
  document.getElementById('mapSearch')?.addEventListener('input', () => {
    selectedItem = null;
    renderBoothList();
  });

  // Wait for Dealroom data, then load Algolia and match
  function initMap() {
    if (mapLoaded) return;
    if (!allData || !allData.length) {
      setTimeout(initMap, 500);
      return;
    }
    mapLoaded = true;
    fetch(ALGOLIA_URL, {
      method: 'POST',
      headers: ALGOLIA_HDR,
      body: JSON.stringify({ query: '', hitsPerPage: 1000, attributesToRetrieve: ['name', 'stands', 'building', 'type', 'country'] })
    })
    .then(r => r.json())
    .then(data => {
      boothData = data.hits.map(h => ({
        name: h.name,
        stands: (h.stands || []).map(s => s.includes('Stand ') ? s.split('Stand ')[1] : s),
        hall: (h.building && h.building[0]) || '',
        type: h.type || '',
        country: h.country || '',
        dealroomData: null
      })).filter(d => d.stands.length > 0);

      // Deduplicate by stand code (keep first occurrence)
      const seen = new Set();
      boothData = boothData.filter(b => {
        const key = b.name + '|' + b.stands[0];
        if (seen.has(key)) return false;
        seen.add(key);
        return true;
      });

      // Match to Dealroom data
      boothData.forEach(b => { b.dealroomData = matchToDealroom(b.name); });

      const matchCount = boothData.filter(b => b.dealroomData).length;
      window.boothData = boothData; // expose globally for swipe cards and grid cards
      console.log(`Map: ${boothData.length} exhibitors loaded, ${matchCount} matched to Dealroom data`);

      renderBoothList();
      // Re-render grid cards now that booth data is available
      if (typeof renderPage === 'function') renderPage();
    })
    .catch(err => {
      console.error('Map load error:', err);
      document.getElementById('mapBoothCount').textContent = 'Could not load exhibitor data';
    });
  }

  initMap();
})();

// ── Add Startup Modal ──
function openModal() {
  document.getElementById('addModal').classList.add('open');
  document.getElementById('modalForm').style.display = 'block';
  document.getElementById('modalSuccess').style.display = 'none';
  document.getElementById('startupUrl').value = '';
  document.getElementById('startupNote').value = '';
}
function closeModal() {
  document.getElementById('addModal').classList.remove('open');
}
document.getElementById('addModal').addEventListener('click', e => {
  if (e.target === e.currentTarget) closeModal();
});

function submitStartup() {
  const url = document.getElementById('startupUrl').value.trim();
  if (!url) return;
  const note = document.getElementById('startupNote').value.trim();
  const btn = document.getElementById('submitBtn');
  btn.disabled = true;
  btn.textContent = 'Sending...';

  const subject = encodeURIComponent('4YFN 2026 - New Startup Submission');
  const body = encodeURIComponent(`New startup submission for 4YFN 2026 Explorer:\n\nCompany URL: ${url}\n${note ? `Note: ${note}\n` : ''}\nSubmitted from the 4YFN Startup Explorer dashboard.`);

  // Open mailto as fallback — in production this would be an API call
  window.location.href = `mailto:support@dealroom.co?subject=${subject}&body=${body}`;

  setTimeout(() => {
    document.getElementById('modalForm').style.display = 'none';
    document.getElementById('modalSuccess').style.display = 'block';
    btn.disabled = false;
    btn.textContent = 'Submit';
  }, 500);
}

// ── Founder Directory ──
const FOUNDERS_PER_PAGE = 48;
let allFounders = [];
let filteredFounders = [];
let founderPage = 1;

function parseFounders() {
  allFounders = [];
  allData.forEach(d => {
    const names = (d['Founders'] || '').split(';').map(s => s.trim()).filter(Boolean);
    if (!names.length) return;
    const linkedins = (d['Founders linkedin'] || '').split(';').map(s => s.trim());
    const unis = (d['Founders universities'] || '').split(';').map(s => s.trim());
    const bgs = (d['Founders backgrounds'] || '').split(';').map(s => s.trim());
    const exps = (d['Founders company experience'] || '').split(';').map(s => s.trim());
    const isSerial = (d['Is serial founder (yes/no)'] || '').toLowerCase();
    const isTop = (d['Is top past founder (yes/no)'] || '').toLowerCase();
    const strength = d['Founders strength'] || '';

    names.forEach((name, i) => {
      if (!name || name === 'N/A') return;
      // Extract LinkedIn username for photo lookup
      const li = linkedins[i] || linkedins[0] || '';
      let liUsername = '';
      if (li) {
        const match = li.match(/linkedin\.com\/in\/([^\/\?]+)/);
        if (match) liUsername = match[1].replace(/\/$/, '');
      }
      // Build website domain for company favicon
      const website = d['Website'] || '';
      let domain = '';
      try { domain = website ? new URL(website.startsWith('http') ? website : 'https://' + website).hostname.replace('www.','') : ''; } catch(e) {}

      allFounders.push({
        name,
        company: d['Name'],
        companyData: d,
        companyUrl: d['Dealroom URL'] ? d['Dealroom URL'].replace('app.dealroom.co','4yfn.dealroom.co') : '',
        linkedin: li,
        liUsername,
        domain,
        university: unis[i] || '',
        background: bgs[i] || '',
        experience: exps[i] || '',
        isSerial: isSerial === 'yes',
        isTop: isTop === 'yes',
        strength,
        country: d['HQ country'],
        initials: name.split(/\s+/).map(w => w[0]).join('').toUpperCase().slice(0,2)
      });
    });
  });
  // Deduplicate founders:
  // 1. Exact match (after stripping non-alpha) — keep the one with the longer/richer name
  // 2. Same company + abbreviated name (e.g. "Alberto M." matches "Alberto Molpeceres")
  // Sort longer names first so the richer entry is kept
  allFounders.sort((a, b) => b.name.length - a.name.length);
  const seenFounders = new Map(); // key -> founder object
  allFounders = allFounders.filter(f => {
    const key = f.name.toLowerCase().replace(/[^a-z]/g, '');
    if (seenFounders.has(key)) return false;
    // Check if this is an abbreviation of an already-seen founder from the same company
    const firstName = f.name.split(/\s+/)[0].toLowerCase().replace(/[^a-z]/g, '');
    if (firstName.length >= 2) {
      for (const [existingKey, existingF] of seenFounders) {
        if (existingF.company === f.company && existingKey.startsWith(firstName) && existingKey !== key) {
          return false; // abbreviated duplicate — skip
        }
      }
    }
    seenFounders.set(key, f);
    return true;
  });
  allFounders.sort((a, b) => a.name.localeCompare(b.name));
}

let activeFounderThemes = [];
let activeFounderStages = [];

function buildFounderFilters() {
  const themeContainer = document.getElementById('founderThemeFilters');
  themeContainer.innerHTML = '';
  Object.keys(THEME_CATEGORIES).forEach(theme => {
    const count = allFounders.filter(f => f.companyData && matchesTheme(f.companyData, theme)).length;
    const chip = document.createElement('div');
    chip.className = 'chip';
    chip.dataset.value = theme;
    chip.innerHTML = `${theme}<span class="chip-count">${count}</span>`;
    chip.addEventListener('click', () => toggleFounderTheme(theme));
    themeContainer.appendChild(chip);
  });

  const stageContainer = document.getElementById('founderStageFilters');
  stageContainer.innerHTML = '';
  Object.entries(STAGE_GROUPS).forEach(([group, stages]) => {
    const count = allFounders.filter(f => f.companyData && getStageGroup(f.companyData['Last round']) === group).length;
    if (!count) return;
    const chip = document.createElement('div');
    chip.className = 'chip';
    chip.dataset.value = group;
    chip.innerHTML = `${group}<span class="chip-count">${count}</span>`;
    chip.addEventListener('click', () => toggleFounderStage(group));
    stageContainer.appendChild(chip);
  });
}

function toggleFounderTheme(theme) {
  const idx = activeFounderThemes.indexOf(theme);
  if (idx > -1) activeFounderThemes.splice(idx, 1); else activeFounderThemes.push(theme);
  document.querySelectorAll('#founderThemeFilters .chip').forEach(c => c.classList.toggle('active', activeFounderThemes.includes(c.dataset.value)));
  filterFounders();
}

function toggleFounderStage(group) {
  const idx = activeFounderStages.indexOf(group);
  if (idx > -1) activeFounderStages.splice(idx, 1); else activeFounderStages.push(group);
  document.querySelectorAll('#founderStageFilters .chip').forEach(c => c.classList.toggle('active', activeFounderStages.includes(c.dataset.value)));
  filterFounders();
}

function filterFounders() {
  const q = document.getElementById('founderSearch').value.toLowerCase().trim();
  filteredFounders = [...allFounders];
  if (q) {
    filteredFounders = filteredFounders.filter(f => `${f.name} ${f.company} ${f.university} ${f.background} ${f.experience}`.toLowerCase().includes(q));
  }
  if (activeFounderThemes.length) {
    filteredFounders = filteredFounders.filter(f => f.companyData && activeFounderThemes.some(t => matchesTheme(f.companyData, t)));
  }
  if (activeFounderStages.length) {
    filteredFounders = filteredFounders.filter(f => {
      if (!f.companyData) return false;
      return activeFounderStages.includes(getStageGroup(f.companyData['Last round']));
    });
  }
  founderPage = 1;
  renderFounders();
}

function renderFounders() {
  const grid = document.getElementById('foundersGrid');
  const start = (founderPage - 1) * FOUNDERS_PER_PAGE;
  const page = filteredFounders.slice(start, start + FOUNDERS_PER_PAGE);
  document.getElementById('founderCount').textContent = filteredFounders.length;

  if (!page.length) {
    grid.innerHTML = '<div class="no-results" style="grid-column:1/-1;"><p>No founders match your search.</p></div>';
    document.getElementById('foundersPagination').innerHTML = '';
    return;
  }

  grid.innerHTML = page.map(f => {
    let meta = [];
    if (f.university && f.university !== 'N/A') meta.push(f.university.split(',')[0].trim());
    if (f.experience && f.experience !== 'N/A') {
      const exp = f.experience.split(',')[0].trim();
      if (exp.length < 40) meta.push(exp);
    }

    let badges = '';
    if (f.isSerial) badges += '<span class="founder-badge badge-serial">Serial Founder</span>';
    if (f.isTop) badges += '<span class="founder-badge badge-top">Top Founder</span>';

    let links = '';
    if (f.linkedin && f.linkedin !== 'N/A') {
      const url = f.linkedin.startsWith('http') ? f.linkedin : `https://${f.linkedin}`;
      links = `<div class="founder-links"><a href="${url}" target="_blank" rel="noopener"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-4 0v7h-4v-7a6 6 0 0 1 6-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>LinkedIn</a></div>`;
    }

    // Company favicon
    const favicon = f.domain ? `<img class="founder-favicon" src="https://www.google.com/s2/favicons?domain=${f.domain}&sz=32" alt="" onerror="this.style.display='none'">` : '';

    // Varied avatar gradients
    const avatarGradients = [
      ['#8b5cf6','#06b6d4'],['#f97316','#f43f5e'],['#10b981','#06b6d4'],
      ['#6366f1','#ec4899'],['#a855f7','#f97316'],['#14b8a6','#3b82f6'],
      ['#f43f5e','#a855f7'],['#3b82f6','#10b981'],['#ec4899','#8b5cf6'],
      ['#06b6d4','#6366f1']
    ];
    const hash = f.name.split('').reduce((a,c) => a + c.charCodeAt(0), 0);
    const [c1,c2] = avatarGradients[hash % avatarGradients.length];
    const gradStyle = `background:linear-gradient(135deg,${c1},${c2})`;

    return `<div class="founder-card">
      <div class="founder-avatar" style="${gradStyle}" data-li="${f.liUsername || ''}" data-domain="${f.domain || ''}">${f.initials}</div>
      <div class="founder-info">
        <div class="founder-name">${f.name}</div>
        <div class="founder-company">${favicon}${f.company}</div>
        ${meta.length ? `<div class="founder-meta">${meta.join(' · ')}</div>` : ''}
        ${badges ? `<div class="founder-badges">${badges}</div>` : ''}
        ${links}
      </div>
    </div>`;
  }).join('');

  // Try loading founder photos from LinkedIn via unavatar
  grid.querySelectorAll('.founder-avatar[data-li]').forEach(el => {
    const liUsername = el.dataset.li || '';
    const card = el.closest('.founder-card');
    const name = card?.querySelector('.founder-name')?.textContent || '';
    if (!liUsername) return;
    const img = new Image();
    img.onload = function() {
      if (img.naturalWidth > 1 && img.naturalHeight > 1) {
        el.innerHTML = '';
        el.appendChild(img);
        el.classList.add('has-photo');
      }
    };
    img.onerror = function() { /* keep initials */ };
    img.src = `https://unavatar.io/linkedin/${liUsername}?fallback=false`;
    img.alt = name;
  });

  // Pagination
  const totalPages = Math.ceil(filteredFounders.length / FOUNDERS_PER_PAGE);
  const container = document.getElementById('foundersPagination');
  if (totalPages <= 1) { container.innerHTML = ''; return; }
  let html = `<button class="page-btn" ${founderPage===1?'disabled':''} data-fp="${founderPage-1}">&laquo;</button>`;
  const range = 2;
  for (let i = 1; i <= totalPages; i++) {
    if (i===1 || i===totalPages || (i >= founderPage-range && i <= founderPage+range)) {
      html += `<button class="page-btn ${i===founderPage?'active':''}" data-fp="${i}">${i}</button>`;
    } else if (i === founderPage-range-1 || i === founderPage+range+1) {
      html += `<span style="color:var(--text3);">...</span>`;
    }
  }
  html += `<button class="page-btn" ${founderPage===totalPages?'disabled':''} data-fp="${founderPage+1}">&raquo;</button>`;
  container.innerHTML = html;
  container.querySelectorAll('.page-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const p = parseInt(btn.dataset.fp);
      if (p >= 1 && p <= totalPages) {
        founderPage = p;
        renderFounders();
        document.getElementById('founders').scrollIntoView({ behavior: 'smooth' });
      }
    });
  });
}

// ── Event Listeners ──
document.getElementById('searchInput').addEventListener('input', () => { currentPage = 1; applyFilters(); });
document.getElementById('sortSelect').addEventListener('change', () => applyFilters());
document.getElementById('founderSearch').addEventListener('input', filterFounders);

const scrollBtn = document.getElementById('scrollTop');
window.addEventListener('scroll', () => scrollBtn.classList.toggle('visible', window.scrollY > 500));
scrollBtn.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));

// Smooth scroll for nav links
document.querySelectorAll('.header-nav a[href^="#"]').forEach(a => {
  if (a.getAttribute('href') === '#') return; // skip non-section links (e.g. heart)
  a.addEventListener('click', e => {
    e.preventDefault();
    const target = document.querySelector(a.getAttribute('href'));
    if (target) target.scrollIntoView({ behavior: 'smooth' });
  });
});

// ── Swipe Mode ──
let swipeIndex = 0;
let swipeSaved = JSON.parse(localStorage.getItem('4yfn_saved') || '[]');
let swipePool = [];
// Update nav badge on load
setTimeout(() => updateNavSavedBadge(), 100);

function openSwipeMode() {
  document.getElementById('swipeOverlay').classList.add('open');
  document.body.style.overflow = 'hidden';
  updateSwipeSavedCount();
  // Show filter screen
  document.getElementById('swipeFilter').style.display = '';
  document.getElementById('swipeStack').style.display = 'none';
  document.getElementById('swipeActions').style.display = 'none';
  document.querySelector('.swipe-counter').style.display = 'none';
  buildSwipeFilters();
}

function buildSwipeFilters() {
  // Themes – use same THEME_CATEGORIES as main directory
  const themes = Object.keys(THEME_CATEGORIES);
  const themesEl = document.getElementById('swipeFilterThemes');
  themesEl.innerHTML = themes.map(t => {
    const count = allData.filter(d => matchesTheme(d, t)).length;
    return `<div class="swipe-filter-chip" data-theme="${t}">${t} <span style="opacity:0.55">${count}</span></div>`;
  }).join('');
  themesEl.querySelectorAll('.swipe-filter-chip').forEach(chip => {
    chip.addEventListener('click', () => { chip.classList.toggle('selected'); updateSwipeFilterCount(); });
  });
  // Stages – use same STAGE_GROUPS as main directory
  const stagesEl = document.getElementById('swipeFilterStages');
  stagesEl.innerHTML = Object.entries(STAGE_GROUPS).map(([group, stages]) => {
    const count = allData.filter(d => getStageGroup(d['Last round']) === group).length;
    if (!count) return '';
    return `<div class="swipe-filter-chip" data-stage="${group}">${group} <span style="opacity:0.55">${count}</span></div>`;
  }).join('');
  stagesEl.querySelectorAll('.swipe-filter-chip').forEach(chip => {
    chip.addEventListener('click', () => { chip.classList.toggle('selected'); updateSwipeFilterCount(); });
  });
  updateSwipeFilterCount();
}

function updateSwipeFilterCount() {
  const pool = getSwipeFilteredPool();
  document.getElementById('swipeFilterCount').textContent = `${pool.length} startups match your selection`;
}

function getSwipeFilteredPool() {
  const selThemes = [...document.querySelectorAll('#swipeFilterThemes .swipe-filter-chip.selected')].map(c => c.dataset.theme);
  const selStages = [...document.querySelectorAll('#swipeFilterStages .swipe-filter-chip.selected')].map(c => c.dataset.stage);
  let pool = [...allData];
  if (selThemes.length) {
    pool = pool.filter(d => selThemes.some(t => matchesTheme(d, t)));
  }
  if (selStages.length) {
    pool = pool.filter(d => selStages.includes(getStageGroup(d['Last round'])));
  }
  pool.sort((a, b) => (parseFloat(b['Dealroom Signal - Rating']) || 0) - (parseFloat(a['Dealroom Signal - Rating']) || 0));
  return pool;
}

function startSwipeSwiping() {
  swipePool = getSwipeFilteredPool();
  swipeIndex = 0;
  document.getElementById('swipeFilter').style.display = 'none';
  document.getElementById('swipeStack').style.display = '';
  document.getElementById('swipeActions').style.display = '';
  document.querySelector('.swipe-counter').style.display = '';
  renderSwipeCard();
}

function openSwipeAt(name) {
  let pool = [...allData];
  pool.sort((a, b) => (parseFloat(b['Dealroom Signal - Rating']) || 0) - (parseFloat(a['Dealroom Signal - Rating']) || 0));
  const idx = pool.findIndex(d => d['Name'] === name);
  if (idx === -1) return;
  if (idx > 0) {
    const [company] = pool.splice(idx, 1);
    pool.unshift(company);
  }
  swipePool = pool;
  swipeIndex = 0;
  document.getElementById('swipeOverlay').classList.add('open');
  document.body.style.overflow = 'hidden';
  updateSwipeSavedCount();
  document.getElementById('swipeFilter').style.display = 'none';
  document.getElementById('swipeStack').style.display = '';
  document.getElementById('swipeActions').style.display = '';
  document.querySelector('.swipe-counter').style.display = '';
  renderSwipeCard();
}

function closeSwipeMode() {
  document.getElementById('swipeOverlay').classList.remove('open');
  document.body.style.overflow = '';
}
// Click outside card to close swipe mode
document.getElementById('swipeOverlay').addEventListener('click', e => {
  // Only close if clicking directly on the overlay background or the stack area (not on card/filter/buttons)
  const t = e.target;
  if (t.id === 'swipeOverlay' || t.id === 'swipeStack' || t.classList.contains('swipe-stack')) {
    closeSwipeMode();
  }
});

function updateSwipeSavedCount() {
  document.getElementById('swipeSavedCount').textContent = `${swipeSaved.length} saved`;
  updateNavSavedBadge();
}

function updateNavSavedBadge() {
  ['navSavedBadge', 'navSavedBadgeMobile'].forEach(id => {
    const badge = document.getElementById(id);
    if (!badge) return;
    if (swipeSaved.length > 0) {
      badge.textContent = swipeSaved.length;
      badge.classList.add('has-saved');
    } else {
      badge.classList.remove('has-saved');
    }
  });
}

function showSavedCompanies() {
  if (!swipeSaved.length) {
    showToast('No saved companies yet — try the swipe explorer!');
    return;
  }
  document.getElementById('startups').scrollIntoView({ behavior: 'smooth' });
  setGridView('saved');
}

function toggleGridSave(btn) {
  const name = btn.dataset.name;
  const idx = swipeSaved.indexOf(name);
  if (idx > -1) {
    swipeSaved.splice(idx, 1);
    btn.classList.remove('is-saved');
    btn.querySelector('svg').setAttribute('fill', 'none');
    btn.title = 'Save to favourites';
  } else {
    swipeSaved.push(name);
    SwipeTracker.trackSave(name, 'grid');
    btn.classList.add('is-saved');
    btn.querySelector('svg').setAttribute('fill', 'currentColor');
    btn.title = 'Remove from saved';
  }
  localStorage.setItem('4yfn_saved', JSON.stringify(swipeSaved));
  updateSwipeSavedCount();
  updateNavSavedBadge();
  updateGridViewPills();
}

// Grid card: single-click opens detail, double-click toggles favourite
(function() {
  let clickTimer = null;
  const grid = document.getElementById('grid');

  grid.addEventListener('click', function(e) {
    // Ignore clicks on links, buttons, and interactive elements inside cards
    if (e.target.closest('a') || e.target.closest('button') || e.target.closest('.card-save-btn')) return;
    const card = e.target.closest('.card');
    if (!card) return;
    const name = card.dataset.company;
    if (!name) return;
    // Delay single-click to allow double-click detection
    if (clickTimer) { clearTimeout(clickTimer); clickTimer = null; return; }
    clickTimer = setTimeout(() => { clickTimer = null; openSwipeAt(name); }, 250);
  });

  grid.addEventListener('dblclick', function(e) {
    if (e.target.closest('a') || e.target.closest('button') || e.target.closest('.card-save-btn')) return;
    const card = e.target.closest('.card');
    if (!card) return;
    if (clickTimer) { clearTimeout(clickTimer); clickTimer = null; }
    const btn = card.querySelector('.card-save-btn');
    if (btn) {
      toggleGridSave(btn);
      card.style.transition = 'transform 0.15s';
      card.style.transform = 'scale(1.03)';
      setTimeout(() => { card.style.transform = ''; }, 150);
    }
  });
})();

function unsaveCompany(name) {
  swipeSaved = swipeSaved.filter(n => n !== name);
  localStorage.setItem('4yfn_saved', JSON.stringify(swipeSaved));
  updateNavSavedBadge();
  updateGridViewPills();
  if (swipeSaved.length === 0) {
    showToast('All companies removed from saved');
  } else if (gridViewMode === 'saved') {
    applyFilters();
  }
}

function renderSwipeCard() {
  const stack = document.getElementById('swipeStack');
  document.getElementById('swipeCounter').textContent = `${swipeIndex + 1} / ${swipePool.length}`;

  if (swipeIndex >= swipePool.length) {
    stack.innerHTML = `<div class="swipe-empty">
      <h3>All done! 🎉</h3>
      <p>You've reviewed all ${swipePool.length} startups.<br>${swipeSaved.length} saved to favourites.</p>
    </div>`;
    return;
  }

  const d = swipePool[swipeIndex];
  const flag = countryFlag(d['HQ country']);
  const signal = parseFloat(d['Dealroom Signal - Rating']);
  const signalHtml = signal && !isNaN(signal) ? `<div class="swipe-card-signal signal-row"><span class="signal-label">Dealroom Signal</span><div class="signal-track"><div class="signal-fill" style="width:${signal}%"></div></div><span class="signal-score">${Math.round(signal)}</span></div>` : '';

  let meta = [];
  if (d['HQ city'] && d['HQ city'] !== 'N/A') meta.push(`${flag} ${d['HQ city']}`);
  const funding = formatFunding(d['Total funding (USD M)']);
  if (funding) meta.push(`💰 ${funding}`);
  const emp = formatEmployees(d['Employees latest number']);
  if (emp) meta.push(`👥 ${emp}`);
  if (d['Established'] && d['Established'] !== 'N/A') meta.push(`📅 Est. ${d['Established']}`);

  const round = displayRound(d['Last round']);
  const roundClass = getRoundClass(d['Last round']);
  const roundBadge = round ? `<span class="tag ${roundClass}" style="font-size:0.72rem;">${round}</span>` : '';

  const tags = (d['Tags'] || '').split(/[,;]/).map(t => t.trim()).filter(t => t && t !== 'N/A' && !t.toLowerCase().startsWith('4yfn')).slice(0, 5);
  const tagsHtml = tags.length ? `<div class="swipe-card-tags">${tags.map(t => `<span>${t}</span>`).join('')}${roundBadge}</div>` : (roundBadge ? `<div class="swipe-card-tags">${roundBadge}</div>` : '');

  const founderNames = (d['Founders'] || '').split(';').map(s => s.trim()).filter(Boolean);
  const founderLinkedins = (d['Founders linkedin'] || '').split(';').map(s => s.trim());
  const founderUnis = (d['Founders universities'] || '').split(';').map(s => s.trim());
  const founderBgs = (d['Founders backgrounds'] || '').split(';').map(s => s.trim());
  const founderExps = (d['Founders company experience'] || '').split(';').map(s => s.trim());
  const isSerial = (d['Is serial founder (yes/no)'] || '').toLowerCase() === 'yes';
  const isTopFounder = (d['Is top past founder (yes/no)'] || '').toLowerCase() === 'yes';
  const avatarGrads = [['#8b5cf6','#06b6d4'],['#f97316','#f43f5e'],['#10b981','#06b6d4'],['#6366f1','#ec4899'],['#a855f7','#f97316'],['#14b8a6','#3b82f6']];
  // Get company domain for founder photo lookup
  let companyDomain = '';
  try { const w = d['Website']||''; companyDomain = w ? new URL(w.startsWith('http')?w:'https://'+w).hostname.replace('www.','') : ''; } catch(e){}
  let foundersHtml = '';
  if (founderNames.length) {
    const rows = founderNames.slice(0, 3).map((fn, i) => {
      const initials = fn.split(/\s+/).map(w => w[0]).join('').toUpperCase().slice(0,2);
      const hash = fn.split('').reduce((a,c) => a + c.charCodeAt(0), 0);
      const [gc1,gc2] = avatarGrads[hash % avatarGrads.length];
      const li = founderLinkedins[i] || '';
      const liUrl = li && li !== 'N/A' ? (li.startsWith('http') ? li : `https://${li}`) : '';
      const liIcon = liUrl ? `<a href="${liUrl}" target="_blank" rel="noopener" onclick="event.stopPropagation()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-4 0v7h-4v-7a6 6 0 0 1 6-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a>` : '';
      let liUsername = '';
      if (li) { const m = li.match(/linkedin\.com\/in\/([^\/\?]+)/); if (m) liUsername = m[1].replace(/\/$/, ''); }
      let sub = [];
      const uni = (founderUnis[i] || '').split(',')[0].trim();
      const exp = (founderExps[i] || '').split(',')[0].trim();
      if (uni && uni !== 'N/A' && uni.toLowerCase() !== 'n/a') sub.push(uni);
      else if (exp && exp !== 'N/A' && exp.toLowerCase() !== 'n/a' && exp.length < 35) sub.push(exp);
      let badges = '';
      if (isSerial) badges += '<span class="swipe-founder-badge sf">Serial</span>';
      if (isTopFounder) badges += '<span class="swipe-founder-badge tf">Top</span>';
      return `<div class="swipe-founder-row">
        <div class="swipe-founder-avatar" data-li="${liUsername}" style="background:linear-gradient(135deg,${gc1},${gc2})">${initials}</div>
        <div class="swipe-founder-details">
          <div class="swipe-founder-name">${fn}${liIcon}${i===0 ? badges : ''}</div>
          ${sub.length ? `<div class="swipe-founder-sub">${sub.join(' · ')}</div>` : ''}
        </div>
      </div>`;
    }).join('');
    const moreCount = founderNames.length > 3 ? `<div style="font-size:0.65rem;color:var(--text3);padding-top:0.2rem;">+${founderNames.length - 3} more</div>` : '';
    foundersHtml = `<div class="swipe-card-founders"><div class="swipe-founder-label">Founders</div>${rows}${moreCount}</div>`;
  }

  // Look up booth location from boothData
  let boothHtml = '';
  if (window.boothData && window.boothData.length) {
    const nameLower = (d['Name'] || '').toLowerCase();
    const booth = window.boothData.find(b => b.name.toLowerCase() === nameLower || (b.dealroomData && b.dealroomData['Name'] && b.dealroomData['Name'].toLowerCase() === nameLower));
    if (booth && booth.stands[0]) {
      boothHtml = `<div class="swipe-card-booth">📍 Booth <span>${booth.stands[0]}</span></div>`;
    }
  }

  let links = [];
  if (d['Dealroom URL'] && d['Dealroom URL'] !== 'N/A') links.push(`<a href="${d['Dealroom URL'].replace('app.dealroom.co','4yfn.dealroom.co')}" target="_blank" onclick="event.stopPropagation()">📊 Dealroom</a>`);
  if (d['Website'] && d['Website'] !== 'N/A') links.push(`<a href="${d['Website']}" target="_blank" onclick="event.stopPropagation()">🌐 Website</a>`);

  const isSaved = swipeSaved.includes(d['Name']);

  stack.innerHTML = `
    <div class="swipe-card" id="swipeCard">
      <div class="swipe-hint hint-left" id="hintLeft">SKIP</div>
      <div class="swipe-hint hint-right" id="hintRight">SAVE ♥</div>
      <div class="swipe-card-top">
        <div class="swipe-card-name">${d['Name']}</div>
        <button class="swipe-save-btn${isSaved ? ' is-saved' : ''}" onclick="event.stopPropagation();swipeAction('right')" title="Save and next">
          <svg viewBox="0 0 24 24" width="22" height="22" fill="${isSaved ? 'currentColor' : 'none'}" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78L12 21.23l8.84-8.84a5.5 5.5 0 000-7.78z"/></svg>
        </button>
        ${d['Tagline'] && d['Tagline'] !== 'N/A' ? `<div class="swipe-card-tagline">${d['Tagline']}</div>` : ''}
        <div class="swipe-card-meta">${meta.join(' &nbsp;·&nbsp; ')}</div>
        ${boothHtml}
        ${tagsHtml}
        ${signalHtml}
        ${foundersHtml}
      </div>
      <div class="swipe-card-bottom">${links.join('')}</div>
    </div>`;

  // Set up touch/mouse swipe
  setupSwipeGesture(stack.querySelector('.swipe-card'));

  // Load founder photos from LinkedIn via unavatar
  stack.querySelectorAll('.swipe-founder-avatar[data-li]').forEach(el => {
    const liUsername = el.dataset.li || '';
    if (!liUsername) return;
    const img = new Image();
    img.onload = function() {
      if (img.naturalWidth > 1 && img.naturalHeight > 1) {
        el.textContent = '';
        el.appendChild(img);
        el.style.background = 'none';
      }
    };
    img.onerror = function() {};
    img.src = `https://unavatar.io/linkedin/${liUsername}?fallback=false`;
    img.alt = liUsername;
    img.style.cssText = 'width:100%;height:100%;object-fit:cover;border-radius:50%;';
  });
}

function setupSwipeGesture(card) {
  if (!card) return;
  let startX = 0, startY = 0, currentX = 0, isDragging = false;
  let directionLocked = null; // null = undecided, 'h' = horizontal swipe, 'v' = vertical scroll

  const onStart = (x, y) => {
    startX = x; currentX = x; startY = y;
    isDragging = true; directionLocked = null;
    card.classList.add('swiping');
  };
  const onMove = (x, y) => {
    if (!isDragging) return;
    // Determine direction on first significant movement
    if (!directionLocked) {
      const dx = Math.abs(x - startX);
      const dy = Math.abs(y - startY);
      if (dx > 8 || dy > 8) {
        directionLocked = dx > dy ? 'h' : 'v';
        if (directionLocked === 'v') {
          // Let browser handle vertical scroll, abort swipe
          isDragging = false;
          card.classList.remove('swiping');
          return;
        }
      } else {
        return; // Not enough movement yet
      }
    }
    if (directionLocked !== 'h') return;
    currentX = x;
    const dx = currentX - startX;
    const rotate = dx * 0.05;
    card.style.transform = `translateX(${dx}px) rotate(${rotate}deg)`;
    const leftHint = document.getElementById('hintLeft');
    const rightHint = document.getElementById('hintRight');
    if (leftHint) leftHint.style.opacity = dx < -40 ? Math.min(1, (-dx - 40) / 60) : 0;
    if (rightHint) rightHint.style.opacity = dx > 40 ? Math.min(1, (dx - 40) / 60) : 0;
  };
  const onEnd = () => {
    if (!isDragging && directionLocked !== 'h') { directionLocked = null; return; }
    isDragging = false;
    card.classList.remove('swiping');
    const dx = currentX - startX;
    if (directionLocked === 'h' && dx > 100) swipeAction('right');
    else if (directionLocked === 'h' && dx < -100) swipeAction('left');
    else {
      card.style.transform = '';
      const leftHint = document.getElementById('hintLeft');
      const rightHint = document.getElementById('hintRight');
      if (leftHint) leftHint.style.opacity = 0;
      if (rightHint) rightHint.style.opacity = 0;
    }
    directionLocked = null;
  };

  // Pointer events for desktop
  card.addEventListener('pointerdown', e => {
    if (e.pointerType === 'touch') return; // handled by touch events below
    if (e.target.closest('.swipe-save-btn')) return; // let heart button handle its own click
    card.setPointerCapture(e.pointerId);
    onStart(e.clientX, e.clientY);
  });
  card.addEventListener('pointermove', e => {
    if (e.pointerType === 'touch') return;
    onMove(e.clientX, e.clientY);
  });
  card.addEventListener('pointerup', e => { if (e.pointerType !== 'touch') onEnd(); });
  card.addEventListener('pointercancel', e => { if (e.pointerType !== 'touch') onEnd(); });

  // Touch events for mobile — these fire before pointer events and give us control
  card.addEventListener('touchstart', e => {
    if (e.target.closest('.swipe-save-btn')) return; // let heart button handle its own tap
    const t = e.touches[0];
    onStart(t.clientX, t.clientY);
  }, { passive: true });
  card.addEventListener('touchmove', e => {
    const t = e.touches[0];
    onMove(t.clientX, t.clientY);
    // If we've locked horizontal, prevent scrolling
    if (directionLocked === 'h') e.preventDefault();
  }, { passive: false });
  card.addEventListener('touchend', () => onEnd());
  card.addEventListener('touchcancel', () => onEnd());
}

function swipeAction(direction) {
  const card = document.getElementById('swipeCard');
  if (!card || swipeIndex >= swipePool.length) return;

  if (direction === 'right') {
    const name = swipePool[swipeIndex]['Name'];
    if (!swipeSaved.includes(name)) {
      swipeSaved.push(name);
      SwipeTracker.trackSave(name, 'swipe');
      localStorage.setItem('4yfn_saved', JSON.stringify(swipeSaved));
      updateSwipeSavedCount();
      updateGridViewPills();
    }
    card.classList.add('exit-right');
  } else {
    const name = swipePool[swipeIndex]['Name'];
    if (!swipeSkipped.includes(name)) {
      swipeSkipped.push(name);
      localStorage.setItem('4yfn_skipped', JSON.stringify(swipeSkipped));
      updateGridViewPills();
    }
    card.classList.add('exit-left');
  }

  setTimeout(() => {
    swipeIndex++;
    renderSwipeCard();
  }, 350);
}

function swipeShowLinks() {
  if (swipeIndex >= swipePool.length) return;
  const d = swipePool[swipeIndex];
  const url = d['Dealroom URL'] ? d['Dealroom URL'].replace('app.dealroom.co','4yfn.dealroom.co') : (d['Website'] && d['Website'] !== 'N/A' ? d['Website'] : '');
  if (url) window.open(url, '_blank');
}

// Keyboard controls for swipe mode
document.addEventListener('keydown', e => {
  if (!document.getElementById('swipeOverlay').classList.contains('open')) return;
  if (e.key === 'ArrowLeft') swipeAction('left');
  else if (e.key === 'ArrowRight') swipeAction('right');
  else if (e.key === 'Escape') closeSwipeMode();
});

// ── Init ──
loadData().catch(err => {
  document.getElementById('grid').innerHTML = `<div class="no-results" style="grid-column:1/-1;"><p>Failed to load data.</p><p style="font-size:0.75rem;margin-top:0.5rem;color:var(--text3);">${err.message}</p></div>`;
});

// ── Company Detail Modal ──
function openDetailModal(name) {
  const d = allData.find(item => item['Name'] === name);
  if (!d) return;

  const flag = countryFlag(d['HQ country']);
  const signal = parseFloat(d['Dealroom Signal - Rating']);
  const signalHtml = signal && !isNaN(signal) ? `<div class="signal-row"><span class="signal-label">Dealroom Signal</span><div class="signal-track"><div class="signal-fill" style="width:${signal}%"></div></div><span class="signal-score">${Math.round(signal)}</span></div>` : '';

  let meta = [];
  if (d['HQ city'] && d['HQ city'] !== 'N/A') meta.push(`${flag} ${d['HQ city']}`);
  const funding = formatFunding(d['Total funding (USD M)']);
  if (funding) meta.push(`💰 ${funding}`);
  const emp = formatEmployees(d['Employees latest number']);
  if (emp) meta.push(`👥 ${emp}`);
  if (d['Established'] && d['Established'] !== 'N/A') meta.push(`📅 Est. ${d['Established']}`);

  const round = displayRound(d['Last round']);
  const roundClass = getRoundClass(d['Last round']);
  const roundBadge = round ? `<span class="tag ${roundClass}" style="font-size:0.72rem;">${round}</span>` : '';

  const tags = (d['Tags'] || '').split(/[,;]/).map(t => t.trim()).filter(t => t && t !== 'N/A' && !t.toLowerCase().startsWith('4yfn')).slice(0, 5);
  const tagsHtml = tags.length ? `<div class="swipe-card-tags">${tags.map(t => `<span>${t}</span>`).join('')}${roundBadge}</div>` : (roundBadge ? `<div class="swipe-card-tags">${roundBadge}</div>` : '');

  const founderNames = (d['Founders'] || '').split(';').map(s => s.trim()).filter(Boolean);
  const founderLinkedins = (d['Founders linkedin'] || '').split(';').map(s => s.trim());
  const founderUnis = (d['Founders universities'] || '').split(';').map(s => s.trim());
  const founderExps = (d['Founders company experience'] || '').split(';').map(s => s.trim());
  const isSerial = (d['Is serial founder (yes/no)'] || '').toLowerCase() === 'yes';
  const isTopFounder = (d['Is top past founder (yes/no)'] || '').toLowerCase() === 'yes';
  const avatarGrads = [['#8b5cf6','#06b6d4'],['#f97316','#f43f5e'],['#10b981','#06b6d4'],['#6366f1','#ec4899'],['#a855f7','#f97316'],['#14b8a6','#3b82f6']];
  let companyDomain = '';
  try { const w = d['Website']||''; companyDomain = w ? new URL(w.startsWith('http')?w:'https://'+w).hostname.replace('www.','') : ''; } catch(e){}
  let foundersHtml = '';
  if (founderNames.length) {
    const rows = founderNames.slice(0, 3).map((fn, i) => {
      const initials = fn.split(/\s+/).map(w => w[0]).join('').toUpperCase().slice(0,2);
      const hash = fn.split('').reduce((a,c) => a + c.charCodeAt(0), 0);
      const [gc1,gc2] = avatarGrads[hash % avatarGrads.length];
      const li = founderLinkedins[i] || '';
      const liUrl = li && li !== 'N/A' ? (li.startsWith('http') ? li : `https://${li}`) : '';
      const liIcon = liUrl ? `<a href="${liUrl}" target="_blank" rel="noopener" onclick="event.stopPropagation()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-4 0v7h-4v-7a6 6 0 0 1 6-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a>` : '';
      let sub = [];
      const uni = (founderUnis[i] || '').split(',')[0].trim();
      const exp = (founderExps[i] || '').split(',')[0].trim();
      if (uni && uni !== 'N/A' && uni.toLowerCase() !== 'n/a') sub.push(uni);
      else if (exp && exp !== 'N/A' && exp.toLowerCase() !== 'n/a' && exp.length < 35) sub.push(exp);
      let badges = '';
      if (isSerial) badges += '<span class="swipe-founder-badge sf">Serial</span>';
      if (isTopFounder) badges += '<span class="swipe-founder-badge tf">Top</span>';
      return `<div class="swipe-founder-row">
        <div class="swipe-founder-avatar" style="background:linear-gradient(135deg,${gc1},${gc2})">${initials}</div>
        <div class="swipe-founder-details">
          <div class="swipe-founder-name">${fn}${liIcon}${i===0 ? badges : ''}</div>
          ${sub.length ? `<div class="swipe-founder-sub">${sub.join(' · ')}</div>` : ''}
        </div>
      </div>`;
    }).join('');
    const moreCount = founderNames.length > 3 ? `<div style="font-size:0.65rem;color:var(--text3);padding-top:0.2rem;">+${founderNames.length - 3} more</div>` : '';
    foundersHtml = `<div class="swipe-card-founders"><div class="swipe-founder-label">Founders</div>${rows}${moreCount}</div>`;
  }

  let boothHtml = '';
  if (window.boothData && window.boothData.length) {
    const nameLower = (d['Name'] || '').toLowerCase();
    const booth = window.boothData.find(b => b.name.toLowerCase() === nameLower || (b.dealroomData && b.dealroomData['Name'] && b.dealroomData['Name'].toLowerCase() === nameLower));
    if (booth && booth.stands[0]) {
      boothHtml = `<div class="swipe-card-booth">📍 Booth <span>${booth.stands[0]}</span></div>`;
    }
  }

  let links = [];
  if (d['Dealroom URL'] && d['Dealroom URL'] !== 'N/A') links.push(`<a href="${d['Dealroom URL'].replace('app.dealroom.co','4yfn.dealroom.co')}" target="_blank">📊 Dealroom</a>`);
  if (d['Website'] && d['Website'] !== 'N/A') links.push(`<a href="${d['Website']}" target="_blank">🌐 Website</a>`);

  document.getElementById('detailModalBody').innerHTML = `
    <div class="swipe-card-name">${d['Name']}</div>
    ${d['Tagline'] && d['Tagline'] !== 'N/A' ? `<div class="swipe-card-tagline">${d['Tagline']}</div>` : ''}
    <div class="swipe-card-meta">${meta.join(' &nbsp;·&nbsp; ')}</div>
    ${boothHtml}
    ${tagsHtml}
    ${signalHtml}
    ${foundersHtml}
    ${links.length ? `<div class="detail-links">${links.join('')}</div>` : ''}`;

  document.getElementById('detailOverlay').classList.add('open');
  document.body.style.overflow = 'hidden';
}

function closeDetailModal() {
  document.getElementById('detailOverlay').classList.remove('open');
  document.body.style.overflow = '';
}

document.addEventListener('keydown', e => {
  if (e.key === 'Escape' && document.getElementById('detailOverlay').classList.contains('open')) closeDetailModal();
});

// Refresh leaderboard every 60 seconds
setInterval(loadLeaderboard, 60000);
</script>
</body>
</html>
